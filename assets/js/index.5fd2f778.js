import{r as a}from"./react.0a2f695e.js";import{q as y,L as p,C as N,r as C,v as L,w as B,x,E as D,y as S,z as $,B as b,D as w,P as F,F as E,G,I as M,J as R,K as _,N as H}from"./index.ba361b16.js";import{j as e,a as t}from"./qrcode.react.84002e4a.js";import{e as h,R as Q,f as u}from"./react-router.d1bb31aa.js";import{t as V}from"./react-use.fd5829ae.js";import{w as z}from"./@tabler/icons.d755a6ec.js";import{L as v}from"./react-router-dom.256d9b78.js";import"./lodash.f41ef0b4.js";import"./react-dom.d348259d.js";import"./react-redux.49573eed.js";import"./immer.76e704b2.js";import"./redux-persist.b0b12bc5.js";import"./axios.8a0dc616.js";import"./classnames.9558900f.js";import"./rxjs.22301260.js";import"./react-transition-group.2770fa82.js";import"./color.a5f8aeb5.js";import"./dayjs.6fdda85a.js";import"./history.9736f6f1.js";const A=({index:o,setHasMore:l})=>{const{id:m}=h(),r=20,i=a.exports.useRef(null),s=V(i,{root:null,rootMargin:"0px",threshold:1}),[c,{data:n,isSuccess:d,isFetching:W,isUninitialized:g}]=y();return a.exports.useEffect(()=>{g&&s&&s.intersectionRatio>0&&c({id:m,type:0,limit:r,offset:o*r})},[s]),a.exports.useEffect(()=>{n!=null&&n.hasMore&&l()},[n]),e("div",{ref:i,children:d?n.hotComments.map(f=>e(N,{item:f},f.commentId)):e("div",{className:"flex-center py-4",children:e(p,{})})})},j=a.exports.memo(A),P=()=>{const[o,l]=a.exports.useState([!1]),m=a.exports.useCallback(()=>{l(r=>[...r,!1])},[]);return t("div",{className:"px-8 py-5 overflow-auto max-h-full flex-auto",children:[e("div",{className:"h1",children:"\u7CBE\u5F69\u8BC4\u8BBA"}),e("div",{className:"",children:o.map((r,i)=>e(j,{index:i,setHasMore:m},i))})]})},I=a.exports.memo(P),k={song:C,video:L,mv:B},U=()=>{var c;const{id:o,type:l}=h(),{data:m,isFetching:r,isSuccess:i}=k[l]({ids:o});if(r)return e(p,{});const s=m.songs[0];if(i)return t("div",{className:"flex",children:[t("div",{className:"cover h-20 rounded overflow-hidden relative",children:[e("img",{loading:"lazy",className:"h-full",src:s.al.picUrl,alt:""}),e("div",{className:"ico absolute inset-0 m-auto flex-center w-8 h-8 ui_themeColor rounded-full bg-white bg-opacity-90",children:e(z,{size:16,className:"fill-current"})})]}),t("div",{className:"content px-6 py-2",children:[t("div",{className:"title text-lg",children:[s.name,e("span",{className:"text-gray-500",children:s.alia.length>0&&`(${s.alia})`})]}),t("div",{className:"info text-gray-500 mt-2 space-x-5",children:[t("span",{children:["\u4E13\u8F91\uFF1A",e(v,{className:"ui_text_gray_hover",to:`/playlist/album/${s.al.id}`,children:(c=s.al)==null?void 0:c.name})]}),t("span",{children:["\u6B4C\u624B\uFF1A",s.ar.map((n,d)=>t("span",{children:[d>0&&" / ",e(v,{className:"ui_text_gray_hover",to:`/artist/${n.id}`,children:n.name})]},n.id))]})]})]})]})},q=a.exports.memo(U),J={song:{apiDetail:({id:o})=>E({ids:o}),comment:G},mv:{apiDetail:M,comment:R,header:()=>e("div",{})},video:{apiDetail:_,comment:H}},K=()=>{console.log("comment");const{id:o,type:l}=h();a.exports.useState("");const[m,r]=a.exports.useState(1),{data:i,isLoading:s}=J[l].comment({id:o,offset:(m-1)*20,limit:x});return s?e("div",{className:"w-full h-full flex-center",children:e(p,{})}):t("div",{className:"domComment overflow-auto px-8 py-5 h-full",children:[e(q,{}),t("div",{className:"mt-4",children:[e(D,{}),t("div",{className:"flex mt-2",children:[t("div",{className:"flex space-x-2",children:[e(S,{}),e($,{}),e(b,{})]}),e("button",{type:"button",className:"flex-center border px-4 h-8 text-sm hover:bg-gray-100 rounded-full ml-auto",children:"\u8BC4\u8BBA"})]})]}),t("div",{className:"mt-8",children:[e(w,{comments:i,more:o,type:l}),e(F,{total:Math.ceil(i.total/x),page:m,func:r})]})]})},O=a.exports.memo(K),T=()=>e(Q,{children:t(u,{path:":type/:id",children:[e(u,{index:!0,element:e(O,{})}),e(u,{path:"hot",element:e(I,{})})]})}),xe=T;export{xe as default};
