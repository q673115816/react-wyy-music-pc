import{r as a}from"./react.4f2eb426.js";import{C as B,L as b,r as M,W as R,v as k,P as H,w as C,x as L,y as z,z as F,B as P,D as A,E as V}from"./index.ee85d584.js";import{u as $}from"./useInfinite.cea0ff5d.js";import{a as t,j as e}from"./qrcode.react.d8dda151.js";import{b as w,L as N,R as j,c as v}from"./react-router-dom.1ca7f9ae.js";import{H as E,am as W,an as O,D as U}from"./@tabler/icons.1bddd3c4.js";import"./lodash.7c73e2e6.js";import"./react-dom.fe9fde37.js";import"./react-redux.bec53cdc.js";import"./immer.98e49ab6.js";import"./axios.1ece621b.js";import"./store.4dc8c578.js";import"./react-slick.a7487162.js";import"./react-transition-group.b433e3be.js";import"./react-use.602fd606.js";const q=a.exports.memo(function(){const{id:r}=w(),[s,l]=a.exports.useState([]),m=a.exports.useRef(!0),c=a.exports.useRef(0),u=a.exports.useRef(null),h=a.exports.useRef(null),p=20;return $(async()=>{if(!m.current)return!1;try{const{hotComments:i,hasMore:d}=await M({id:r,type:0,limit:p,offset:c.current});m.current=d,c.current+=p,l(x=>[...x,...i])}catch(i){console.log(i)}},h,u),t("div",{className:"domComment px-8 py-5 overflow-auto max-h-full flex-auto",ref:h,children:[e("div",{className:"h1",children:"\u7CBE\u5F69\u8BC4\u8BBA"}),t("div",{className:"domComment_list",children:[s.map(i=>e(B,{item:i},i.commentId)),m.current&&e("div",{className:"flex justify-center py-4",children:e(b,{})}),e("div",{ref:u})]})]})}),G=({detail:o})=>{var r;return e("div",{className:"domComment_header",children:t("div",{className:"domComment_infos flex ",children:[t("div",{className:"cover h-20 rounded overflow-hidden relative",children:[e("img",{loading:"lazy",className:"h-full",src:o.al.picUrl,alt:""}),e("div",{className:"ico absolute inset-0 m-auto flex-center w-8 h-8 ui_themeColor rounded-full bg-white bg-opacity-90",children:e(U,{size:16,className:"fill-current"})})]}),t("div",{className:"content px-6 py-2",children:[t("div",{className:"title text-lg",children:[o.name,e("span",{className:"text-gray-500",children:o.alia.length>0&&`(${o.alia})`})]}),t("div",{className:"info text-gray-500 mt-2 space-x-5",children:[t("span",{children:["\u4E13\u8F91\uFF1A",e(N,{className:"ui_text_gray_hover",to:`/playlist/album/${o.al.id}`,children:(r=o.al)==null?void 0:r.name})]}),t("span",{children:["\u6B4C\u624B\uFF1A",o.ar.map((s,l)=>t("span",{children:[l>0&&" / ",e(N,{className:"ui_text_gray_hover",to:`/artist/${s.id}`,children:s.name})]},s.id))]})]})]})]})})},y={song:{apiDetail:({id:o})=>L({ids:o}),apiComment:z,header:G},mv:{apiDetail:F,apiComment:P,header:()=>e("div",{})},video:{apiDetail:A,apiComment:V,header:()=>e("div",{})}},J=a.exports.memo(function(){console.log("comment");const{id:r,type:s}=w(),[l,m]=a.exports.useState({}),[c,u]=a.exports.useState({}),[h,p]=a.exports.useState(""),[f,i]=a.exports.useState(!0),[d,x]=a.exports.useState(1),_=async()=>{try{const{songs:n}=await y[s].apiDetail({id:r});m(n[0])}catch(n){console.log(n)}},D=a.exports.useCallback(n=>{p(n.target.value)},[]),g=async()=>{try{const n=await y[s].apiComment({id:r,offset:(d-1)*20,limit:C});u(n)}catch(n){console.log(n)}},I=async()=>{await _(),await g(),i(!1)},S=a.exports.useMemo(()=>y[s].header,[s]);return a.exports.useEffect(()=>{f?I():g()},[d]),f?e("div",{className:"w-full h-full flex-center",children:e(b,{})}):t("div",{className:"domComment overflow-auto px-8 py-5 h-full",children:[e(S,{detail:l}),t("div",{className:"domComment_write mt-4",children:[e(R,{onChange:D,max:140}),t("div",{className:"domComment_write_actions flex mt-2.5",children:[t("div",{className:"flex space-x-2",children:[e("button",{type:"button",className:"text-gray-500 hover:text-black",children:e(E,{size:20,stroke:1.5})}),e("button",{type:"button",className:"text-gray-500 hover:text-black",children:e(W,{size:20,stroke:1.5})}),e("button",{type:"button",className:"text-gray-500 hover:text-black",children:e(O,{size:20,stroke:1.5})})]}),e("button",{type:"button",className:"ui_btn flex-center border px-4 h-8 text-sm hover:bg-gray-100 rounded-full ml-auto",children:"\u8BC4\u8BBA"})]})]}),t("div",{className:"domComment_main mt-8",children:[e(k,{comments:c,more:r,type:s}),e(H,{total:Math.ceil(c.total/C),page:d,func:x})]})]})}),K=()=>e(j,{children:t(v,{path:":type/:id",children:[e(v,{index:!0,element:e(J,{})}),e(v,{path:"hot",element:e(q,{})})]})}),ce=K;export{ce as default};
