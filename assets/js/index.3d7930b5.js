import{r as a}from"./react.0a2f695e.js";import{r as y,L as p,C as N,v as C,w as L,x as b,y as x,E as B,z as D,B as S,D as $,F,P as G,G as M,I as R,J as _,K as w,N as E,O as H}from"./index.766d71b4.js";import{j as e,a as t}from"./qrcode.react.84002e4a.js";import{b as h,L as v,R as Q,c as u}from"./react-router-dom.8e5277d6.js";import{s as V}from"./react-use.4cc61ccc.js";import{p as z}from"./@tabler/icons.cf3d4071.js";import"./lodash.f41ef0b4.js";import"./react-dom.d348259d.js";import"./react-redux.53cbeeec.js";import"./immer.9a3c9cc9.js";import"./axios.556b107a.js";import"./react-slick.d01d63b2.js";import"./rxjs.10173dca.js";import"./react-transition-group.7648cfe3.js";const A=({index:o,setHasMore:l})=>{const{id:c}=h(),r=20,i=a.exports.useRef(null),s=V(i,{root:null,rootMargin:"0px",threshold:1}),[m,{data:n,isSuccess:d,isFetching:W,isUninitialized:g}]=y();return a.exports.useEffect(()=>{g&&s&&s.intersectionRatio>0&&m({id:c,type:0,limit:r,offset:o*r})},[s]),a.exports.useEffect(()=>{n!=null&&n.hasMore&&l()},[n]),e("div",{ref:i,children:d?n.hotComments.map(f=>e(N,{item:f},f.commentId)):e("div",{className:"flex-center py-4",children:e(p,{})})})},j=a.exports.memo(A),P=()=>{const[o,l]=a.exports.useState([!1]),c=a.exports.useCallback(()=>{l(r=>[...r,!1])},[]);return t("div",{className:"px-8 py-5 overflow-auto max-h-full flex-auto",children:[e("div",{className:"h1",children:"\u7CBE\u5F69\u8BC4\u8BBA"}),e("div",{className:"",children:o.map((r,i)=>e(j,{index:i,setHasMore:c},i))})]})},I=a.exports.memo(P),k={song:C,video:L,mv:b},U=()=>{var m;const{id:o,type:l}=h(),{data:c,isFetching:r,isSuccess:i}=k[l]({ids:o});if(r)return e(p,{});const s=c.songs[0];if(i)return t("div",{className:"flex",children:[t("div",{className:"cover h-20 rounded overflow-hidden relative",children:[e("img",{loading:"lazy",className:"h-full",src:s.al.picUrl,alt:""}),e("div",{className:"ico absolute inset-0 m-auto flex-center w-8 h-8 ui_themeColor rounded-full bg-white bg-opacity-90",children:e(z,{size:16,className:"fill-current"})})]}),t("div",{className:"content px-6 py-2",children:[t("div",{className:"title text-lg",children:[s.name,e("span",{className:"text-gray-500",children:s.alia.length>0&&`(${s.alia})`})]}),t("div",{className:"info text-gray-500 mt-2 space-x-5",children:[t("span",{children:["\u4E13\u8F91\uFF1A",e(v,{className:"ui_text_gray_hover",to:`/playlist/album/${s.al.id}`,children:(m=s.al)==null?void 0:m.name})]}),t("span",{children:["\u6B4C\u624B\uFF1A",s.ar.map((n,d)=>t("span",{children:[d>0&&" / ",e(v,{className:"ui_text_gray_hover",to:`/artist/${n.id}`,children:n.name})]},n.id))]})]})]})]})},J=a.exports.memo(U),K={song:{apiDetail:({id:o})=>M({ids:o}),comment:R},mv:{apiDetail:_,comment:w,header:()=>e("div",{})},video:{apiDetail:E,comment:H}},O=()=>{console.log("comment");const{id:o,type:l}=h();a.exports.useState("");const[c,r]=a.exports.useState(1),{data:i,isLoading:s}=K[l].comment({id:o,offset:(c-1)*20,limit:x});return s?e("div",{className:"w-full h-full flex-center",children:e(p,{})}):t("div",{className:"domComment overflow-auto px-8 py-5 h-full",children:[e(J,{}),t("div",{className:"mt-4",children:[e(B,{}),t("div",{className:"flex mt-2",children:[t("div",{className:"flex space-x-2",children:[e(D,{}),e(S,{}),e($,{})]}),e("button",{type:"button",className:"flex-center border px-4 h-8 text-sm hover:bg-gray-100 rounded-full ml-auto",children:"\u8BC4\u8BBA"})]})]}),t("div",{className:"mt-8",children:[e(F,{comments:i,more:o,type:l}),e(G,{total:Math.ceil(i.total/x),page:c,func:r})]})]})},q=a.exports.memo(O),T=()=>e(Q,{children:t(u,{path:":type/:id",children:[e(u,{index:!0,element:e(q,{})}),e(u,{path:"hot",element:e(I,{})})]})}),de=T;export{de as default};
