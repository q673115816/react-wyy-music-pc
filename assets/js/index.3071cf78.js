import{r as s}from"./react.4dc00a72.js";import{c as p}from"./react-slick.7d904bce.js";import{N as f,O as g,L as h,b as v,e as N,d as y}from"./react-router-dom.c9f41bfe.js";import{a as o,j as e}from"./qrcode.react.9db161e8.js";import{d as b,l as w,m as E}from"./index.1fcb7d31.js";import{r as D}from"./react-dom.21c65b93.js";import{ak as F,n as _,al as A,D as I}from"./@tabler/icons.b6e06489.js";import"./lodash.7c73e2e6.js";import"./react-transition-group.249745a6.js";import"./react-redux.1c755cf9.js";import"./immer.98e49ab6.js";import"./axios.1ece621b.js";import"./store.4dc8c578.js";import"./react-use.7eb84fdb.js";const L=[["\u8282\u76EE\u699C","program"],["\u65B0\u664B\u7535\u53F0\u699C","now"],["\u70ED\u95E8\u7535\u53F0\u699C","hot"]],T=()=>o("div",{className:"h-full overflow-auto pt-8",children:[e("div",{className:"m-auto w-min flex rounded-full border",children:L.map(([r,t])=>e(f,{to:t,className:({isActive:u})=>p("flex-center w-28 h-8 rounded-full text-center",u?"text-white bg-gray-200":"hover:bg-gray-100"),children:r},r))}),e(g,{})]}),j=s.exports.memo(T),B=s.exports.memo(({lastRank:r,rank:t})=>{switch(!0){case r===-1:return e("div",{className:"text-green-500",children:"new"});case r-t<0:return o("div",{className:"flex-center text-gray-500",children:[e(A,{size:10,className:"text-blue-500"}),-r+t]});case r-t===0:return o("div",{className:"flex-center text-gray-500",children:[e(_,{size:10}),"0"]});case r-t>0:return o("div",{className:"flex-center text-gray-500",children:[e(F,{size:10,className:"text-red-500"}),r-t]});default:return e("div",{})}}),C=({item:r,index:t,maxScore:u})=>o("div",{tabIndex:2,className:p("item h-20 flex items-center hover:bg-gray-100 focus:bg-gray-100 focus:outline-none",{"bg-gray-50":t%2===0}),children:[o("div",{className:"index w-16 flex flex-col items-center justify-center",children:[e("div",{className:p("font-bold text-sm",{"text-red-500":t<3,"text-gray-400":t>2}),children:t+1}),e("div",{children:e(B,{lastRank:r.lastRank,rank:r.rank})})]}),o("button",{type:"button",className:"w-14 -14 relative",children:[e("img",{src:`${r.coverUrl}?param=60y60`,className:"rounded",alt:""}),e("i",{className:"ico ui_themeColor absolute inset-0 flex-center rounded-full w-6 h-6 m-auto bg-white bg-opacity-90",children:e(I,{size:16,className:"fill-current"})})]}),e("div",{className:"name flex-auto truncate px-2",children:r.name}),e("div",{className:"radio flex-auto truncate px-2",children:e(h,{className:"ui_text_gray_hover",to:`/playlist/dj/${r.userId}`,children:r.userName})}),e("div",{className:"w-24 px-2",children:e(h,{to:"/",className:"ui_text_gray_hover border border-current",children:r.category})}),e("div",{className:"w-24 px-2",children:e("div",{className:"rounded bg-gray-300 overflow-hidden h-2",children:e("div",{className:"h-full bg-gray-500 w-0",style:{width:`${r.score/u*100}%`}})})})]},r.id),$=s.exports.memo(C),M={false({lastRank:r,rank:t,score:u,program:{id:l,name:i,coverUrl:n,radio:{name:d,id:m,category:a}}}){return{id:l,name:i,lastRank:r,rank:t,coverUrl:n,score:u,userName:d,userId:m,category:a}},true({id:r,name:t,lastRank:u,rank:l,picUrl:i,score:n,dj:{nickname:d,userId:m},category:a}){return{id:r,name:t,lastRank:u,rank:l,coverUrl:i,score:n,userName:d,userId:m,category:a}}},U=()=>{const{type:r}=v(),[t,u]=s.exports.useState([]),[l,i]=s.exports.useState(),n=s.exports.useMemo(()=>r!=="program",[r]),d=async a=>{try{const{toplist:c,updateTime:x}=a?await w({type:r}):await E();D.exports.unstable_batchedUpdates(()=>{u(c.map(M[a])),i(x)})}catch(c){console.log(c)}},m=s.exports.useMemo(()=>{var a,c;return(c=(a=t[0])==null?void 0:a.score)!=null?c:0},[t]);return s.exports.useEffect(()=>{d(n)},[r,n]),o("div",{className:"pt-8 relative",children:[o("div",{className:"absolute flex-center bottom-full transform -translate-y-1/2 right-8 text-gray-400",children:["\u6700\u8FD1\u66F4\u65B0\uFF1A",l&&b(l).format("MM\u6708DD\u65E5"),o("div",{className:"relative ui_group",children:[e("span",{className:"block flex-center  border rounded-full w-4 h-4 flex-none",children:"?"}),e("div",{className:"absolute text-gray-500 top-6 right-0 shadow rounded p-4 w-48 border hidden ui_group-hover:block bg-white",children:"\u9009\u53D6\u4E91\u97F3\u4E50\u4E2D7\u5929\u5185\u53D1\u5E03\u7684\u70ED\u5EA6\u6700\u9AD8\u7684\u8282\u76EE\uFF0C\u70ED\u5EA6\u7531\u8282\u76EE\u64AD\u653E\u3001\u8D5E\u3001\u5206\u4EAB\u6570\u91CF\u603B\u548C\u8BA1\u7B97"})]})]}),e("div",{className:"list",children:t.map((a,c)=>e($,{item:a,index:c,maxScore:m},a.id))})]})},z=s.exports.memo(U),P=()=>N([{path:"/",element:e(j,{}),children:[{index:!0,element:e(y,{to:"program",replace:!0})},{path:":type",element:e(z,{}),children:[]}]}]),Z=s.exports.memo(P);export{Z as default};
