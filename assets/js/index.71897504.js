import{r as s}from"./react.b31a8c6f.js";import{c as p}from"./react-slick.41aab853.js";import{N as f,O as g,L as h,b as v,e as N,d as y}from"./react-router-dom.dd0f13a7.js";import{a as o,j as e}from"./qrcode.react.3591e685.js";import{d as b,a$ as w,b0 as E}from"./index.ec08ca16.js";import{r as D}from"./react-dom.5b11e026.js";import{az as F,e as _,ay as L,t as T}from"./@tabler/icons.73a1add0.js";import"./lodash.f41ef0b4.js";import"./react-transition-group.2fafef50.js";import"./react-redux.47a27303.js";import"./immer.9a3c9cc9.js";import"./axios.fa0829fd.js";import"./rxjs.eaf840a9.js";import"./react-use.a43874bd.js";import"./store.066dccc1.js";const C=[["\u8282\u76EE\u699C","program"],["\u65B0\u664B\u7535\u53F0\u699C","now"],["\u70ED\u95E8\u7535\u53F0\u699C","hot"]],$=()=>o("div",{className:"h-full overflow-auto pt-8",children:[e("div",{className:"m-auto w-min flex rounded-full border",children:C.map(([t,r])=>e(f,{to:r,className:({isActive:u})=>p("flex-center w-28 h-8 rounded-full text-center",u?"text-white bg-gray-200":"hover:bg-gray-100"),children:t},t))}),e(g,{})]}),j=s.exports.memo($),A=s.exports.memo(({lastRank:t,rank:r})=>{switch(!0){case t===-1:return e("div",{className:"text-green-500",children:"new"});case t-r<0:return o("div",{className:"flex-center text-gray-500",children:[e(L,{size:10,className:"text-blue-500"}),-t+r]});case t-r===0:return o("div",{className:"flex-center text-gray-500",children:[e(_,{size:10}),"0"]});case t-r>0:return o("div",{className:"flex-center text-gray-500",children:[e(F,{size:10,className:"text-red-500"}),t-r]});default:return e("div",{})}}),B=({item:t,index:r,maxScore:u})=>o("div",{tabIndex:2,className:p("item h-20 flex items-center hover:bg-gray-100 focus:bg-gray-100 focus:outline-none",{"bg-gray-50":r%2===0}),children:[o("div",{className:"index w-16 flex flex-col items-center justify-center",children:[e("div",{className:p("font-bold text-sm",{"text-red-500":r<3,"text-gray-400":r>2}),children:r+1}),e("div",{children:e(A,{lastRank:t.lastRank,rank:t.rank})})]}),o("button",{type:"button",className:"w-14 -14 relative",children:[e("img",{src:`${t.coverUrl}?param=60y60`,className:"rounded",alt:""}),e("i",{className:"ico ui_themeColor absolute inset-0 flex-center rounded-full w-6 h-6 m-auto bg-white bg-opacity-90",children:e(T,{size:16,className:"fill-current"})})]}),e("div",{className:"name flex-auto truncate px-2",children:t.name}),e("div",{className:"radio flex-auto truncate px-2",children:e(h,{className:"ui_text_gray_hover",to:`/playlist/dj/${t.userId}`,children:t.userName})}),e("div",{className:"w-24 px-2",children:e(h,{to:"/",className:"ui_text_gray_hover border border-current",children:t.category})}),e("div",{className:"w-24 px-2",children:e("div",{className:"rounded bg-gray-300 overflow-hidden h-2",children:e("div",{className:"h-full bg-gray-500 w-0",style:{width:`${t.score/u*100}%`}})})})]},t.id),z=s.exports.memo(B),I={false({lastRank:t,rank:r,score:u,program:{id:c,name:n,coverUrl:i,radio:{name:d,id:m,category:a}}}){return{id:c,name:n,lastRank:t,rank:r,coverUrl:i,score:u,userName:d,userId:m,category:a}},true({id:t,name:r,lastRank:u,rank:c,picUrl:n,score:i,dj:{nickname:d,userId:m},category:a}){return{id:t,name:r,lastRank:u,rank:c,coverUrl:n,score:i,userName:d,userId:m,category:a}}},M=()=>{const{type:t}=v(),[r,u]=s.exports.useState([]),[c,n]=s.exports.useState(),i=s.exports.useMemo(()=>t!=="program",[t]),d=async a=>{try{const{toplist:l,updateTime:x}=a?await w({type:t}):await E();D.exports.unstable_batchedUpdates(()=>{u(l.map(I[a])),n(x)})}catch(l){console.log(l)}},m=s.exports.useMemo(()=>{var a,l;return(l=(a=r[0])==null?void 0:a.score)!=null?l:0},[r]);return s.exports.useEffect(()=>{d(i)},[t,i]),o("div",{className:"pt-8 relative",children:[o("div",{className:"absolute flex-center bottom-full transform -translate-y-1/2 right-8 text-gray-400",children:["\u6700\u8FD1\u66F4\u65B0\uFF1A",c&&b(c).format("MM\u6708DD\u65E5"),o("div",{className:"relative ui_group",children:[e("span",{className:"block flex-center  border rounded-full w-4 h-4 flex-none",children:"?"}),e("div",{className:"absolute text-gray-500 top-6 right-0 shadow rounded p-4 w-48 border hidden ui_group-hover:block bg-white",children:"\u9009\u53D6\u4E91\u97F3\u4E50\u4E2D7\u5929\u5185\u53D1\u5E03\u7684\u70ED\u5EA6\u6700\u9AD8\u7684\u8282\u76EE\uFF0C\u70ED\u5EA6\u7531\u8282\u76EE\u64AD\u653E\u3001\u8D5E\u3001\u5206\u4EAB\u6570\u91CF\u603B\u548C\u8BA1\u7B97"})]})]}),e("div",{className:"list",children:r.map((a,l)=>e(z,{item:a,index:l,maxScore:m},a.id))})]})},U=s.exports.memo(M),P=()=>N([{path:"/",element:e(j,{}),children:[{index:!0,element:e(y,{to:"program",replace:!0})},{path:":type",element:e(U,{}),children:[]}]}]),ee=s.exports.memo(P);export{ee as default};
