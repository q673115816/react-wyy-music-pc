import{r}from"./react.23cc8478.js";import{Y as p,a4 as v,a5 as u,d as x,a6 as f,L as N}from"./index.10fb9977.js";import{L as i}from"./react-router-dom.1e37ceed.js";import{E as b,am as g,an as y,F as C,T as _,M as w,H as I,ax as $}from"./@tabler/icons.66123647.js";import{a as s,j as e,F as d}from"./qrcode.react.5dc2fa92.js";import{P as B}from"./PicsViewer.6795684c.js";const k=({item:a})=>a?s(p,{id:a.id,className:"bg-gray-100 hover:bg-gray-200 flex w-full mt-2 rounded p-2.5",children:[s("div",{className:"relative overflow-hidden rounded flex-none",children:[e("img",{className:"rounded w-10 h-10",src:`${a.album.blurPicUrl}?param=40y40`,alt:""}),e("div",{className:"ico flex-center absolute inset-0 m-auto bg-white rounded-full w-6 h-6 ui_themeColor",children:e(b,{size:14,className:"fill-current"})})]}),s("div",{className:"aside text-left px-3 w-0 flex-auto",children:[e("div",{className:"name",children:a.name}),e("div",{className:"artist truncate mt-1 text-gray-400",children:a.artists.map(({name:l})=>l).join(" / ")})]})]}):null;var A=r.exports.memo(k);const E=({item:a})=>a?s(i,{to:`/artist/${a.id}`,className:"mt-2 flex items-center p-2 h-14 rounded bg-gray-100 hover:bg-gray-200",children:[e("div",{className:"w-10 h-10 rounded",children:e("img",{src:a.img80x80,className:"rounded w-full h-full object-cover",alt:""})}),e("div",{className:"px-3",children:`\u6B4C\u624B\uFF1A${a.name}`})]}):null;var F=r.exports.memo(E);const S=({handleCheck:a})=>{const[l,o]=r.exports.useState(!1);return s("div",{className:"relative",children:[e("button",{onClick:()=>o(!l),type:"button",className:"block ui_text_black_hover",children:e(C,{size:20,stroke:1})}),l&&e("div",{className:"absolute mt-2 left-0",children:e(v,{handleHide:()=>o(!1),handleCheck:a})})]})},D=()=>{r.exports.useState("");const a=r.exports.useRef(window.getSelection()),l=r.exports.useRef(),o=r.exports.useRef(null),t=()=>{l.current=a.current.getRangeAt(0),console.log(l),l.current},n=c=>{document.execCommand("insertText",!1,c)};return r.exports.useEffect(()=>{},[]),s("div",{className:"write",children:[e("div",{ref:o,contentEditable:"true",className:"h-20 border bg-white rounded focus:outline-none px-3 py-1",onSelect:t}),s("div",{className:"help flex mt-2",children:[s("div",{className:"flex space-x-2 items-center",children:[e(S,{handleCheck:n}),e("button",{type:"button",className:"ui_text_black_hover",children:e(g,{size:20,stroke:1})}),e("button",{type:"button",className:"ui_text_black_hover",children:e(y,{size:20,stroke:1})})]}),e("button",{className:"ml-auto border border-gray-400 px-4 py-1 rounded-full hover:bg-gray-300",type:"button",children:"\u8BC4\u8BBA"})]})]})};var R=r.exports.memo(D);const T=({comment:a})=>s("div",{className:"flex py-4 px-3",children:[e(i,{to:`/user/${a.user.userId}`,className:"avatar w-10 h-10 rounded-full border flex-none",children:e("img",{className:"rounded-full w-full h-full",src:`${a.user.avatarUrl}?param=40y40`,alt:""})}),s("div",{className:"commentContent flex-1 pl-3 select-text",children:[s("div",{className:"",children:[e(i,{to:`/user/${a.user.userId}`,className:"ui_link",children:`${a.user.nickname}\uFF1A`}),u(a.content)]}),a.beReplied.length>0&&s("div",{className:"bg-white px-2 py-1 mt-2 rounded",children:[s(i,{to:`/user/${a.beReplied[0].user.userId}`,className:"ui_link",children:["@",a.beReplied[0].user.nickname,"\uFF1A"]}),e("span",{className:"text-gray-500",children:u(a.beReplied[0].content)})]}),e("div",{className:"mt-2",children:e("span",{className:"text-gray-300",children:x(a.time).format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss")})})]})]},a.commentId);var h=r.exports.memo(T);const j=({threadId:a})=>{const{data:l,isLoading:o}=f({threadId:a}),{comments:t=[],hotComments:n=[]}=l||{};return o?e(N,{}):s(d,{children:[n.length>0&&s(d,{children:[e("div",{className:"text-sm px-3 text-gray-500 font-bold",children:"\u7CBE\u5F69\u8BC4\u8BBA"}),e("div",{className:"divide-y",children:n.slice(0,10).map(c=>e(h,{comment:c},c.commentId))})]}),t.length>0?s(d,{children:[s("div",{className:"text-sm px-3 text-gray-500 font-bold",children:["\u6700\u65B0\u8BC4\u8BBA",`(${t.length})`]}),e("div",{className:"divide-y",children:t.slice(0,10).map(c=>e(h,{comment:c},c.commentId))})]}):e("div",{className:"flex-center py-10 text-gray-500",children:"\u8FD8\u6CA1\u6709\u8BC4\u8BBA\u54E6\uFF0C\u5FEB\u6765\u62A2\u6C99\u53D1~"})]})};var P=r.exports.memo(j);const z=({threadId:a})=>s("div",{className:"comment bg-gray-100 mt-3 rounded",children:[e("div",{className:"p-3",children:e(R,{})}),e(P,{threadId:a})]});var H=r.exports.memo(z);const M={18:"\u5206\u4EAB\u5355\u66F2",36:"\u5206\u4EAB\u6B4C\u624B"},U=({item:a={},commentIsShow:l,handleToggleComment:o})=>{var n,c,m;const t=JSON.parse(a.json);return a.type===33?e("div",{className:"py-5 px-12",children:s("div",{className:"relative rounded-xl overflow-hidden",children:[e("img",{src:t.coverPCUrl,alt:""}),s("div",{className:"absolute border-b border-opacity-20 border-t border-white flex-center h-20 inset-0 m-auto text-center text-white w-min whitespace-nowrap",children:[e("div",{className:"text-xl",children:`#${t.title}#`}),e("div",{className:"-translate-y-1/2 absolute top-full transform",children:`${t.participateCount}\u53C2\u4E0E`})]})]})}):s("div",{className:"ui_event_item py-5 flex",children:[s(i,{to:`/user/${a.user.userId}`,className:"avatar flex-none w-10 h-10 relative border rounded-full",children:[e("img",{className:"rounded-full",src:`${a.user.avatarUrl}?param=40y40`,alt:""}),((c=(n=a==null?void 0:a.user)==null?void 0:n.avatarDetail)==null?void 0:c.identityIconUrl)&&e("img",{className:"absolute bottom-0 right-0 w-3.5 h-3.5",src:a.user.avatarDetail.identityIconUrl,alt:""})]}),s("div",{className:"content ml-2.5 flex-auto",children:[s("div",{className:"name",children:[e(i,{className:"ui_link",to:`/user/${a.user.userId}`,children:a.user.nickname}),"\xA0",e("span",{className:"text-gray-500",children:M[a.type]})]}),e("div",{className:"time mt-2",children:e(i,{to:`/comment/event/${a.id}`,className:"ui_text_gray_hover",children:x(a.showTime).format("MM\u6708DD\u65E5 HH:mm")})}),s("div",{className:"article",children:[e("div",{className:"text whitespace-pre-line text-sm mt-2.5",children:t.msg&&u(t.msg)}),e(F,{item:t.resource}),e(A,{item:t.song}),e(B,{className:"mt-2.5",el:"#inset",srcList:a.pics}),s("div",{className:"info flex mt-2.5",children:[e("div",{className:"left text-gray-400",children:((m=a==null?void 0:a.rcmdInfo)==null?void 0:m.reason)&&`--${a.rcmdInfo.reason}`}),s("div",{className:"right ml-auto divide-x flex",children:[e("div",{className:"px-3",children:s("button",{type:"button",className:"action ui_text_gray_hover flex-center",children:[e(_,{size:16}),a.info.likedCount>0&&`(${a.info.likedCount})`]})}),e("div",{className:"px-3",children:s("button",{type:"button",className:"action ui_text_gray_hover flex-center",children:[e(w,{size:16}),"\xA0",a.info.shareCount>0&&`(${a.info.shareCount})`]})}),e("div",{className:"px-3",children:s("button",{type:"button",className:"action ui_text_gray_hover flex-center",onClick:()=>o(a.info.threadId),children:[e(I,{size:16}),"\xA0",a.info.commentCount>0&&`(${a.info.commentCount})`]})}),e("div",{className:"px-3",children:e("button",{type:"button",className:"action ui_text_gray_hover flex-center",children:e($,{size:16})})})]})]}),l&&e(H,{threadId:a.info.threadId})]})]})]})};var L=r.exports.memo(U);const Y=({list:a=[]})=>{const[l,o]=r.exports.useState(""),t=r.exports.useCallback(n=>{o(c=>c===n?null:n)},[]);return e("div",{className:"divide-y",children:a.map(n=>e(L,{item:n,commentIsShow:l===n.info.threadId,handleToggleComment:t},n.id))})};var K=r.exports.memo(Y);export{K as D};
