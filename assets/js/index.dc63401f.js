import{r as a}from"./react.4dc00a72.js";import{w as y,L as p,C as N,x as C,y as x,E as L,z as b,B,D as S,F as D,P as F,G as $,I as R,J as _,K as w,N as E,O as H}from"./index.4c1ad833.js";import{j as e,a as t}from"./qrcode.react.9db161e8.js";import{b as h,L as v,R as M,c as u}from"./react-router-dom.c9f41bfe.js";import{q as G}from"./react-use.b2910bcc.js";import{D as P}from"./@tabler/icons.6309fe16.js";import"./lodash.7c73e2e6.js";import"./react-dom.21c65b93.js";import"./react-redux.8c90b9d0.js";import"./immer.9a3c9cc9.js";import"./axios.1ece621b.js";import"./store.4dc8c578.js";import"./react-slick.7d904bce.js";import"./react-transition-group.249745a6.js";const z=({index:o,setHasMore:c})=>{const{id:l}=h(),r=20,i=a.exports.useRef(null),s=G(i,{root:null,rootMargin:"0px",threshold:1}),[m,{data:n,isSuccess:d,isFetching:K,isUninitialized:g}]=y();return a.exports.useEffect(()=>{g&&s&&s.intersectionRatio>0&&m({id:l,type:0,limit:r,offset:o*r})},[s]),a.exports.useEffect(()=>{n!=null&&n.hasMore&&c()},[n]),e("div",{ref:i,children:d?n.hotComments.map(f=>e(N,{item:f},f.commentId)):e("div",{className:"flex-center py-4",children:e(p,{})})})},A=a.exports.memo(z),Q=()=>{const[o,c]=a.exports.useState([!1]),l=a.exports.useCallback(()=>{c(r=>[...r,!1])},[]);return t("div",{className:"px-8 py-5 overflow-auto max-h-full flex-auto",children:[e("div",{className:"h1",children:"\u7CBE\u5F69\u8BC4\u8BBA"}),e("div",{className:"",children:o.map((r,i)=>e(A,{index:i,setHasMore:l},i))})]})},j=a.exports.memo(Q),I=()=>{var m;const{id:o,type:c}=h(),{data:l,isFetching:r,isSuccess:i}=C({ids:o});if(r)return e(p,{});const s=l.songs[0];if(i)return t("div",{className:"flex",children:[t("div",{className:"cover h-20 rounded overflow-hidden relative",children:[e("img",{loading:"lazy",className:"h-full",src:s.al.picUrl,alt:""}),e("div",{className:"ico absolute inset-0 m-auto flex-center w-8 h-8 ui_themeColor rounded-full bg-white bg-opacity-90",children:e(P,{size:16,className:"fill-current"})})]}),t("div",{className:"content px-6 py-2",children:[t("div",{className:"title text-lg",children:[s.name,e("span",{className:"text-gray-500",children:s.alia.length>0&&`(${s.alia})`})]}),t("div",{className:"info text-gray-500 mt-2 space-x-5",children:[t("span",{children:["\u4E13\u8F91\uFF1A",e(v,{className:"ui_text_gray_hover",to:`/playlist/album/${s.al.id}`,children:(m=s.al)==null?void 0:m.name})]}),t("span",{children:["\u6B4C\u624B\uFF1A",s.ar.map((n,d)=>t("span",{children:[d>0&&" / ",e(v,{className:"ui_text_gray_hover",to:`/artist/${n.id}`,children:n.name})]},n.id))]})]})]})]})},V=a.exports.memo(I),k={song:{apiDetail:({id:o})=>$({ids:o}),comment:R},mv:{apiDetail:_,comment:w,header:()=>e("div",{})},video:{apiDetail:E,comment:H}},U=()=>{console.log("comment");const{id:o,type:c}=h();a.exports.useState("");const[l,r]=a.exports.useState(1),{data:i,isLoading:s}=k[c].comment({id:o,offset:(l-1)*20,limit:x});return s?e("div",{className:"w-full h-full flex-center",children:e(p,{})}):t("div",{className:"domComment overflow-auto px-8 py-5 h-full",children:[e(V,{}),t("div",{className:"mt-4",children:[e(L,{}),t("div",{className:"flex mt-2",children:[t("div",{className:"flex space-x-2",children:[e(b,{}),e(B,{}),e(S,{})]}),e("button",{type:"button",className:"flex-center border px-4 h-8 text-sm hover:bg-gray-100 rounded-full ml-auto",children:"\u8BC4\u8BBA"})]})]}),t("div",{className:"mt-8",children:[e(D,{comments:i,more:o,type:c}),e(F,{total:Math.ceil(i.total/x),page:l,func:r})]})]})},q=a.exports.memo(U),J=()=>e(M,{children:t(u,{path:":type/:id",children:[e(u,{index:!0,element:e(q,{})}),e(u,{path:"hot",element:e(j,{})})]})}),le=J;export{le as default};
