import{r as a}from"./react.4f2eb426.js";import{C as D,L as b,y as k,W as M,z as R,P as F,A as C,B as H,k as L,E as z,l as A,F as P,m as E}from"./index.3e068c77.js";import{u as V}from"./useInfinite.cea0ff5d.js";import{a as t,j as e}from"./qrcode.react.d8dda151.js";import{b as _,L as N,R as $,c as v}from"./react-router-dom.b907a3a9.js";import{F as j,am as W,an as O,E as U}from"./@tabler/icons.85b9b193.js";import"./lodash.7c73e2e6.js";import"./react-dom.fe9fde37.js";import"./react-redux.64459660.js";import"./immer.98e49ab6.js";import"./axios.1ece621b.js";import"./store.e6a9b03b.js";import"./react-slick.a7487162.js";import"./react-transition-group.99d8e67f.js";import"./react-use.9c5a79ae.js";const q=a.exports.memo(function(){const{id:r}=_(),[s,l]=a.exports.useState([]),m=a.exports.useRef(!0),c=a.exports.useRef(0),u=a.exports.useRef(null),h=a.exports.useRef(null),p=20;return V(async()=>{if(!m.current)return!1;try{const{hotComments:i,hasMore:d}=await k({id:r,type:0,limit:p,offset:c.current});m.current=d,c.current+=p,l(x=>[...x,...i])}catch(i){console.log(i)}},h,u),t("div",{className:"domComment px-8 py-5 overflow-auto max-h-full flex-auto",ref:h,children:[e("div",{className:"h1",children:"\u7CBE\u5F69\u8BC4\u8BBA"}),t("div",{className:"domComment_list",children:[s.map(i=>e(D,{item:i},i.commentId)),m.current&&e("div",{className:"flex justify-center py-4",children:e(b,{})}),e("div",{ref:u})]})]})}),G=({detail:o})=>{var r;return e("div",{className:"domComment_header",children:t("div",{className:"domComment_infos flex ",children:[t("div",{className:"cover h-20 rounded overflow-hidden relative",children:[e("img",{loading:"lazy",className:"h-full",src:o.al.picUrl,alt:""}),e("div",{className:"ico absolute inset-0 m-auto flex-center w-8 h-8 ui_themeColor rounded-full bg-white bg-opacity-90",children:e(U,{size:16,className:"fill-current"})})]}),t("div",{className:"content px-6 py-2",children:[t("div",{className:"title text-lg",children:[o.name,e("span",{className:"text-gray-500",children:o.alia.length>0&&`(${o.alia})`})]}),t("div",{className:"info text-gray-500 mt-2 space-x-5",children:[t("span",{children:["\u4E13\u8F91\uFF1A",e(N,{className:"ui_text_gray_hover",to:`/playlist/album/${o.al.id}`,children:(r=o.al)==null?void 0:r.name})]}),t("span",{children:["\u6B4C\u624B\uFF1A",o.ar.map((s,l)=>t("span",{children:[l>0&&" / ",e(N,{className:"ui_text_gray_hover",to:`/artist/${s.id}`,children:s.name})]},s.id))]})]})]})]})})},y={song:{apiDetail:({id:o})=>H({ids:o}),apiComment:L,header:G},mv:{apiDetail:z,apiComment:A,header:()=>e("div",{})},video:{apiDetail:P,apiComment:E,header:()=>e("div",{})}},J=a.exports.memo(function(){console.log("comment");const{id:r,type:s}=_(),[l,m]=a.exports.useState({}),[c,u]=a.exports.useState({}),[h,p]=a.exports.useState(""),[f,i]=a.exports.useState(!0),[d,x]=a.exports.useState(1),w=async()=>{try{const{songs:n}=await y[s].apiDetail({id:r});m(n[0])}catch(n){console.log(n)}},I=a.exports.useCallback(n=>{p(n.target.value)},[]),g=async()=>{try{const n=await y[s].apiComment({id:r,offset:(d-1)*20,limit:C});u(n)}catch(n){console.log(n)}},S=async()=>{await w(),await g(),i(!1)},B=a.exports.useMemo(()=>y[s].header,[s]);return a.exports.useEffect(()=>{f?S():g()},[d]),f?e("div",{className:"w-full h-full flex-center",children:e(b,{})}):t("div",{className:"domComment overflow-auto px-8 py-5 h-full",children:[e(B,{detail:l}),t("div",{className:"domComment_write mt-4",children:[e(M,{onChange:I,max:140}),t("div",{className:"domComment_write_actions flex mt-2.5",children:[t("div",{className:"flex space-x-2",children:[e("button",{type:"button",className:"text-gray-500 hover:text-black",children:e(j,{size:20,stroke:1.5})}),e("button",{type:"button",className:"text-gray-500 hover:text-black",children:e(W,{size:20,stroke:1.5})}),e("button",{type:"button",className:"text-gray-500 hover:text-black",children:e(O,{size:20,stroke:1.5})})]}),e("button",{type:"button",className:"ui_btn flex-center border px-4 h-8 text-sm hover:bg-gray-100 rounded-full ml-auto",children:"\u8BC4\u8BBA"})]})]}),t("div",{className:"domComment_main mt-8",children:[e(R,{comments:c,more:r,type:s}),e(F,{total:Math.ceil(c.total/C),page:d,func:x})]})]})}),K=()=>e($,{children:t(v,{path:":type/:id",children:[e(v,{index:!0,element:e(J,{})}),e(v,{path:"hot",element:e(q,{})})]})}),ce=K;export{ce as default};
