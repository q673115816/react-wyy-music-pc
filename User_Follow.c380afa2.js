"use strict";(this.webpackChunkwyy=this.webpackChunkwyy||[]).push([[2147],{14622:(e,t,r)=>{r.r(t);var a=r(29604);Object.defineProperty(t,"__esModule",{value:!0});var n=r(49064),u=(0,a.Z)(n),l=r(319),c=(0,a.Z)(l),s=r(48926),o=(0,a.Z)(s),f=r(63038),i=(0,a.Z)(f),d=r(87757),p=(0,a.Z)(d);r(9653),r(92222),r(34553);var m=r(87363),v=(0,a.Z)(m),h=r(63233),w=r(66711),k=r(27980),x=(0,a.Z)(k),b=r(93011),y=r(92470),E=r(21624),Z=r(74849),g=(0,a.Z)(Z),_=r(99709),N=(0,a.Z)(_),U=r(75192),C=(0,a.Z)(U);exports.default=(0,m.memo)((function(e){var t=e.uid;console.log("user_follow");var r=(0,E.useDispatch)(),a=(0,m.useState)({}),n=(0,i.default)(a,2),l=n[0],s=n[1],f=(0,m.useState)([]),d=(0,i.default)(f,2),k=d[0],Z=d[1],_=(0,E.useSelector)((function(e){return e.account})),U=(0,m.useMemo)((function(){return _.profile.userId===Number(t)}),[t]),M=(0,m.useRef)(),P=(0,m.useRef)(),R=(0,m.useRef)(0),S=(0,m.useRef)(!0),I=function(){var e=(0,o.default)(p.default.mark((function e(){var r,a;return p.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,h.apiUserDetail)({uid:t});case 3:r=e.sent,a=r.profile,s(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,o.default)(p.default.mark((function e(){var r,a,n;return p.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S.current){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,h.apiUserFollows)({uid:t,limit:30,offset:R.current});case 5:r=e.sent,a=r.follow,n=r.more,R.current+=30,S.current=n,Z((function(e){return[].concat((0,c.default)(e),(0,c.default)(a))})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),D=(0,m.useCallback)(function(){var e=(0,o.default)(p.default.mark((function e(t){var r;return p.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,h.apiFollow)({id:t,t:1});case 3:r=e.sent,(0,u.default)(r),Z((0,x.default)((function(e){e[e.findIndex((function(e){return e.userId===t}))].followed=!0}))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),[]);return(0,m.useEffect)((function(){I()}),[]),(0,N.default)(L,M,P),v.default.createElement("div",{className:"domUser_followlist h-full overflow-auto",ref:M},v.default.createElement("div",{className:"h1 domUser_subpage_header ui_header"},v.default.createElement(w.Link,{to:"./"},l.nickname),"的关注"),v.default.createElement("div",{className:"domUser_followlist_main"},v.default.createElement(C.default,{isSelf:U,list:k,handleClick:D,handleLetter:function(e,t){r((0,b.setPopupLetterToggle)()),r((0,y.setMsgPrivateHistory)({uid:e,nickname:t,showMsgPrivateHistory:!0}))}},v.default.createElement("div",{className:"empty"},"还没有关注")),v.default.createElement("div",{ref:P}),S.current&&v.default.createElement("div",{className:"flex-center"},v.default.createElement(g.default,null))))}))}}]);