(self.webpackChunkwyy=self.webpackChunkwyy||[]).push([[281],{3940:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var r=n(7329),c=n(2137),a=n(9351),u=n(7757),s=n.n(u),o=(n(1249),n(2222),n(3804)),l=n.n(o),i=n(847),m=n(6955),f=n(5763),p=n(9301),d=n(8556);const v=(0,o.memo)((function(){var e=(0,i.useParams)().id,t=(0,o.useState)([]),n=(0,a.Z)(t,2),u=n[0],v=n[1],h=(0,o.useRef)(!0),k=(0,o.useRef)(0),y=(0,o.useRef)(),x=(0,o.useRef)(),w=function(){var t=(0,c.Z)(s().mark((function t(n,r){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,m.W3)({id:e,cid:n,t:r?1:0,type:0});case 3:200===t.sent.code&&v(u.map((function(e){return e.commentId===n&&(e.liked=r,e.likedCount+=r?1:-1),e}))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}(),Z=function(){var t=(0,c.Z)(s().mark((function t(){var n,c,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(h.current){t.next=2;break}return t.abrupt("return",!1);case 2:return t.prev=2,t.next=5,(0,m.jH)({id:e,type:0,limit:20,offset:k.current});case 5:n=t.sent,c=n.hotComments,a=n.hasMore,h.current=a,k.current+=20,v((function(e){return[].concat((0,r.Z)(e),(0,r.Z)(c))})),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[2,13]])})));return function(){return t.apply(this,arguments)}}();return(0,p.Z)(Z,x,y),l().createElement("div",{className:"domComment px-8 py-5 overflow-auto max-h-full flex-auto",ref:x},l().createElement("div",{className:"h1"},"精彩评论"),l().createElement("div",{className:"domComment_list"},u.map((function(e){return l().createElement(f.Z,{item:e,handleLike:w,key:e.commentId})})),h.current&&l().createElement("div",{className:"flex justify-center py-4"},l().createElement(d.Z,null)),l().createElement("div",{ref:y})))}))}}]);