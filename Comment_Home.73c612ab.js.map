{"version":3,"file":"Comment_Home.73c612ab.js","mappings":"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","sources":["webpack://wyy/./src/pages/Comment/Home.tsx"],"sourcesContent":["import React, { memo, useEffect, useState, useMemo, useCallback } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { IconPlayerPlay, IconMoodSmile, IconAt, IconHash } from \"@tabler/icons\";\nimport {\n  apiCommentMusic,\n  apiSongDetail,\n  apiCommentMV,\n  apiMVDetail,\n  apiCommentVideo,\n  apiVideoDetail,\n} from \"@/api\";\nimport { commentLimit as limit } from \"@/common/config\";\nimport Write from \"@/components/Write\";\nimport DomCommentsList from \"@/components/CommentsList\";\nimport DomLoading from \"@/components/Loading\";\nimport DomPage from \"@/components/Page\";\n\nconst DomSongHeader = ({ detail }) => (\n  <div className=\"domComment_header\">\n    <div className=\"domComment_infos flex \">\n      <div className=\"cover h-20 rounded overflow-hidden relative\">\n        <img\n          loading={\"lazy\"}\n          className=\"h-full\"\n          src={detail.al.picUrl}\n          alt=\"\"\n        />\n        <div className=\"ico absolute inset-0 m-auto flex-center w-8 h-8 ui_themeColor rounded-full bg-white bg-opacity-90\">\n          <IconPlayerPlay size={16} className=\"fill-current\" />\n        </div>\n      </div>\n      <div className=\"content px-6 py-2\">\n        <div className=\"title text-lg\">{detail.name}</div>\n        <div className=\"info text-gray-500 mt-2 space-x-5\">\n          <span>\n            专辑：\n            <Link\n              className=\"ui_text_gray_hover\"\n              to={`/playlist/album/${detail.al.id}`}\n            >\n              {detail.al?.name}\n            </Link>\n          </span>\n          <span>\n            歌手：\n            {detail.ar.map((item, index) => (\n              <span key={item.id}>\n                {index > 0 && \" / \"}\n                <Link className=\"ui_text_gray_hover\" to={`/artist/${item.id}`}>\n                  {item.name}\n                </Link>\n              </span>\n            ))}\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nconst switchs = {\n  song: {\n    apiDetail: ({ id }) => apiSongDetail({ ids: id }),\n    apiComment: apiCommentMusic,\n    header: DomSongHeader,\n  },\n  mv: {\n    apiDetail: apiMVDetail,\n    apiComment: apiCommentMV,\n    header: () => <div />,\n  },\n  video: {\n    apiDetail: apiVideoDetail,\n    apiComment: apiCommentVideo,\n    header: () => <div />,\n  },\n};\n\nexport default memo(({ id, type }) => {\n  console.log(\"comment\");\n  const [detail, setDetail] = useState({});\n  const [comments, setComments] = useState({});\n  const [value, setValue] = useState(\"\");\n  const [loading, SetLoading] = useState(true);\n  const [page, setPage] = useState(1);\n  const handleDetailInit = async () => {\n    try {\n      const { songs } = await switchs[type].apiDetail({\n        id,\n      });\n      setDetail(songs[0]);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const handleChange = useCallback((e) => {\n    setValue(e.target.value);\n  }, []);\n\n  const handleCommentsInit = async () => {\n    try {\n      const comments = await switchs[type].apiComment({\n        id,\n        offset: (page - 1) * 20,\n        limit,\n      });\n      setComments(comments);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const handleInit = async () => {\n    await handleDetailInit();\n    await handleCommentsInit();\n    SetLoading(false);\n  };\n\n  const MemoHeader = useMemo(() => switchs[type].header, [type]);\n\n  useEffect(() => {\n    if (loading) {\n      handleInit();\n    } else {\n      handleCommentsInit();\n    }\n  }, [page]);\n\n  if (loading)\n    return (\n      <div className=\"w-full h-full flex-center\">\n        <DomLoading />\n      </div>\n    );\n  return (\n    <div className=\"domComment overflow-auto px-8 py-5 h-full\">\n      <MemoHeader detail={detail} />\n      <div className=\"domComment_write mt-4\">\n        <Write onChange={handleChange} max={140} />\n        <div className=\"domComment_write_actions flex mt-2.5\">\n          <div className=\"flex space-x-2\">\n            <button type=\"button\" className=\"text-gray-500 hover:text-black\">\n              <IconMoodSmile size={20} stroke={1.5} />\n            </button>\n            <button type=\"button\" className=\"text-gray-500 hover:text-black\">\n              <IconAt size={20} stroke={1.5} />\n            </button>\n            <button type=\"button\" className=\"text-gray-500 hover:text-black\">\n              <IconHash size={20} stroke={1.5} />\n            </button>\n          </div>\n          <button\n            type=\"button\"\n            className=\"ui_btn flex-center border px-4 h-8 text-sm hover:bg-gray-100 rounded-full ml-auto\"\n          >\n            评论\n          </button>\n        </div>\n      </div>\n      <div className=\"domComment_main mt-8\">\n        <DomCommentsList comments={comments} more={id} type={type} />\n        <DomPage\n          total={Math.ceil(comments.total / limit)}\n          page={page}\n          func={setPage}\n        />\n      </div>\n    </div>\n  );\n});\n"],"names":["switchs","song","apiDetail","id","apiSongDetail","ids","apiComment","apiCommentMusic","header","detail","className","loading","src","al","picUrl","alt","IconPlayerPlay","size","name","Link","to","ar","map","item","index","key","mv","apiMVDetail","apiCommentMV","video","apiVideoDetail","apiCommentVideo","memo","type","console","log","useState","setDetail","comments","setComments","setValue","SetLoading","page","setPage","handleDetailInit","songs","handleChange","useCallback","e","target","value","handleCommentsInit","offset","limit","handleInit","MemoHeader","useMemo","useEffect","onChange","max","IconMoodSmile","stroke","IconAt","IconHash","more","total","Math","ceil","func"],"sourceRoot":""}