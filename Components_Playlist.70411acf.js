"use strict";(this.webpackChunkwyy=this.webpackChunkwyy||[]).push([[123],{4441:(e,t,a)=>{a.r(t);var l=a(29604);Object.defineProperty(t,"__esModule",{value:!0});var n=a(87363),r=(0,l.Z)(n),u=a(92470),s=a(80067),c=(0,l.Z)(s),o=a(70805),i=(0,l.Z)(o);a(53507);var m=a(1343);exports.default=function(){var e=(0,m.useAppSelector)((function(e){return e.letter})).showMsgPrivateHistory,t=(0,m.useAppSelector)((function(e){return e.mask})).popupStatus,a=(0,m.useAppDispatch)();return(0,n.useEffect)((function(){return function(){a((0,u.setMsgPrivateHistory)({showMsgPrivateHistory:!1}))}}),[]),"letter"!==t?null:r.default.createElement("div",{id:"privateLetter",className:"flex flex-col absolute z-40"},e?r.default.createElement(i.default,null):r.default.createElement(c.default,null))}},80067:(e,t,a)=>{a.r(t);var l=a(29604);Object.defineProperty(t,"__esModule",{value:!0});var n=a(48926),r=(0,l.Z)(n),u=a(63038),s=(0,l.Z)(u),c=a(87757),o=(0,l.Z)(c);a(68309),a(69600),a(21249);var i=a(87363),m=(0,l.Z)(i),f=a(27484),d=(0,l.Z)(f),p=a(66711),v=a(94184),g=(0,l.Z)(v),E=a(63233),x=a(92470),h=a(26405),b=a(1343),y={song:function(e){return m.default.createElement("span",null,"单曲：「",e.song.name,e.song.alias.length>0&&m.default.createElement("span",{className:"text-gray-400"},"（".concat(e.song.alias.join(","),"）")),"」")},album:function(e){return m.default.createElement("span",null,"专辑：「",e.album.name,"」")},topic:function(e){return m.default.createElement("span",null,"专栏文章：「",e.topic.title,"」")},promotionUrl:function(e){return m.default.createElement("span",null,e.promotionUrl.text,"：「",e.msg,"」")},picInfo:function(){return"[图片]"}},N=["私信","评论","@我","通知"];exports.default=function(){var e=(0,b.useAppDispatch)(),t=(0,b.useAppSelector)((function(e){return e.common})),a=t.isLogin,l=t.newMsgCount,n=t.msgs,u=void 0===n?[]:n,c=t.comments,f=void 0===c?[]:c,v=t.forwards,w=void 0===v?[]:v,k=t.notices,M=void 0===k?[]:k,P=(0,i.useState)([]),_=(0,s.default)(P,2),Z=_[0],I=_[1],S=(0,i.useState)("私信"),C=(0,s.default)(S,2),U=C[0],H=C[1],z=function(){var t=(0,r.default)(o.default.mark((function t(a){var l,n,r,u,s;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a();case 3:l=t.sent,n=l.msgs,r=l.comments,u=l.forwards,s=l.notices,e((0,h.setMsgPrivate)({msgs:n,comments:r,forwards:u,notices:s})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}(),j=function(e){H(e),"私信"===e?(z(E.apiMsgPrivate),I(u)):"评论"===e?(z(E.apiMsgComments),I(f)):"@我"===e?(z(E.apiMsgForwards),I(w)):"通知"===e&&(z(E.apiMsgNotices),I(M))};(0,i.useEffect)((function(){j(U)}),[]);var D=function(){var t=(0,r.default)(o.default.mark((function t(a,l){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e((0,x.setMsgPrivateHistory)({uid:a,nickname:l,showMsgPrivateHistory:!0}));case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();return m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"header flex items-baseline p-6 pb-b"},m.default.createElement("span",{className:"title text-lg"},"消息"),a?m.default.createElement("button",{type:"button",className:"clear text-sm font-bold ml-auto ui_link"},"一键已读"):m.default.createElement("span",{className:"clear text-sm font-bold ml-auto ui_disabled"},"一键已读")),m.default.createElement("div",{className:"nav flex-none flex m-auto w-min rounded-full border"},N.map((function(e){return m.default.createElement("button",{onClick:function(){return j(e)},type:"button",key:e,className:(0,g.default)("nav_link relative w-20 h-8 rounded-full",U===e?"bg-gray-400 text-white":"hover:bg-gray-200")},e,"私信"===e&&m.default.createElement("span",{className:"lt_ico border border-white rounded-full leading-tight px-1 absolute top-0 right-0 bg-red-500 transform translate-x-1/2 -translate-y-1/2 z-10"},l))}))),m.default.createElement("div",{className:"list mt-3 overflow-auto max-h-full flex-auto"},Z.length>0?Z.map((function(e){var t;return m.default.createElement("div",{className:"item flex pr-4 pt-4 hover:bg-gray-100",key:e.fromUser.userId},m.default.createElement("div",{className:"w-4 flex-center h-8"},e.newMsgCount>0&&m.default.createElement("i",{className:"rounded-full w-1.5 h-1.5 bg-red-500"})),m.default.createElement(p.Link,{to:"/user/".concat(e.fromUser.userId),className:"avatar w-8 h-8 relative flex-none"},m.default.createElement("img",{className:"rounded-full",src:e.fromUser.avatarUrl,alt:""}),m.default.createElement("i",{className:"ico absolute right-0 bottom-0 w-3.5 h-3.5"},m.default.createElement("img",{className:"ui_containimg",src:null===(t=e.fromUser.avatarDetail)||void 0===t?void 0:t.identityIconUrl,alt:""}))),m.default.createElement("button",{type:"button",className:"content border-b pb-3 flex-auto text-left ml-2.5 w-0",onClick:function(){return D(e.fromUser.userId,e.fromUser.nickname)}},m.default.createElement("div",{className:"top flex"},m.default.createElement("span",{className:"ui_link"},e.fromUser.nickname),m.default.createElement("span",{className:"time ml-auto text-gray-400"},(0,d.default)(e.lastMsgTime).format("YYYY年MM月DD日"))),m.default.createElement("div",{className:"bottom truncate"},function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,a=["song","album","topic","promotionUrl","picInfo"];t<a.length;t++){var l=a[t];if(e[l])return y[l](e)}return e.msg}(JSON.parse(e.lastMsg)))))})):m.default.createElement("div",{className:"empty"},"暂无",U,"内容")))}},70805:(e,t,a)=>{a.r(t);var l=a(29604);Object.defineProperty(t,"__esModule",{value:!0});var n=a(48926),r=(0,l.Z)(n),u=a(63038),s=(0,l.Z)(u),c=a(87757),o=(0,l.Z)(c);a(68309),a(69600),a(21249);var i=a(87363),m=(0,l.Z)(i),f=a(27484),d=(0,l.Z)(f),p=a(14711),v=a(63233),g=a(92470),E=a(12503),x=a(66711),h=a(16719),b=a(43785),y=(0,l.Z)(b),N=a(94592),w=(0,l.Z)(N),k=a(1343),M=function(e){var t=e.msg,a=void 0===t?{}:t;return m.default.createElement("button",{type:"button",className:"share w-56 flex rounded p-2 bg-gray-50 mt-2"},m.default.createElement("div",{className:"avatar flex-none w-10 h-10 rounded relative overflow-hidden"},m.default.createElement("img",{src:"".concat(a.song.album.picUrl,"?param=100y100"),alt:""}),m.default.createElement("i",{className:"absolute inset-0 m-auto w-6 h-6 bg-white bg-opacity-90 flex-center rounded-full ui_themeColor"},m.default.createElement(h.IconPlayerPlay,{size:14,className:"fill-current"}))),m.default.createElement("div",{className:"content flex-auto w-0 pl-2.5 text-left"},m.default.createElement("div",{className:"name truncate"},a.song.name,a.song.alias.length>0&&m.default.createElement("span",{className:"text-gray-400"},"（".concat(a.song.alias.join(","),"）"))),m.default.createElement("div",{className:"text-gray-400 artist truncate"},a.song.artists.map((function(e,t){return m.default.createElement("span",{key:e.name},t>0&&" / ",e.name)})))))},P=function(e){var t=e.msg,a=void 0===t?{}:t;return m.default.createElement(x.Link,{to:"/playlist/album/".concat(a.album.id),className:"share flex rounded p-2 bg-gray-50 mt-2 w-56"},m.default.createElement("button",{type:"button",className:"avatar flex-none w-10 h-10 rounded relative overflow-hidden group"},m.default.createElement("img",{src:"".concat(a.album.picUrl,"?param=100y100"),alt:""}),m.default.createElement("i",{className:"absolute opacity-0 group-hover:opacity-100 inset-0 m-auto w-6 h-6 bg-white bg-opacity-90 flex-center rounded-full ui_themeColor"},m.default.createElement(h.IconPlayerPlay,{size:14,className:"fill-current"}))),m.default.createElement("div",{className:"content flex-auto w-0 pl-2.5 text-left"},m.default.createElement("div",{className:"name truncate"},a.album.name,a.album.alias.length>0&&m.default.createElement("span",{className:"text-gray-400"},"（".concat(a.album.alias.join(","),"）"))),m.default.createElement("div",{className:"text-gray-400 artist truncate"},a.album.artist.name)))},_=function(e){var t=e.msg,a=void 0===t?{}:t;return m.default.createElement("div",{className:"img"},m.default.createElement("img",{src:a.picInfo.picUrl,className:"",alt:""}))},Z=function(e){var t=e.msg,a=void 0===t?{}:t,l=a.type;return 16===l?m.default.createElement(_,{msg:a}):m.default.createElement(m.default.Fragment,null,(0,p.transTextEmoji)(a.msg),1===l&&m.default.createElement(M,{msg:a}),2===l&&m.default.createElement(P,{msg:a}))},I=function(e){var t=e.msg,a=void 0===t?{}:t;return m.default.createElement("div",{className:"flex"},m.default.createElement("div",{className:"w-60 flex"},m.default.createElement("div",{className:"rounded-lg rounded-tl-none bg-blue-50 p-3 select-text"},m.default.createElement(Z,{msg:a}))))},S=function(e){var t=e.msg,a=void 0===t?{}:t;return m.default.createElement("div",{className:"flex"},m.default.createElement("div",{className:"ml-auto w-60 flex"},m.default.createElement("div",{className:"ml-auto rounded-lg rounded-br-none bg-blue-50 p-3 select-text"},m.default.createElement(Z,{msg:a}))))};exports.default=function(){var e=(0,k.useAppDispatch)(),t=(0,i.useRef)(),a=(0,k.useAppSelector)((function(e){return e.letter})),l=a.uid,n=a.hint,u=a.nickname,c=a.privatMsgs,f=(0,k.useAppSelector)((function(e){return e.account})).profile,p=(0,i.useState)(!1),x=(0,s.default)(p,2),b=x[0],N=x[1],M=(0,i.useState)(""),P=(0,s.default)(M,2),_=P[0],Z=P[1],C=function(){var a=(0,r.default)(o.default.mark((function a(){var n,r,u,s;return o.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,v.apiMsgPrivateHistory)({uid:l});case 3:n=a.sent,r=n.hint,u=n.msgs,s=void 0===u?[]:u,e((0,g.setMsgPrivateHistory)({hint:r,privatMsgs:s.reverse()})),t.current.scrollTo(0,t.current.scrollHeight),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),console.log(a.t0);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})));return function(){return a.apply(this,arguments)}}(),U=function(){var t=(0,r.default)(o.default.mark((function t(){var a,n,r;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,v.apiSendText)({user_ids:l,msg:_});case 3:a=t.sent,n=a.newMsgs,r=void 0===n?[]:n,e((0,g.setMsgPrivateHistory)({privatMsgs:r.reverse()})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}();return(0,i.useEffect)((function(){C()}),[l]),m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"topbar relative text-center text-sm flex-center",style:{height:50}},m.default.createElement("button",{type:"button",className:"back absolute inset-y-0 left-0 p-2.5 flex-center ui_text_gray_hover",onClick:function(){return e((0,g.setMsgPrivateHistory)({showMsgPrivateHistory:!1}))}},m.default.createElement(h.IconChevronLeft,{size:22})),m.default.createElement("span",null,u)),m.default.createElement("div",{className:"history overflow-auto max-h-full flex-auto px-5",ref:t},c.map((function(e){return m.default.createElement("div",{className:"item mt-5",key:e.id},m.default.createElement("div",{className:"time text-gray-400"},(0,d.default)(e.time).format("YYYY年MM月DD日 HH:mm")),e.toUser.userId===f.userId?m.default.createElement("div",{className:"msg flex justify-start"},m.default.createElement("div",{className:"avatar flex-none mr-4 rounded-full overflow-hidden w-8 h-8"},m.default.createElement("img",{className:"",src:e.fromUser.avatarUrl,alt:""})),m.default.createElement(I,{msg:JSON.parse(e.msg)})):m.default.createElement(S,{msg:JSON.parse(e.msg)}))})),n&&m.default.createElement("div",{className:"hint"},n)),m.default.createElement("div",{className:"feedback p-3"},m.default.createElement(w.default,{value:_,setValue:Z,length:200,placeholder:"回复 ".concat(u)}),m.default.createElement("div",{className:"actions flex mt-2.5"},m.default.createElement("div",{className:"left relative"},b&&m.default.createElement("div",{className:"-translate-x-3 -translate-y-1/2 absolute faces right-full top-1/2 transform"},m.default.createElement(y.default,{handleHide:function(){return N(!1)},clickface:function(e){Z(_+e)}})),m.default.createElement("button",{type:"button",className:"action",onClick:function(){return N(!b)}},m.default.createElement(h.IconMoodSmile,{size:24,stroke:1.4})),m.default.createElement("button",{type:"button",className:"action"},m.default.createElement(h.IconPhoto,{size:24,stroke:1.4}))),m.default.createElement("button",{type:"button",className:"ml-auto border px-4 h-8 rounded-full",onClick:function(){(0,E.wordLength)(_)<=200?(U(),Z("")):console.log("to long")}},"发送"))))}},74305:(e,t,a)=>{a.r(t);var l=a(29604);Object.defineProperty(t,"__esModule",{value:!0});var n=a(4441);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(0,l.Z)(n).default}})},67282:(e,t,a)=>{a.r(t);var l=a(29604);Object.defineProperty(t,"__esModule",{value:!0}),a(21249),a(68309);var n=a(87363),r=(0,l.Z)(n),u=a(21624),s=a(94184),c=(0,l.Z)(s),o=a(27484),i=(0,l.Z)(o),m=a(66711),f=a(16719),d=a(90266),p=a(93011),v=a(16823),g=(0,l.Z)(v),E=a(67317),x=(0,l.Z)(E);a(74542);var h=function(){var e=(0,u.useDispatch)();return r.default.createElement("div",{className:"empty w-min m-auto pt-20 whitespace-nowrap"},r.default.createElement("div",{className:"text-gray-400 text-sm text"},"您还没添加任何歌曲！"),r.default.createElement("div",{className:"text-gray-400 mt-6"},"去首页",r.default.createElement(m.Link,{to:"/",className:"ui_text_black_hover underline",onClick:function(){return e((0,p.setPopupPlaylistToggle)({}))}},"发现音乐")))},b=function(e){var t=e.list,a=void 0===t?[]:t,l=e.currentId;if(0===a.length)return r.default.createElement(h,null);var n=(0,u.useSelector)((function(e){return e.audio})).running;return r.default.createElement("div",null,a.map((function(e,t){return r.default.createElement(x.default,{schema:[["评论","播放"],["收藏到歌单","分享","复制链接","不感兴趣","下载"]],type:"song",item:e,key:e.id,tabIndex:"2",className:(0,c.default)("flex items-center hover:bg-gray-100 focus:bg-gray-200 focus:outline-none h-9 group ",{"bg-gray-50":t%2==1,ui_themeColor:e.id===l})},r.default.createElement("div",{className:"w-6 flex-center flex-none"},e.id===l&&(n?r.default.createElement(f.IconPlayerPlay,{className:"fill-current ui_themeColor",size:12}):r.default.createElement(f.IconPlayerPause,{size:12,className:"fill-current ui_themeColor",stroke:1}))),r.default.createElement("div",{className:"name flex-auto w-0"},r.default.createElement(g.default,{item:e})),r.default.createElement("div",{className:"w-24 px-1 flex-none truncate text-gray-500 group-hover:text-black"},e.ar.map((function(e,t){return r.default.createElement("span",{key:e.id},t>0&&" / ",r.default.createElement(m.Link,{to:"/artist/".concat(e.id)},e.name))}))),r.default.createElement("div",{className:"w-8 px-1 flex-none"},r.default.createElement(m.Link,{to:"/"},r.default.createElement(f.IconLink,{size:16,stroke:1}))),r.default.createElement("div",{className:"w-16 px-1 flex-none text-gray-300 group-hover:text-black"},(0,i.default)(e.dt).format("mm:ss")))})))};exports.default=(0,n.memo)((function(){var e=(0,u.useDispatch)(),t=(0,u.useSelector)((function(e){return e.mask})).popupStatus,a=(0,u.useSelector)((function(e){return e.audio})),l=a.playlist,n=a.currentSong;return"playlist"!==t?null:r.default.createElement("div",{id:"playlist",className:"absolute right-0 shadow bg-white z-40 flex flex-col"},r.default.createElement("div",{className:"px-5 flex-none"},r.default.createElement("div",{className:"py-4"},r.default.createElement("div",{className:"h1"},"当前播放")),r.default.createElement("div",{className:"actions flex items-center pb-2.5 border-b"},r.default.createElement("span",{className:"text-gray-400"},"总".concat(l.length,"首")),r.default.createElement("div",{className:"right ml-auto flex divide-x"},r.default.createElement("button",{type:"button",className:(0,c.default)("action px-5 flex-center",{"text-gray-300":0===l.length})},r.default.createElement(f.IconFolderPlus,{size:20,stroke:1}),"收藏全部"),r.default.createElement("button",{type:"button",onClick:function(){return 0!==l.length&&e((0,d.setAudioPlaylistClear)())},className:(0,c.default)("action px-5 flex-center",{"text-gray-300":0===l.length})},"清空列表")))),r.default.createElement("div",{className:"overflow-auto h-full flex-auto"},r.default.createElement(b,{list:l,currentId:n.id})))}))},53507:(e,t,a)=>{a.r(t)},74542:(e,t,a)=>{a.r(t)}}]);