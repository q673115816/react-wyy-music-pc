"use strict";(this.webpackChunkwyy=this.webpackChunkwyy||[]).push([[288],{5454:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ae});var r=a(7363),n=a.n(r),l=a(6711),c=a(30),i=a(4184),o=a.n(i),s=a(7484),m=a.n(s),u=a(6719),d=a(7264),v=a(2837),f=a(6129),y=a(2e3),p=a(5854),E=a(9929),g=a(5101),N=function(e){var t=e.pop,a=void 0===t?0:t;return n().createElement("div",{className:"range w-20 h-1.5 rounded bg-gray-200"},n().createElement("div",{className:"h-full bg-gray-300 rounded",style:{width:"".concat(a,"%")}}))};const b=(0,r.memo)(N);var x=function(e){var t=e.songs,a=void 0===t?[]:t;return n().createElement(n().Fragment,null,n().createElement("div",{className:"songs_list",style:{"--ui_grid_template":"36px / 54px 24px 24px 37% 4fr 5fr 2fr 3fr"}},n().createElement("div",{className:"thead"},n().createElement("div",{className:"item grid items-center text-gray-400 ui_grid_template"},n().createElement("div",{className:"index"}),n().createElement("div",{className:"heart"}),n().createElement("div",{className:"download"}),n().createElement("div",{className:"name flex-auto px-2"},"音乐标题"),n().createElement("div",{className:"artist flex-none px-2"},"歌手"),n().createElement("div",{className:"album flex-none px-2"},"专辑"),n().createElement("div",{className:"duration flex-none px-2"},"时长"),n().createElement("div",{className:"pop flex-none px-2"},"热度"))),n().createElement("div",{className:"tbody"},a.map((function(e,t){return n().createElement(d.Z,{schema:[["评论","播放","下一首播放"],["收藏到歌单","分享","复制链接","下载"]],item:e,type:"song",key:e.id},n().createElement("div",{tabIndex:2,className:o()("item grid items-center hover:bg-gray-100 focus:bg-gray-200 focus:outline-none ui_grid_template",{"bg-gray-50":t%2==0})},n().createElement("div",{className:"index px-2"},n().createElement(v.Z,{index:t,id:e.id})),n().createElement("div",{className:"heart text-center"},n().createElement(f.Z,{id:e.id})),n().createElement("div",{className:"download text-center"},n().createElement(y.Z,null)),n().createElement("div",{className:"name px-2"},n().createElement(p.Z,{item:e})),n().createElement("div",{className:"artist flex-none px-2 truncate text-gray-400"},n().createElement(E.Z,{artists:e.ar})),n().createElement("div",{className:"album truncate flex-none px-2"},n().createElement(g.Z,{name:e.al.name,id:e.al.name})),n().createElement("div",{className:"duration text-gray-400 truncate flex-none px-2"},m()(e.dt).format("mm:ss")),n().createElement("div",{className:"pop"},n().createElement(b,{pop:e.pop}))))})))))};const h=(0,r.memo)(x);var k={"--grid-template-columns":"60px 6fr min-content"},w={"--grid-template-columns":"60px 1fr 1fr"},_=a(9227),S=function(e){var t=e.videos,a=(void 0===t?[]:t).map((function(e){var t=e.type,a=e.title,r=e.coverUrl,n=e.playTime,l=e.creator;return{id:e.vid,type:t,title:a,creator:l,playCount:n,duration:e.durationms,cover:r}}));return n().createElement("div",{className:"videos_list py-5 px-10"},n().createElement(_.Z,{list:a}))};const C=(0,r.memo)(S);var A={"--grid-template-columns":"60px 6fr 2fr 5fr"};function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function I(e){var t,a,l=e.lyrics,c=void 0===l?[]:l,i=(0,r.useRef)(),o=(t=(0,r.useState)(!1),a=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var r,n,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(r=a.next()).done)&&(l.push(r.value),!t||l.length!==t);c=!0);}catch(e){i=!0,n=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw n}}return l}}(t,a)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?j(e,t):void 0}}(t,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=o[0],m=o[1];(0,r.useEffect)((function(){i.current=c.join("\n").replace(/<b>|<\/b>/gm,"")}),[c]);var u=function(){var e=document.createElement("textarea");e.setAttribute("readonly","readonly"),e.textContent=i.current,document.body.appendChild(e),e.select(),document.execCommand("copy")&&(document.execCommand("copy"),console.log("复制成功")),document.body.removeChild(e)};return n().createElement("div",{className:"lrc flex pb-2"},n().createElement("div",{className:"content w-2/3 px-2 text-gray-500"},c.slice(0,s?1/0:4).map((function(e,t){return n().createElement("div",{key:e+t,dangerouslySetInnerHTML:{__html:e}})}))),n().createElement("div",{className:"actions w-1/3 flex flex-col justify-between"},n().createElement("div",{className:"flex space-x-2.5"},n().createElement("button",{type:"button",className:"flex-center border border-gray-400 px-3 h-6 hover:bg-gray-300 rounded-full",onClick:function(){return m(!s)}},s?"收起":"展开","歌词"),n().createElement("button",{type:"button",className:"flex-center border border-gray-400 px-3 h-6 hover:bg-gray-300 rounded-full clip",onClick:u},"复制歌词")),s&&n().createElement("div",{className:"flex space-x-2.5"},n().createElement("button",{type:"button",className:"flex-center border border-gray-400 px-3 h-6 hover:bg-gray-300 rounded-full",onClick:function(){return m(!1)}},"收起歌词"),n().createElement("button",{type:"button",className:"flex-center border border-gray-400 px-3 h-6 hover:bg-gray-300 rounded-full clip",onClick:u},"复制歌词"))))}var Z={"--grid-template-columns":"60px 5fr 2fr"},L=function(e){var t=e.djRadios,a=void 0===t?[]:t;return n().createElement("div",{className:"djRadios_list _list",style:Z},a.map((function(e,t){return n().createElement("div",{className:o()("item grid items-center hover:bg-gray-100",{"bg-gray-50":t%2==0}),key:e.id},n().createElement(l.Link,{to:"/playlist/dj/".concat(e.id),className:"cover"},n().createElement("img",{className:"",src:"".concat(e.picUrl,"?param=60y60"),alt:""})),n().createElement("div",{className:"px-5"},n().createElement(l.Link,{to:"/playlist/dj/".concat(e.id),className:"name"},e.name)),n().createElement("div",{className:"dj text-gray-300"},"by  ",n().createElement(l.Link,{to:"/user/".concat(e.dj.userId),className:"ui_text_gray_hover"},e.dj.nickname)))})))};const O=(0,r.memo)(L);var U=a(2429),T={"--grid-template-columns":"60px 5fr 2fr"},M=function(e){var t=e.userprofiles,a=void 0===t?[]:t;return n().createElement("div",{className:"userprofiles_list _list",style:T},a.map((function(e,t){return n().createElement(l.Link,{to:"/user/".concat(e.userId),className:o()("item grid items-center hover:bg-gray-100",{"bg-gray-50":t%2==1}),key:e.userId},n().createElement("div",{className:"rounded-full overflow-hidden"},n().createElement("img",{src:"".concat(e.avatarUrl,"?param=60y60"),alt:""})),n().createElement("div",{className:"name px-5"},e.nickname," ",n().createElement(U.ZP,{size:16,gender:e.gender})),n().createElement("div",{className:"signature text-gray-400 ml-auto"},e.signature))})))};const R={单曲:{code:1,unit:"首",limit:100,Node:h,countName:"songCount"},歌手:{code:100,unit:"位",limit:20,Node:function(e){var t=e.artists,a=void 0===t?[]:t;return n().createElement("div",{className:"artists_list _list",style:k},a.map((function(e,t){return n().createElement("div",{className:o()("item relative grid items-center hover:bg-gray-100",{"bg-gray-50":t%2==1}),key:e.id},n().createElement(l.Link,{to:"/artist/".concat(e.id),className:"absolute inset-0"}),n().createElement("div",{className:"cover"},n().createElement("img",{className:"",src:"".concat(e.img1v1Url,"?param=60y60"),alt:""})),n().createElement("div",{className:"name px-2.5 text-sm"},e.name,e.alia&&n().createElement("span",{className:"text-gray-400"},"(",null==e?void 0:e.alias[0],")")),e.accountId&&n().createElement("span",{className:"account bg-red-500 w-4 h-4 rounded-full text-white flex-center"},n().createElement(u.IconUser,{size:12,stroke:3})))})))},countName:"artistCount"},专辑:{code:10,unit:"张",limit:20,Node:function(e){var t=e.albums,a=void 0===t?[]:t;return n().createElement("div",{className:"albums_list _list",style:w},a.map((function(e,t){return n().createElement("div",{tabIndex:"2",className:o()("item grid items-center relative hover:bg-gray-100",{"bg-gray-50":t%2==1}),key:e.id},n().createElement(l.Link,{className:"absolute inset-0 z-0",to:"/playlist/album/".concat(e.id)}),n().createElement("div",{className:"cover"},n().createElement("img",{src:"".concat(e.picUrl,"?param=60y60"),alt:""})),n().createElement("div",{className:"name px-5 text-sm"},e.name,e.alias.length>0&&n().createElement("span",{className:"text-gray-400"},"（".concat(e.alias,"）"))),n().createElement("div",{className:"artist truncate"},n().createElement(l.Link,{to:"/artist/".concat(e.artist.id),className:"ui_text_gray_hover relative z-10"},e.artist.name,e.artist.alias.length>0&&n().createElement("span",{className:"text-gray-400"},"（".concat(e.artist.alias,"）")))))})))},countName:"albumCount"},视频:{code:1014,unit:"个",limit:24,Node:C,countName:"videoCount"},歌单:{code:1e3,unit:"个",limit:20,Node:function(e){var t=e.playlists,a=void 0===t?[]:t;return n().createElement("div",{className:"playlists_list _list",style:A},a.map((function(e,t){return n().createElement("div",{className:o()("item grid items-center relative hover:bg-gray-100",{"bg-gray-50":t%2==1}),key:e.id},n().createElement(l.Link,{className:"absolute inset-0 z-0",to:"/playlist/music/".concat(e.id)}),n().createElement("div",{className:"cover"},n().createElement("img",{className:"",src:"".concat(e.coverImgUrl,"?param=60y60"),alt:""})),n().createElement("div",{className:"name px-3"},e.name),n().createElement("div",{className:"trackCount text-gray-400"},e.trackCount,"首"),n().createElement("div",{className:"creator text-gray-300"},"by  ",n().createElement(l.Link,{to:"/user/".concat(e.creator.userId),className:"ui_text_black_hover relative z-10"},e.creator.nickname)))})))},countName:"playlistCount"},歌词:{code:1006,unit:"首",limit:20,Node:function(e){var t=e.songs,a=void 0===t?[]:t;return n().createElement("div",{className:"lyrics_list",style:{"--ui_grid_template":"36px / 54px 24px 24px 37% 4fr 5fr 2fr 3fr"}},n().createElement("div",{className:"thead"},n().createElement("div",{className:"item grid items-center text-gray-400 ui_grid_template"},n().createElement("div",{className:"index"}),n().createElement("div",{className:"heart"}),n().createElement("div",{className:"download"}),n().createElement("div",{className:"name"},"音乐标题"),n().createElement("div",{className:"artist"},"歌手"),n().createElement("div",{className:"album"},"专辑"),n().createElement("div",{className:"duration"},"时长"),n().createElement("div",{className:"text-gray-400"},"热度"))),n().createElement("div",{className:"tbody"},a.map((function(e,t){return n().createElement(d.Z,{schema:[["评论","播放","下一首播放"],["收藏到歌单","分享","复制链接","下载"]],item:e,type:"song",key:e.id},n().createElement("div",{tabIndex:"2",className:o()("item grid items-center hover:bg-gray-100 focus:outline-none focus:bg-gray-200 ui_grid_template",{"bg-gray-50":t%2==0})},n().createElement("div",{className:"index pr-2"},n().createElement(v.Z,{index:t,id:e.id})),n().createElement("div",{className:"heart"},n().createElement(f.Z,{id:e.id})),n().createElement("div",{className:"download"},n().createElement(y.Z,null)),n().createElement("div",{className:"name flex"},n().createElement(p.Z,{item:e})),n().createElement("div",{className:"artist truncate"},n().createElement(E.Z,{artists:e.ar})),n().createElement("div",{className:"album truncate"},n().createElement(g.Z,{name:e.al.name,id:e.al.id})),n().createElement("div",{className:"duration text-gray-400 truncate"},m()(e.dt).format("mm:ss")),n().createElement("div",{className:"pop"},n().createElement(b,{pop:e.pop})),n().createElement(I,{lyrics:e.lyrics})))}))))},countName:"songCount"},主播电台:{code:1009,unit:"个",limit:100,Node:O,countName:"djRadiosCount"},用户:{code:1002,unit:"位",limit:20,Node:(0,r.memo)(M),countName:"userprofileCount"}};var P=a(4837),z=a(9381);function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function V(e,t){if(e){if("string"==typeof e)return q(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?q(e,t):void 0}}var $=function(){var e,t,a,i=(0,l.useParams)(),s=i.keywords,m=void 0===s?"":s,u=i.type,d=void 0===u?"":u,v=(t=(0,c.Z)("searchHistory",[]),a=3,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var r,n,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(r=a.next()).done)&&(l.push(r.value),!t||l.length!==t);c=!0);}catch(e){i=!0,n=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw n}}return l}}(t,a)||V(t,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=v[0],y=v[1],p=(v[2],(0,P.C)(z.searchSelector).count),E=void 0===p?0:p;(0,r.useEffect)((function(){var e=(null==f?void 0:f.filter((function(e){return e!==m})))||[];y([m].concat(function(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||V(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e)))}),[m]);var g=(null===(e=R[d])||void 0===e?void 0:e.unit)||"";return n().createElement("div",{className:"domSearch overflow-auto max-h-full flex-auto"},n().createElement("div",{className:"p-8 pb-2.5 border-b"},n().createElement("div",{className:"font-bold text-base"},"找到",E,g),n().createElement("div",{className:"mt-5 space-x-4"},Object.keys(R).map((function(e){return n().createElement(l.NavLink,{key:e,to:e,className:function(e){var t=e.isActive;return o()("text-sm",t&&"font-bold")}},e)})))),n().createElement(l.Outlet,null))};const F=(0,r.memo)($);var G=a(5666),H=a.n(G),Q=a(4719),B=a(3912),D=a(6910).u.injectEndpoints({endpoints:function(e){return{getCloudSearch:e.mutation({query:function(e){return{url:"cloudSearch",method:"POST",body:e}}}),getSearchMultimatch:e.query({query:function(e){return{url:"search/multimatch",method:"POST",body:e}}})}}}),J=D.useGetCloudSearchMutation;function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function W(e,t,a,r,n,l,c){try{var i=e[l](c),o=i.value}catch(e){return void a(e)}i.done?t(o):Promise.resolve(o).then(r,n)}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var r,n,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(r=a.next()).done)&&(l.push(r.value),!t||l.length!==t);c=!0);}catch(e){i=!0,n=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw n}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?K(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}D.useGetSearchMultimatchQuery;var Y=function(){console.log("entry search");var e=(0,l.useParams)(),t=e.keywords,a=void 0===t?"":t,c=e.type,i=void 0===c?"":c,o=(0,P.T)(),s=X((0,r.useState)(1),2),m=s[0],u=s[1],d=X((0,r.useState)({}),2),v=d[0],f=d[1],y=X((0,r.useState)(0),2),p=y[0],E=y[1],g=R[i],N=g.code,b=g.limit,x=g.Node,h=g.countName,k=(0,P.C)((function(e){return e.common})).searchValue,w=X(J(),2),_=w[0],S=w[1].isLoading;(0,r.useEffect)((function(){o((0,z.setSearchCount)({count:p}))}),[p]),(0,r.useEffect)((function(){k||o((0,z.setSearchValue)({searchValue:a}))}),[]);var C,A,j=(C=H().mark((function e(t){var r,n,l;return H().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,_({keywords:a,limit:b,type:N,offset:(t-1)*b});case 3:n=e.sent,l=(null==n||null===(r=n.data)||void 0===r?void 0:r.result)||{},f(l),E(l[h]);case 7:case"end":return e.stop()}}),e)})),A=function(){var e=this,t=arguments;return new Promise((function(a,r){var n=C.apply(e,t);function l(e){W(n,a,r,l,c,"next",e)}function c(e){W(n,a,r,l,c,"throw",e)}l(void 0)}))},function(e){return A.apply(this,arguments)}),I=function(e){u(e),j(e)};return(0,r.useEffect)((function(){I(1)}),[a,i]),S?n().createElement("div",{className:"pt-48 flex-center"},n().createElement(Q.Z,null)):n().createElement(n().Fragment,null,(0,r.createElement)(x,v),n().createElement(B.Z,{total:Math.ceil(p/b),page:m,func:I}))};const ee=(0,r.memo)(Y);var te=function(){return n().createElement(l.Routes,null,n().createElement(l.Route,{path:":keywords",element:n().createElement(F,null)},n().createElement(l.Route,{path:":type",element:n().createElement(ee,null)}),n().createElement(l.Route,{index:!0,element:n().createElement(l.Navigate,{to:"单曲",replace:!0})})))};const ae=(0,r.memo)(te)}}]);
//# sourceMappingURL=Search.js.map?version=0fe1ba37