{"version":3,"file":"js/download.worker.worker.js?version=8936a6fd","mappings":"4KAAoBA,KAApB,IA+CMC,EAAU,IA9ChB,W,sBAAMC,K,qGAAN,KAEEC,aAAe,S,wBAMfC,IAAAA,O,MAAAA,SAAKC,G,WAEHC,KAAKC,KAAO,IAAIC,eAChBF,KAAKC,KAAKE,KAAK,MAAOJ,GAGtBC,KAAKC,KAAKG,aAAe,OACzBJ,KAAKC,KAAKI,iBAAiB,YAAY,SAAQ,G,IACvCC,EADwC,EAANC,OAAa,EAALC,MAEhDC,QAAQC,IAAI,WAAa,GAAiB,OAAJ,IAAXJ,EAAe,MAC1CZ,KAAKiB,YAAY,CAAEC,SAAU,WAAYN,SAAAA,OAG3CN,KAAKC,KAAKI,iBAAiB,oBAAoB,WAEd,IAAzB,EAAKJ,KAAKY,YAAyC,MAArB,EAAKZ,KAAKa,SAGxCpB,KAADiB,YAAY,CACfC,SAAU,QACVG,MAAO,MACDC,SAAI,EAAKf,KAAKe,WAKtBtB,KAAKuB,YAEPjB,KAAKC,KAAKA,S,CAGZiB,IAAAA,Q,MAAAA,WACET,QAAQC,IAAI,SACZV,KAAKC,KAAKiB,QACVxB,KAAKuB,a,mBA1CT,IAgDAvB,KAAKW,iBAAiB,WAAW,SAACc,GAChC,IAAwBA,EAAAA,EAAIC,KAApBC,EAAgBF,EAAhBE,OAAQtB,EAAQoB,EAARpB,IAChBJ,EAAQ0B,GAAQtB,O","sources":["webpack://wyy/./src/Layout/Player/Download/download.worker.ts"],"sourcesContent":["const ctx: Worker = self as any;\nclass Module {\n  send: any;\n  targetOrigin = \"player\";\n  constructor() {\n    // this.url = null;\n    // this.send = null;\n  }\n\n  init(url: string) {\n    // this.url = url;\n    this.send = new XMLHttpRequest();\n    this.send.open(\"GET\", url);\n\n    // this.send.setRequestHeader('Content-Type', 'blob');\n    this.send.responseType = \"blob\";\n    this.send.addEventListener(\"progress\", ({ loaded, total }) => {\n      const progress = loaded / total;\n      console.log(\"progress\", `${progress * 100}%`);\n      self.postMessage({ callback: \"progress\", progress });\n      // setDownloadProcess(progress);\n    });\n    this.send.addEventListener(\"readystatechange\", () => {\n      // console.log(this.send);\n      if (!(this.send.readyState === 4 && this.send.status === 200)) return;\n      // console.log('finish', this.send.response);\n      // setDownloadState('已缓存');\n      self.postMessage({\n        callback: \"state\",\n        state: \"已缓存\",\n        response: this.send.response,\n      });\n      // RefAjax.current = null;\n      // handleCreateFile();\n      // this.create();\n      self.close();\n    });\n    this.send.send();\n  }\n\n  abort() {\n    console.log(\"终止下载！\");\n    this.send.abort();\n    self.close();\n  }\n}\n\nconst methods = new Module();\n\nself.addEventListener(\"message\", (req) => {\n  const { method, url } = req.data;\n  methods[method](url);\n});\n"],"names":["self","methods","Module","targetOrigin","init","url","this","send","XMLHttpRequest","open","responseType","addEventListener","progress","loaded","total","console","log","postMessage","callback","readyState","status","state","response","close","abort","req","data","method"],"sourceRoot":""}