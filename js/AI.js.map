{"version":3,"file":"js/AI.js?version=5f410426","mappings":"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","sources":["webpack://@wyy/web/./src/features/AI/Speech.tsx","webpack://@wyy/web/./src/features/AI/Wait.tsx","webpack://@wyy/web/./src/features/AI/Icon.tsx","webpack://@wyy/web/./src/features/AI/Rejected.tsx","webpack://@wyy/web/./src/features/AI/AI.tsx","webpack://@wyy/web/./src/features/AI/Router.tsx"],"sourcesContent":["import { useAppDispatch } from \"@/modules/hooks\";\nimport { useToast } from \"@/components/Toast\";\nimport { IconBrandGithub } from \"@tabler/icons\";\nimport React, { memo, useCallback, useState, useRef } from \"react\";\n\nconst Speech = () => {\n  const dispatch = useAppDispatch();\n  const toast = useToast();\n  const [text, setText] = useState(\"\");\n  const active = useRef(false);\n  const [_active, setActive] = useState(false);\n\n  const createRecognition = () => {\n    const grammar =\n      \"#JSGF V1.0; grammar colors; public <color> = aqua | azure | beige | bisque | black | blue | brown | chocolate | coral | crimson | cyan | fuchsia | ghostwhite | gold | goldenrod | gray | green | indigo | ivory | khaki | lavender | lime | linen | magenta | maroon | moccasin | navy | olive | orange | orchid | peru | pink | plum | purple | red | salmon | sienna | silver | snow | tan | teal | thistle | tomato | turquoise | violet | white | yellow ;\";\n\n    const recognition = new webkitSpeechRecognition();\n    const speechRecognitionList = new webkitSpeechGrammarList();\n    speechRecognitionList.addFromString(grammar, 1);\n    recognition.grammars = speechRecognitionList;\n    //recognition.continuous = false;\n    // recognition.interimResults = false;\n    recognition.continuous = true;\n    recognition.interimResults = true;\n    // recognition.lang = 'en-US';\n    recognition.lang = \"cmn-Hans-CN\";\n    recognition.maxAlternatives = 1;\n\n    recognition.onresult = function (event) {\n      console.log(\"result\");\n      console.log(event);\n      let text = \"\";\n      for (const [{ transcript }] of event.results) {\n        text += transcript;\n      }\n      // const color = event.results[0][0].transcript;\n      setText(text);\n    };\n\n    recognition.onstart = (e) => {\n      console.log(e, \"start\");\n    };\n\n    recognition.onend = (e) => {\n      console.log(e, \"end\");\n      active.current = false;\n      setActive(false);\n    };\n\n    recognition.onspeechstart = (e) => {\n      console.log(e, \"speechstart\");\n    };\n\n    recognition.onspeechend = (e) => {\n      console.log(e, \"speechend\");\n    };\n\n    recognition.onsoundstart = (e) => {\n      console.log(e, \"soundstart\");\n    };\n\n    recognition.onsoundend = (e) => {\n      console.log(e, \"soundend\");\n    };\n\n    recognition.onaudiostart = (e) => {\n      console.log(e, \"audiostart\");\n    };\n\n    recognition.onaudioend = (e) => {\n      console.log(e, \"audioend\");\n    };\n    return recognition;\n  };\n  const { current: recognition } = useRef(createRecognition());\n\n  const message = `在最新浏览器下使用`;\n  const handleStart = useCallback(() => {\n    if (!(\"speechSynthesis\" in globalThis)) {\n      toast(message);\n      return;\n    }\n\n    if (active.current) {\n      // 终止会卡死一会\n      console.log(\"toggleEnd\");\n      active.current = false;\n      setActive(false);\n      recognition.abort();\n\n      return;\n    } else {\n      active.current = true;\n      setActive(true);\n      console.log(\"start\");\n      recognition.start();\n      console.log(\"Ready to receive a color command.\");\n    }\n  }, []);\n\n  return (\n    <div className=\"absolute bottom-0 left-0\">\n      {_active && <textarea value={text} readOnly />}\n      <div>\n        {_active &&\n          `(真人讲话的效果较好，但是放歌给电脑听电脑听清，所以可以选择自己唱歌给电脑听，中途关闭会小卡)`}\n      </div>\n      <button\n        type=\"button\"\n        title={message}\n        onClick={handleStart}\n        className=\"border px-2 flex-center hover:bg-black hover:text-white\"\n      >\n        <IconBrandGithub />\n        {_active ? \"正在收集声音\" : \"隐藏功能\"}\n      </button>\n    </div>\n  );\n};\n\nexport default memo(Speech);\n","import React, { FC, memo, useEffect, useState } from \"react\";\nimport { IconMicrophone } from \"@tabler/icons\";\nimport { interval, scan, startWith, takeWhile } from \"rxjs\";\n\nconst countdown$ = interval(1000).pipe(\n  startWith(15),\n  scan((time) => time - 1),\n  takeWhile((time) => time > 0)\n);\n\ninterface iProps {\n  handleCallback: () => void;\n}\n\nconst Wait: FC<iProps> = ({ handleCallback }) => {\n  const [time, setTime] = useState(15);\n  useEffect(() => {\n    const sub = countdown$.subscribe({\n      next: setTime,\n      complete: handleCallback,\n    });\n    return () => sub.unsubscribe();\n  }, []);\n\n  return (\n    <div className=\"flex flex-col items-center\">\n      <div id=\"ai_work\" className=\"p-32 relative\">\n        <div className=\"flex-center rounded-full text-white bg-red-500 w-32 h-32\">\n          <IconMicrophone size={64} />\n        </div>\n      </div>\n      <div>\n        {time % 2 === 0 || time % 3 === 0 || time % 5 === 0\n          ? \"外部声源无法识别\"\n          : \"正在识别电脑中正在播放的音乐\"}\n        {`(${time}s)`}\n      </div>\n      <button\n        type=\"button\"\n        className=\"mt-4 text-base hover:bg-gray-100 rounded border h-10 w-28\"\n        onClick={handleCallback}\n      >\n        停止识别\n      </button>\n    </div>\n  );\n};\n\nexport default memo(Wait);\n","import React, { memo } from \"react\";\n\nexport default memo(function Icon() {\n  return (\n    <svg viewBox=\"0 0 1024 1024\" width=\"256\" height=\"256\" className=\"mb-4\">\n      <path\n        d=\"M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z\"\n        fill=\"#FD8469\"\n      />\n      <path\n        d=\"M110.462992 829.68189C203.993701 948.207874 349.127559 1024 512 1024s307.2-75.792126 401.537008-194.31811H110.462992z\"\n        fill=\"#F1543F\"\n      />\n      <path\n        d=\"M586.179528 817.587402l14.513385-89.499213h-177.385826l14.513385 89.499213z\"\n        fill=\"#FFFFFF\"\n        p-id=\"17925\"\n      />\n      <path\n        d=\"M595.855118 759.533858l4.837795-31.445669h-177.385826l4.837795 31.445669z\"\n        fill=\"#E6E9EE\"\n      />\n      <path\n        d=\"M815.974803 740.182677H208.025197c-12.900787 0-23.382677-10.48189-23.382677-23.382677V278.979528c0-12.900787 10.48189-23.382677 23.382677-23.382678h608.755905c12.900787 0 23.382677 10.48189 23.382678 23.382678v437.014173c0 12.900787-10.48189 24.188976-24.188977 24.188976z\"\n        fill=\"#FFFFFF\"\n      />\n      <path\n        d=\"M227.376378 298.330709h569.247244v351.546456H227.376378z\"\n        fill=\"#84DBFF\"\n      />\n      <path\n        d=\"M227.376378 298.330709h569.247244v8.062992H227.376378z\"\n        fill=\"#54C0EB\"\n      />\n      <path\n        d=\"M635.36378 829.68189H388.63622v-12.094488c0-12.900787 10.48189-22.576378 22.576378-22.576378h200.768504c12.900787 0 22.576378 10.48189 22.576378 22.576378v12.094488h0.8063z\"\n        fill=\"#E6E9EE\"\n      />\n      <path\n        d=\"M512 690.998425m-25.801575 0a25.801575 25.801575 0 1 0 51.60315 0 25.801575 25.801575 0 1 0-51.60315 0Z\"\n        fill=\"#E6E9EE\"\n      />\n      <path\n        d=\"M681.322835 553.927559H362.834646c-6.450394 0-12.094488-5.644094-12.094489-12.094488v-166.097638c0-6.450394 5.644094-12.094488 12.094489-12.094488h318.488189c6.450394 0 12.094488 5.644094 12.094488 12.094488v166.097638c0 6.450394-5.644094 12.094488-12.094488 12.094488z\"\n        fill=\"#E6E9EE\"\n      />\n      <path\n        d=\"M375.735433 385.411024h292.686614v13.707086H375.735433zM375.735433 418.469291h292.686614v13.707087H375.735433zM375.735433 452.333858h292.686614v13.707087H375.735433zM375.735433 485.392126h292.686614v13.707087H375.735433zM375.735433 518.450394h166.097638v13.707086h-166.097638z\"\n        fill=\"#CED5E0\"\n        p-id=\"17933\"\n      />\n      <path\n        d=\"M683.741732 610.368504l24.995276-24.995276-50.796851-51.603149 41.12126-24.188977-108.044094-17.738582 17.738583 108.044094 24.188976-41.12126z\"\n        fill=\"#324A5E\"\n      />\n    </svg>\n  );\n});\n","import IconRejected from \"@/features/AI/Icon\";\nimport React, { FC, memo } from \"react\";\nimport { useToast } from \"@/components/Toast\";\n\ninterface iProps {\n  handleCallback: () => void;\n}\n\nconst Rejected: FC<iProps> = ({ handleCallback }) => {\n  const toast = useToast();\n  return (\n    <div className=\"flex flex-col items-center\">\n      <IconRejected />\n      <div className=\"text-base\">\n        未识别出音乐，仅支持当前电脑正在播放的音乐\n      </div>\n      <button\n        type=\"button\"\n        className=\"text-sm ui_theme_bg_color text-white py-2 px-6 rounded mt-4\"\n        onClick={handleCallback}\n      >\n        重新识别\n      </button>\n      <button\n        type=\"button\"\n        className=\"mt-3 text-blue-400 text-sm\"\n        onClick={() => toast(\"反馈成功，感谢您的反馈\")}\n      >\n        提交反馈\n      </button>\n    </div>\n  );\n};\n\nexport default memo(Rejected);\n","import React, { memo } from \"react\";\nimport { IconFileImport } from \"@tabler/icons\";\nimport \"./style.scss\";\nimport Speech from \"./Speech\";\nimport { useToggle } from \"react-use\";\nimport { useToast } from \"@/components/Toast\";\nimport Wait from \"./Wait\";\nimport Rejected from \"./Rejected\";\n\nexport default memo(function AI() {\n  const toast = useToast();\n  const [listen, toggleListen] = useToggle(true);\n  /**\n   * 应该不会有成功吧？\n   * TODO\n   * speech\n   */\n  return (\n    <div className=\"py-5 px-8 flex flex-col h-full relative\">\n      <Speech />\n      <div className=\"domAi_header flex items-baseline\">\n        <div className=\"h1\">听歌识曲</div>\n        <button\n          type=\"button\"\n          className=\"ml-auto flex items-center\"\n          onClick={() => toast(\"创建【听歌识曲】图标至桌面成功\")}\n        >\n          <IconFileImport size={16} stroke={1} />\n          创建桌面快捷方式\n        </button>\n      </div>\n      <div className=\"flex-auto flex-center\">\n        {listen ? (\n          <Wait handleCallback={toggleListen} />\n        ) : (\n          <Rejected handleCallback={toggleListen} />\n        )}\n      </div>\n    </div>\n  );\n});\n","import React from \"react\";\nimport { Routes, Route } from \"react-router-dom\";\nimport AI from \"./AI\";\nconst Router = () => {\n  return (\n    <Routes>\n      <Route index element={<AI />} />\n    </Routes>\n  );\n};\n\nexport default Router;\n"],"names":["Speech","useAppDispatch","recognition","speechRecognitionList","toast","useToast","useState","text","setText","active","useRef","_active","setActive","current","webkitSpeechRecognition","webkitSpeechGrammarList","addFromString","grammars","continuous","interimResults","lang","maxAlternatives","onresult","event","console","log","results","transcript","onstart","e","onend","onspeechstart","onspeechend","onsoundstart","onsoundend","onaudiostart","onaudioend","message","handleStart","useCallback","globalThis","abort","start","div","className","textarea","value","readOnly","button","type","title","onClick","IconBrandGithub","memo","countdown$","interval","pipe","startWith","scan","time","takeWhile","Wait","handleCallback","setTime","useEffect","sub","subscribe","next","complete","unsubscribe","id","IconMicrophone","size","svg","viewBox","width","height","path","d","fill","p-id","Rejected","IconRejected","useToggle","listen","toggleListen","IconFileImport","stroke","Routes","Route","index","element","AI"],"sourceRoot":""}