{"version":3,"file":"js/MV-All.js?version=8dabdeae","mappings":"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","sources":["webpack://wyy/./src/features/MV-All/MV-All.tsx","webpack://wyy/./src/features/MV-All/Router.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState, memo } from \"react\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport classNames from \"classnames\";\nimport GridVideo from \"@/components/GridVideo\";\nimport useInfinite from \"@/hooks/useInfinite\";\nimport { apiMVAll } from \"@/api\";\n\nconst filters = [\n  [\"area\", \"地区\", [\"全部\", \"内地\", \"港台\", \"欧美\", \"韩国\", \"日本\"]],\n  [\"type\", \"类型\", [\"全部\", \"官方版\", \"原声\", \"现场版\", \"网易出品\"]],\n  [\"order\", \"排序\", [\"上升最快\", \"最热\", \"最新\"]],\n];\n\nconst defaultSearch: { [key: string]: string } = {\n  area: \"全部\",\n  type: \"全部\",\n  order: \"上升最快\",\n};\n\nexport default memo(function MVAll() {\n  const { search } = useLocation();\n\n  const limit = 30;\n  const offset = useRef(0);\n\n  const queryString = new URLSearchParams(search);\n  const domScroll = useRef(null);\n  const domObserver = useRef(null);\n  for (const [k, v] of queryString) {\n    defaultSearch[k] = v;\n  }\n\n  const [data, setData] = useState([]);\n\n  const handleInit = async () => {\n    try {\n      const { data } = await apiMVAll({\n        ...defaultSearch,\n        limit,\n        offset: offset.current,\n      });\n      offset.current += limit;\n      setData((prev) => [\n        ...prev,\n        ...data.map(({ id, name, cover, playCount, duration, artists }) => ({\n          id,\n          cover,\n          duration,\n          playCount,\n          title: name,\n          creator: artists.map(({ id: userId, name: userName }) => ({\n            userId,\n            userName,\n          })),\n        })),\n      ]);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  useInfinite(handleInit, domScroll, domObserver, [search]);\n\n  // useEffect(() => {\n  //   // handleInit();\n  //   handleIo();\n  //   return () => {\n  //     handleUnIo();\n  //   };\n  // }, [search]);\n\n  useEffect(() => {\n    setData([]);\n    offset.current = 0;\n    // handleInit();\n  }, [search]);\n\n  return (\n    <div className=\"domAllMV overflow-auto h-full\" ref={domScroll}>\n      <div className=\"domAllMV_header ui_header\">\n        <Link to=\"./\" className=\"h1 title\">\n          全部MV\n        </Link>\n      </div>\n      <div className=\"domAllMV_main px-8 flex-auto\">\n        <div className=\"ui_filter\">\n          {filters.map((filter) => (\n            <div className=\"row flex my-2.5\" key={filter[1]}>\n              <div className=\"name flex-none\">{filter[1]}:</div>\n              <div className=\"list divide-x\">\n                {filter[2].map((item) => (\n                  <div className=\"item flex-center\" key={item}>\n                    <Link\n                      to={`/mv-all?${new URLSearchParams({\n                        ...defaultSearch,\n                        ...{ [filter[0]]: item },\n                      })}`}\n                      className={classNames(\n                        \"btn rounded-full leading-5 px-3 whitespace-nowrap\",\n                        item === defaultSearch[filter[0]]\n                          ? \"bg-red-50 text-red-500\"\n                          : \"ui_text_gray_hover\"\n                      )}\n                    >\n                      {item}\n                    </Link>\n                  </div>\n                ))}\n              </div>\n            </div>\n          ))}\n        </div>\n        <div className=\"py-1\">\n          <GridVideo list={data} />\n        </div>\n        <div ref={domObserver} />\n      </div>\n    </div>\n  );\n});\n","import React from \"react\";\nimport { Routes, Route } from \"react-router-dom\";\nimport MVAll from \"./MV-All\";\nconst Router = () => {\n  return (\n    <Routes>\n      <Route index element={<MVAll />} />\n    </Routes>\n  );\n};\n\nexport default Router;\n"],"names":["filters","defaultSearch","area","type","order","memo","search","useLocation","offset","useRef","queryString","URLSearchParams","domScroll","domObserver","k","v","useState","data","setData","handleInit","apiMVAll","limit","current","prev","map","id","name","cover","playCount","duration","title","creator","artists","userId","userName","console","log","useInfinite","useEffect","div","className","ref","Link","to","filter","key","item","classNames","GridVideo","list","Routes","Route","index","element","MVAll"],"sourceRoot":""}