"use strict";(this.webpackChunkwyy=this.webpackChunkwyy||[]).push([[238],{7067:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ce});var r=n(7363),a=n.n(r),l=n(6711),c=n(5666),o=n.n(c),i=n(9266),s=n(5583),u=n(4184),m=n.n(u),f=n(4719),d=n(1485),p=n(8360),v=n(6719),y=n(7484),b=n.n(y),h=function(e){var t=e.tags,n=void 0===t?[]:t;return 0===n.length?null:a().createElement("div",{className:"tags"},a().createElement("span",null,"标签："),n.map((function(e,t){return a().createElement("span",{key:e},t>0&&" / ",a().createElement(l.Link,{to:"/home/playlist/".concat(e),className:"tag ui_link"},e))})))};const E=(0,r.memo)(h);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t=e.description,n=void 0===t?"":t;if(!n)return null;var l,c,o=(l=(0,r.useState)(!1),c=2,function(e){if(Array.isArray(e))return e}(l)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],c=!0,o=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);c=!0);}catch(e){o=!0,a=e}finally{try{c||null==n.return||n.return()}finally{if(o)throw a}}return l}}(l,c)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(l,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],s=o[1],u=n.match(/^.*$/gm);return a().createElement("div",{className:"relative pr-5"},a().createElement("div",{className:"whitespace-pre-line leading-6"},"简介：",a().createElement("span",{className:m()("text-gray-500 select-text",!i&&"truncate inline-block max-w-xs align-bottom")},i?n:null==u?void 0:u[0]),a().createElement("button",{type:"button",onClick:function(){return s(!i)},className:"absolute top-0 right-0 text-gray-500"},i?a().createElement(v.IconCaretUp,{size:16,className:"fill-current"}):a().createElement(v.IconCaretDown,{size:16,className:"fill-current"}))))};const w=(0,r.memo)(x);var N=function(e){var t,n,r,c,o=e.data,i=void 0===o?{}:o,s=e.handleSub,u=e.songs;return a().createElement("div",{className:"p-8 flex items-start"},a().createElement("div",{className:"border rounded overflow-hidden flex-none w-92 h-92"},a().createElement("img",{loading:"lazy",className:"w-full h-full",src:"".concat(i.playlist.coverImgUrl,"?param=200y200"),alt:""})),a().createElement("div",{className:"info flex-auto w-0 ml-5"},a().createElement("div",{className:"name leading-tight"},a().createElement("span",{className:"whitespace-nowrap text-red-500 border border-current p-0.5 rounded mr-2 align-bottom inline-block"},"歌单"),a().createElement("span",{className:"h1 select-text"},i.playlist.name||"我喜欢的音乐")),a().createElement("div",{className:"creator flex items-center mt-2"},a().createElement(l.Link,{to:"/user/".concat(null===(t=i.playlist.creator)||void 0===t?void 0:t.userId),className:"w-6 h-6 rounded-full overflow-hidden mr-2"},a().createElement("img",{className:"",src:"".concat(null===(n=i.playlist.creator)||void 0===n?void 0:n.avatarUrl,"?param=50y50"),alt:""})),a().createElement(l.Link,{to:"/user/".concat(null===(r=i.playlist.creator)||void 0===r?void 0:r.userId),className:"nickname ui_link mr-2"},null===(c=i.playlist.creator)||void 0===c?void 0:c.nickname),a().createElement("span",{className:"text-gray-500"},b()(i.playlist.createTime||Date.now()).format("YYYY-MM-DD"),"创建")),a().createElement("div",{className:"actions flex space-x-2 mt-2"},a().createElement(d.Z,{playlist:u}),a().createElement("button",{onClick:function(){return s(i.playlist.subscribed)},type:"button",className:"ui_btn inline-flex items-center justify-center border px-3 h-8 rounded-full btn"},i.playlist.subscribed?a().createElement(v.IconCheckbox,{size:20,stroke:1}):a().createElement(v.IconFolderPlus,{size:20,stroke:1})," ",i.playlist.subscribed?"已收藏":"收藏","(".concat((0,p.Qb)(i.playlist.subscribedCount),")")),a().createElement("button",{type:"button",className:"ui_btn inline-flex items-center justify-center border px-3 h-8 rounded-full btn"},a().createElement(v.IconScreenShare,{size:20,stroke:1}),"  分享","(".concat((0,p.Qb)(i.playlist.shareCount),")")),a().createElement("button",{type:"button",className:"ui_btn inline-flex items-center justify-center border px-3 h-8 rounded-full btn"},a().createElement(v.IconCloudDownload,{size:20,stroke:1}),"  下载全部")),a().createElement("div",{className:"space-y-1 mt-2"},a().createElement(E,{tags:i.playlist.tags}),a().createElement("div",null,a().createElement("span",{className:"mr-3"},"歌曲：",a().createElement("span",{className:"text-gray-500"},i.playlist.trackCount)),a().createElement("span",null,"播放：",a().createElement("span",{className:"text-gray-500"},(0,p.LU)(i.playlist.playCount)))),a().createElement(w,{description:i.playlist.description}))))};const k=(0,r.memo)(N);var S=n(7264),A=n(2837),I=n(6129),C=n(2e3),j=n(5854),P=n(9929),O=n(5101),Z=function(e){var t=e.songs,n=void 0===t?[]:t;return n.length?a().createElement("div",{style:{"--ui_grid_template":"36px / 30px 30px 30px 36% 4fr 6fr 2fr"},className:"mt-4"},a().createElement("div",{className:"grid ui_grid_template pl-8"},a().createElement("div",null),a().createElement("div",null),a().createElement("div",null),a().createElement("div",{className:"px-1 flex items-center hover:bg-gray-200 text-gray-500"},"音乐标题"),a().createElement("div",{className:"px-1 flex items-center hover:bg-gray-200 text-gray-500"},"歌手"),a().createElement("div",{className:"px-1 flex items-center hover:bg-gray-200 text-gray-500"},"专辑"),a().createElement("div",{className:"px-1 flex items-center hover:bg-gray-200 text-gray-500"},"时长")),n.map((function(e,t){return a().createElement(S.Z,{schema:[["评论","播放","下一首播放"],["收藏到歌单","分享","复制链接","不感兴趣","下载"]],type:"song",item:e,key:e.id},a().createElement("div",{tabIndex:2,className:m()("grid items-center focus:outline-none focus:bg-gray-200 hover:bg-gray-100 ui_grid_template pl-8",t%2==0&&"bg-gray-50")},a().createElement("div",{className:"px-1"},a().createElement(A.Z,{index:t,id:e.id})),a().createElement("div",{className:"px-1"},a().createElement(I.Z,{id:e.id})),a().createElement("div",{className:"px-1"},a().createElement(C.Z,null)),a().createElement(j.Z,{className:"px-1",item:e}),a().createElement(P.Z,{className:"px-1",artists:e.ar}),a().createElement(O.Z,{className:"px-1",name:e.al.name,id:e.al.id}),a().createElement("div",{className:"text-gray-500 px-1"},b()(e.dt).format("mm:ss"))))}))):a().createElement("div",{className:"pt-16 text-center text-sm text-gray-400"},"暂无音乐")};const _=(0,r.memo)(Z);var T=n(5986),U=n(5170);function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t,n,r,a,l,c){try{var o=e[l](c),i=o.value}catch(e){return void n(e)}o.done?t(i):Promise.resolve(i).then(r,a)}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],c=!0,o=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);c=!0);}catch(e){o=!0,a=e}finally{try{c||null==n.return||n.return()}finally{if(o)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const L=(0,r.memo)((function(){var e=(0,l.useParams)().id;if(!e)return null;var t,n,c=M((0,r.useState)(!0),2),s=c[0],u=c[1],m=M((0,r.useState)([]),2),d=m[0],p=m[1],v=(t=o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,i.wL)({id:e});case 2:n=t.sent,p(n),u(!1);case 5:case"end":return t.stop()}}),t)})),n=function(){var e=this,n=arguments;return new Promise((function(r,a){var l=t.apply(e,n);function c(e){z(l,r,a,c,o,"next",e)}function o(e){z(l,r,a,c,o,"throw",e)}c(void 0)}))},function(){return n.apply(this,arguments)}),y=(0,r.useCallback)((function(){}),[]);return(0,r.useEffect)((function(){v()}),[]),a().createElement("div",{className:"px-8"},a().createElement("div",{className:"pt-10 pb-10"},a().createElement(U.Z,{max:140,placeholder:"",onChange:y})),s?a().createElement(f.Z,null):a().createElement(T.Z,{comments:d,type:0,more:e}))}));var $=n(2429),Y=n(3912);function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Q(e,t,n,r,a,l,c){try{var o=e[l](c),i=o.value}catch(e){return void n(e)}o.done?t(i):Promise.resolve(i).then(r,a)}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],c=!0,o=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);c=!0);}catch(e){o=!0,a=e}finally{try{c||null==n.return||n.return()}finally{if(o)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const V=(0,r.memo)((function(){var e,t,n=(0,l.useParams)().id,c=F((0,r.useState)(1),2),s=c[0],u=c[1],m=F((0,r.useState)({}),2),d=m[0],p=m[1],v=F((0,r.useState)(!0),2),y=v[0],b=v[1],h=(e=o().mark((function e(){var t,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.UL)({id:n,limit:60,offset:60*(s-1)});case 2:t=e.sent,r=t.subscribers,a=t.total,p({subscribers:r,total:a}),b(!1);case 7:case"end":return e.stop()}}),e)})),t=function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function c(e){Q(l,r,a,c,o,"next",e)}function o(e){Q(l,r,a,c,o,"throw",e)}c(void 0)}))},function(){return t.apply(this,arguments)});return(0,r.useEffect)((function(){h()}),[]),y?a().createElement("div",{className:"flex-center pt-32"},a().createElement(f.Z,null)):a().createElement("div",{className:"px-8"},a().createElement("div",{className:"domPlaylistDetail_subscribers flex justify-between flex-wrap"},null==d?void 0:d.subscribers.map((function(e){return a().createElement("div",{key:e.userId,className:"item flex mt-6 w-80 "},a().createElement(l.Link,{to:"/user/".concat(e.userId),className:"avatar w-24 h-24 border rounded-full overflow-hidden"},a().createElement("img",{loading:"lazy",src:"".concat(e.avatarUrl,"?param=100y100"),alt:""})),a().createElement("div",{className:"ml-2 flex-auto w-0 flex flex-col justify-center"},a().createElement("div",{className:"text-sm flex items-center"},a().createElement(l.Link,{to:"/user/".concat(e.userId)},e.nickname)," ",a().createElement($.ZP,{gender:e.gender,size:16})),a().createElement("div",{className:"mt-2 truncate"},e.signature)))}))),a().createElement(Y.Z,{total:Math.ceil((null==d?void 0:d.total)/60),page:s,func:u}))}));var W=n(4837),q=n(57);function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function G(e,t,n,r,a,l,c){try{var o=e[l](c),i=o.value}catch(e){return void n(e)}o.done?t(i):Promise.resolve(i).then(r,a)}function H(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function c(e){G(l,r,a,c,o,"next",e)}function o(e){G(l,r,a,c,o,"throw",e)}c(void 0)}))}}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],c=!0,o=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);c=!0);}catch(e){o=!0,a=e}finally{try{c||null==n.return||n.return()}finally{if(o)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var K=[["歌曲列表","Playlist"],["评论","Comments"],["收藏者","Subscribers"]],X={Playlist:_,Comments:L,Subscribers:V};const ee=(0,r.memo)((function(){var e,t=(0,l.useParams)().id,n=(0,W.T)(),c=J((0,r.useState)(!0),2),u=c[0],d=c[1],p=J((0,r.useState)([]),2),v=p[0],y=p[1],b=J((0,q.x)({}),2),h=b[0],E=b[1],g=J((0,r.useState)(K[0][1]),2),x=g[0],w=g[1],N=(e=H(o().mark((function e(){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,i.MY)({id:t});case 3:if(n=e.sent,E(n),!(n.playlist.trackCount>0)){e.next=10;break}return e.next=8,(0,i.VO)({ids:n.playlist.trackIds.map((function(e){return e.id})).join(",")});case 8:r=e.sent.songs,y(r);case 10:d(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])}))),function(){return e.apply(this,arguments)}),S=(0,r.useCallback)(function(){var e=H(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,i.so)({t:r?2:1,id:t});case 3:200===e.sent.code&&(n((0,s.setToast)(r?"取消收藏成功！":"收藏成功！")),E((function(e){e.playlist.subscribed=!r}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),[t]);return(0,r.useEffect)((function(){N()}),[t]),u?a().createElement("div",{className:"w-full h-full flex-center"},a().createElement(f.Z,null)):a().createElement("div",{className:"overflow-auto h-full"},a().createElement(k,{data:h,handleSub:S,songs:v}),a().createElement("div",{className:"mt-4"},a().createElement("div",{className:"space-x-4 flex items-baseline px-8"},K.map((function(e){var t=J(e,2),n=t[0],r=t[1];return a().createElement("button",{type:"button",className:m()("text-sm",x===r&&"font-bold ui_underline"),key:n,onClick:function(){return w(r)}},n,"评论"===n&&"(".concat(h.playlist.commentCount,")"))}))),a().createElement("div",null,(0,r.createElement)(X[x],{songs:v}))))}));function te(e,t,n,r,a,l,c){try{var o=e[l](c),i=o.value}catch(e){return void n(e)}o.done?t(i):Promise.resolve(i).then(r,a)}function ne(e){throw e}const re=(0,r.memo)((function(e){var t,n,l=e.id,c=(t=o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,i.NW)({rid:l});case 3:t=null!==(t=e.sent)?t:ne(new TypeError("Cannot destructure undefined")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})),n=function(){var e=this,n=arguments;return new Promise((function(r,a){var l=t.apply(e,n);function c(e){te(l,r,a,c,o,"next",e)}function o(e){te(l,r,a,c,o,"throw",e)}c(void 0)}))},function(){return n.apply(this,arguments)});return(0,r.useEffect)((function(){c()}),[]),a().createElement("div",{className:"domPlaylistDetail"},a().createElement("div",{className:"domPlaylistDetail_header"}),a().createElement("div",{className:"domPlaylistDetail_main"},"TODO"))}));function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function le(){var e,t;return(e=(0,r.useState)(0),t=1,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],c=!0,o=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);c=!0);}catch(e){o=!0,a=e}finally{try{c||null==n.return||n.return()}finally{if(o)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ae(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],a().createElement("div",null,"TOTO")}const ce=function(){return a().createElement(l.Routes,null,a().createElement(l.Route,{path:"music/:id",element:a().createElement(ee,null)}),a().createElement(l.Route,{path:"dj/:id",element:a().createElement(re,null)}),a().createElement(l.Route,{path:"album/:id",element:a().createElement(le,null)}))}}}]);
//# sourceMappingURL=Playlist.js.map?version=80007d19