{"version":3,"file":"Home_Artist.664c5659.js","mappings":"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","sources":["webpack://wyy/./src/pages/Home/Artist/index.tsx"],"sourcesContent":["import React, {\n  useState,\n  useEffect,\n  useRef,\n  memo,\n} from 'react';\nimport { Link } from 'react-router-dom';\nimport './style.scss';\nimport classNames from 'classnames';\nimport { IconUser } from '@tabler/icons';\nimport { apiArtistList } from '@/api';\nimport { addHomeTopArtists, initHomeTopArtists } from '@/reducers/home/slice';\nimport useInfinite from '@/hooks/useInfinite';\nimport DomResize from '@/components/ResizeObserver';\nimport DomLoading from '@/components/Loading';\n\nconst Domitem = memo(({ item = {} }) => (\n  <div className=\"item\">\n    <div className=\"cover boarder relative rounded overflow-hidden border\">\n      <Link to={`/artist/${item.id}`} className=\"\">\n        <img\n          loading={'lazy'}\n          className=\"ui_aspect-ratio-1/1\"\n          src={`${item.img1v1Url}?param=200y200`}\n          alt={item.name}\n        />\n      </Link>\n    </div>\n    <div className=\"info flex items-center justify-between mt-2 text-sm text-gray-600 hover:text-black\">\n      <Link to={`/artist/${item.id}`}>\n        {item.name}\n      </Link>\n      {\n        item.accountId\n        && (\n          <Link\n            to={`/user/${item.accountId}`}\n            className=\"bg-red-500 hover:bg-red-600 text-white rounded-full p-0.5\"\n          >\n            <IconUser size={12} />\n          </Link>\n        )\n      }\n    </div>\n  </div>\n));\n\nconst navs = [\n  {\n    type: '语种',\n    code: 'area',\n    sub: [\n      [-1, '全部', 1],\n      [7, '华语', 1],\n      [96, '欧美', 2],\n      [8, '日本', 4],\n      [16, '韩国', 3],\n      [0, '其他', 1],\n    ],\n  }, {\n    type: '分类',\n    code: 'type',\n    sub: [\n      [-1, '全部'],\n      [1, '男歌手'],\n      [2, '女歌手'],\n      [3, '乐队'],\n    ],\n  }, {\n    type: '筛选',\n    code: 'initial',\n    sub: [\n      [-1, '热门'],\n      ['A', 'A'],\n      ['B', 'B'], ['C', 'C'], ['D', 'D'], ['E', 'E'], ['F', 'F'], ['G', 'G'], ['H', 'H'], ['I', 'I'], ['J', 'J'], ['K', 'K'], ['L', 'L'], ['M', 'M'], ['N', 'N'], ['O', 'O'], ['P', 'P'], ['Q', 'Q'], ['R', 'R'], ['S', 'S'], ['T', 'T'], ['U', 'U'], ['V', 'V'], ['W', 'W'], ['X', 'X'], ['Y', 'Y'], ['Z', 'Z'], ['#', '#']],\n  },\n];\n\nconst initialOptions = {\n  type: -1,\n  area: -1,\n  initial: -1,\n};\n\nexport default memo(() => {\n  const [option, setOption] = useState(() => initialOptions);\n  const RefOption = useRef(option);\n  const limit = 30;\n  const offset = useRef(0);\n  const DomScroll = useRef();\n  const DomObserver = useRef();\n  const [artists, setArtists] = useState([]);\n  const handleChangeOption = (newoption) => {\n    setOption((prev) => ({\n      ...prev,\n      ...newoption,\n    }));\n    offset.current = 0;\n    setArtists([]);\n  };\n\n  const handleInit = async () => {\n    try {\n      const { type, area, initial } = RefOption.current;\n      const { artists } = await apiArtistList({\n        type,\n        area,\n        initial,\n        limit,\n        offset: offset.current,\n      });\n      offset.current += limit;\n      setArtists((prev) => [...prev, ...artists]);\n      // dispatch(addHomeTopArtists(artists));\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  useEffect(() => {\n    RefOption.current = option;\n  }, [option]);\n\n  useInfinite(handleInit, DomScroll, DomObserver);\n\n  return (\n    <div\n      className=\"domHome_content px-8 pb-8 overflow-auto h-full flex-auto\"\n      ref={DomScroll}\n    >\n      <div className=\"domHome_artist ui_w1100\">\n        <div className=\"domHome_artist_control\">\n          {navs.map(({ type, code, sub }) => (\n            <div className=\"domHome_artist_filter\" key={type}>\n              <div className=\"title\">{type}</div>\n              <div className=\"list\">\n                {sub.map(([key, value]) => (\n                  <div className=\"item flex-center\" key={key}>\n                    <button\n                      type=\"button\"\n                      onClick={() => handleChangeOption({ [code]: key })}\n                      className={classNames('btn rounded-full focus:outline-none', key === option[code] && ['ui_themeColor', 'ui_bg_opacity'])}\n                    >\n                      {value}\n                    </button>\n                  </div>\n                ))}\n              </div>\n            </div>\n          ))}\n        </div>\n        <DomResize className=\"domHome_artist_list mt-2.5 grid gap-4\" small=\"grid-cols-5\" big=\"grid-cols-6\">\n          {option.type === -1 && option.initial === -1 && artists.length > 0 && (\n            <div className=\"item\">\n              <div className=\"cover boarder relative rounded overflow-hidden border\">\n                <Link to={`/toplist-artist/${navs[0].sub.find((item) => item[0] === option.area)[2]}`}>\n                  <img\n                    className=\"ui_containimg\"\n                    src=\"http://p3.music.126.net/1tSJODTpcbZvNTCdsn4RYA==/109951165034950656.jpg?param=200y200\"\n                    alt=\"\"\n                    style={{ filter: 'blur(2px)' }}\n                  />\n                  <div\n                    className=\"rankmask absolute inset-0 flex-center text-white text-3xl bg-purple-500 bg-opacity-90\"\n                  >\n                    歌手榜\n                  </div>\n                </Link>\n              </div>\n              <div className=\"info mt-2 text-sm text-gray-600 hover:text-black\">\n                <Link to={`/toplist-artist/${navs[0].sub.find((item) => item[0] === option.area)[2]}`}>\n                  歌手排行榜 &gt;\n                </Link>\n              </div>\n            </div>\n          )}\n          {artists.map((item) => <Domitem item={item} key={item.id} />)}\n        </DomResize>\n      </div>\n      <div className=\"flex-center\" ref={DomObserver}>\n        <DomLoading />\n      </div>\n    </div>\n  );\n});\n"],"names":["Domitem","memo","item","className","Link","to","id","loading","src","img1v1Url","alt","name","accountId","IconUser","size","navs","type","code","sub","initialOptions","area","initial","useState","option","setOption","RefOption","useRef","offset","DomScroll","DomObserver","artists","setArtists","handleInit","current","apiArtistList","limit","prev","console","log","useEffect","useInfinite","ref","map","key","value","onClick","newoption","classNames","small","big","length","find","style","filter"],"sourceRoot":""}