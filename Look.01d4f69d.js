"use strict";(this.webpackChunkwyy=this.webpackChunkwyy||[]).push([[8113],{9131:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var c=n(7363),a=n.n(c),r=n(6711),o=n(5861),l=n(885),s=n(7757),u=n.n(s),i=n(7467),m=n.n(i),f=n(8767),d=n(4849),p=(n(2222),n(1249),n(1343)),h=n(6813),v=(0,n(8594).ZP)("http://localhost:3333",{autoConnect:!1});v.on("create-success",(function(e){console.log(e)})),v.on("join-success",(function(e){console.log(e)})),v.on("disconnect-success",(function(e){console.log(e)}));var E=function(){(0,p.T)()((0,h.createLiveSocket)({socket:v})),v.connect()};const k=v,g=(0,c.memo)((function(e){var t=e.list,n=(0,p.C)(h.liveSelector).socket,o=(0,r.useHistory)().push,s=(0,r.useLocation)().pathname,u=(0,c.useCallback)((function(e,t){e.preventDefault(),n||E(),prompt(),n.emit("join",{}),o("".concat(s,"/").concat(t))}),[s]);return a().createElement("div",{className:"grid grid-cols-3 gap-5"},t.map((function(e){var t=(0,l.Z)(e,2),n=t[0],c=t[1];return a().createElement("div",{key:n},a().createElement("a",{href:"".concat(s,"/").concat(n),onClick:function(e){return u(e,n)}},a().createElement("img",{className:"ui_aspect-ratio-16/9 cursor-pointer",loading:"lazy",src:c.banner,alt:""})),a().createElement("a",{href:"".concat(s,"/").concat(n),onClick:function(e){return u(e,n)},className:"cursor-pointer"},c.title),a().createElement("div",null,a().createElement(r.Link,{to:"/"},c.user)))})))})),N=(0,c.memo)((function(){var e=(0,c.useState)(20),t=(0,l.Z)(e,2),n=(t[0],t[1],(0,c.useRef)(null)),s=(0,c.useRef)(null),i=(0,c.useState)([]),p=(0,l.Z)(i,2),h=(p[0],p[1],(0,f.useQuery)("look",(0,o.Z)(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m().get("http://localhost:3333/list").then((function(e){return e.data}));case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))))),v=h.data,E=(h.error,h.isLoading),k=h.isSuccess;return h.status,a().createElement("div",{className:"domLook overflow-auto max-h-full flex-auto",ref:n},a().createElement("div",{className:"domLook_header ui_header"},a().createElement("span",{className:"title h1"},"LOOK直播"),a().createElement("span",{className:"text-gray-400 slogan ml-2"},"在这里，看见音乐"),a().createElement(r.Link,{to:function(e){var t=e.pathname;return"".concat(t,"/my")},className:"ml-2 py-1 px-2 rounded bg-red-500 text-white"},"我的直播"),a().createElement("a",{href:"https://look.163.com/hot",className:"text-gray-400 ml-auto"},"更多 >")),a().createElement("div",{className:"px-8"},E&&a().createElement("div",{className:"pt-48 flex-center"},a().createElement(d.Z,null)),k&&a().createElement(g,{list:v}),a().createElement("div",{ref:s})))}));n(4747);var y=n(4184),w=n.n(y),x=(0,c.memo)((function(e){var t=e.onClick,n=e.status,c=e.children;return a().createElement("button",{type:"button",className:w()("text-white rounded p-2",n?"bg-red-500":"bg-blue-500"),onClick:t},c)}));const C=(0,c.memo)((function(){var e=(0,p.T)(),t=(0,p.C)(h.liveSelector).status,n=(0,c.useRef)(null),r=(0,c.useRef)(null),l=(0,c.useRef)(null),s=function(){var t=(0,o.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e((0,h.pushOpen)()),k.connect(),k.emit("create",{uid:110});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return a().createElement("div",{className:"w-full h-full p-8 overflow-auto"},a().createElement("div",{className:"flex"},a().createElement(x,{onClick:function(){t.deskTop?n.current&&(n.current.srcObject.getTracks().forEach((function(e){return e.stop()})),n.current.srcObject=null,e((0,h.deskTopClose)())):r.current=navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then((function(t){n.current.srcObject=t,e((0,h.deskTopOpen)())})).catch((function(e){return console.log(e)}))},status:t.deskTop},"桌面共享开关"),a().createElement(x,{onClick:function(){t.user?e((0,h.userClose)()):(e((0,h.userOpen)()),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){l.current&&(l.current.srcObject=e)})).catch((function(e){return console.log(e)})))},status:t.user},"摄像头开关"),a().createElement(x,{onClick:function(){t.push?(e((0,h.pushClose)()),k.disconnect()):s()},status:t.push},"推送开关")),a().createElement("div",{className:"flex flex-col"},a().createElement("div",{className:""},a().createElement("video",{className:"w-full",ref:n,autoPlay:!0,playsInline:!0})),a().createElement("div",{className:""},a().createElement("video",{className:"w-full",ref:l,autoPlay:!0,playsInline:!0}))))})),b=(0,c.memo)((function(){return a().createElement("div",{className:"p-8"},"return ",a().createElement("button",{onClick:methodDoesNotExist},"Break the world"),";")})),O=(0,c.memo)((function(){return a().createElement(r.Switch,null,a().createElement(r.Route,{path:"/look",exact:!0,component:N}),a().createElement(r.Route,{path:"/look/my",component:C}),a().createElement(r.Route,{path:"/look/:id(\\d*)",component:b}))}))}}]);