{"version":3,"file":"User_Dynamic.6850487d.js","mappings":"iRAAA,W,aAGA,WACA,S,aACA,W,aACA,W,8BAEe,IAAAA,OAAK,YAAa,IAAVC,EAAU,EAAVA,IACrB,GAAwB,IAAAC,UAAS,IAAjC,qBAAOC,EAAP,KAAaC,EAAb,KACMC,GAAS,IAAAC,SAAQ,GACvB,GAA8B,IAAAJ,UAAS,IAAvC,qBAAOK,EAAP,KAAgBC,EAAhB,KACMC,GAAU,IAAAH,SAAO,GACjBI,GAAY,IAAAJ,UACZK,GAAc,IAAAL,UAEdM,EAAc,+CAAG,sHAEO,IAAAC,eAAc,CACtCZ,IAAAA,IAHiB,gBAEXM,EAFW,EAEXA,QAGRC,EAAWD,GALQ,gDAOnBO,QAAQC,IAAR,MAPmB,yDAAH,qDAWdC,EAAU,+CAAG,mGACZP,EAAQQ,QADI,yCACY,MADZ,iCAG0B,IAAAC,cAAa,CACpDjB,IAAAA,EACAkB,SAAUd,EAAOY,UALJ,gBAGPG,EAHO,EAGPA,OAAQC,EAHD,EAGCA,KAAMF,EAHP,EAGOA,SAItBV,EAAQQ,QAAUI,EAClBhB,EAAOY,QAAUE,EACjBf,GAAQ,SAACkB,GAAD,8BAAcA,IAAd,aAAuBF,OAThB,kDAWfN,QAAQC,IAAR,MAXe,0DAAH,qDAqBhB,OAPA,aAAYC,EAAYN,EAAWC,IACnC,IAAAY,YAAU,WACJpB,EAAKqB,OAAS,GAChBpB,EAAQ,IAEVQ,MACC,CAACX,IAEF,+BAAKwB,UAAU,uBAAuBC,IAAKhB,GACzC,+BAAKe,UAAU,uCAAf,UACMlB,EAAQoB,SADd,QAGA,+BAAKF,UAAU,wBACb,+BAAKA,UAAU,aACZtB,EAAKqB,OAAS,EAAI,wBAAC,UAAD,CAAYI,KAAMzB,IACjC,+BAAKsB,UAAU,SAAf,SAEN,+BAAKC,IAAKf,IAERF,EAAQQ,SACN,+BAAKQ,UAAU,eACb,wBAAC,UAAD","sources":["webpack://wyy/./src/pages/User/Dynamic/index.tsx"],"sourcesContent":["import React, {\n  useEffect, useState, memo, useRef,\n} from 'react';\nimport { apiUserEvent, apiUserDetail } from '@/api';\nimport DomDynamic from '@/components/Dynamic';\nimport useInfinite from '@/hooks/useInfinite';\nimport DomLoading from '@/components/Loading';\n\nexport default memo(({ uid }) => {\n  const [data, setData] = useState([]);\n  const timing = useRef(-1);\n  const [profile, setProfile] = useState({});\n  const hasmore = useRef(true);\n  const DomScroll = useRef();\n  const DomObserver = useRef();\n\n  const handlePrevInit = async () => {\n    try {\n      const { profile } = await apiUserDetail({\n        uid,\n      });\n      setProfile(profile);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const handleInit = async () => {\n    if (!hasmore.current) return null;\n    try {\n      const { events, more, lasttime } = await apiUserEvent({\n        uid,\n        lasttime: timing.current,\n      });\n      hasmore.current = more;\n      timing.current = lasttime;\n      setData((prev) => [...prev, ...events]);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  useInfinite(handleInit, DomScroll, DomObserver);\n  useEffect(() => {\n    if (data.length > 0) {\n      setData([]);\n    }\n    handlePrevInit();\n  }, [uid]);\n  return (\n    <div className=\"h-full overflow-auto\" ref={DomScroll}>\n      <div className=\"h1 domUser_subpage_header ui_header\">\n        {`${profile.nickname}的动态`}\n      </div>\n      <div className=\"domUser_dynamic_main\">\n        <div className=\"list px-8\">\n          {data.length > 0 ? <DomDynamic list={data} />\n            : <div className=\"empty\">暂无动态</div>}\n        </div>\n        <div ref={DomObserver} />\n        {\n          hasmore.current && (\n            <div className=\"flex-center\">\n              <DomLoading />\n            </div>\n          )\n        }\n      </div>\n    </div>\n  );\n});\n"],"names":["memo","uid","useState","data","setData","timing","useRef","profile","setProfile","hasmore","DomScroll","DomObserver","handlePrevInit","apiUserDetail","console","log","handleInit","current","apiUserEvent","lasttime","events","more","prev","useEffect","length","className","ref","nickname","list"],"sourceRoot":""}