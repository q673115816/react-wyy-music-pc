{"version":3,"file":"Components_HeaderSearch.1122f392.js","mappings":"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","sources":["webpack://wyy/./src/components/Search/History.tsx","webpack://wyy/./src/components/Search/HotList.tsx","webpack://wyy/./src/components/Search/Search.tsx"],"sourcesContent":["import React, {\n  memo,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { IconTrash, IconX } from \"@tabler/icons\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useAppDispatch, useAppSelector } from \"@/reducers/hooks\";\nimport { setSearchHistory } from \"@/reducers/search/slice\";\n\nexport default memo(({ handleSearch }) => {\n  const dispatch = useAppDispatch();\n  const [isHidden, setIsHidden] = useState(false);\n  const refHistory = useRef<HTMLDivElement>(null);\n  const { searchHistory } = useAppSelector(({ search }) => search);\n  const handleDeleteSearchHistory = (keywords) => {\n    dispatch(\n      setSearchHistory(searchHistory.filter((search) => search !== keywords))\n    );\n  };\n\n  const handleDeleteAllSearchHistory = () => {\n    dispatch(setSearchHistory([]));\n  };\n\n  useEffect(() => {\n    if (refHistory.current && refHistory.current.clientHeight > 66) {\n      setIsHidden(true);\n    }\n  }, []);\n\n  return (\n    <>\n      <div className=\"subtitle flex items-center px-5 py-2 text-gray-500\">\n        <span className=\"text-sm\">搜索历史</span>\n        &nbsp;\n        <button type=\"button\" onClick={handleDeleteAllSearchHistory}>\n          <IconTrash size={16} />\n        </button>\n        {isHidden && (\n          <button\n            type=\"button\"\n            onClick={() => setIsHidden(false)}\n            className=\"ml-auto ui_text_black_hover\"\n          >\n            查看全部\n          </button>\n        )}\n      </div>\n      <div\n        className=\"px-5\"\n        style={isHidden ? { height: 66, overflow: \"hidden\" } : null}\n        ref={refHistory}\n      >\n        <div className=\"searchHistory flex flex-wrap -m-1\">\n          {searchHistory.map((item) => (\n            <Link\n              key={item}\n              to={`/search/${item}`}\n              onClick={() => handleSearch(item)}\n              className=\"item group hover:bg-gray-100 border rounded-full relative m-1 py-1 px-4\"\n            >\n              {item}\n              <button\n                type=\"button\"\n                className=\"ico absolute opacity-0 group-hover:opacity-100 inset-y-0 m-auto text-gray-400\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  handleDeleteSearchHistory(item);\n                }}\n              >\n                <IconX size={14} stroke={2} />\n              </button>\n            </Link>\n          ))}\n        </div>\n      </div>\n    </>\n  );\n});\n","import React, { memo } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport classNames from \"classnames\";\n\nexport default memo(({ list = [], handleSearch }) => {\n  return (\n    <div className=\"list\">\n      {list.map((item, index) => (\n        <Link\n          to={`/search/${item.searchWord}`}\n          onClick={() => handleSearch(item.searchWord)}\n          className=\"item flex items-center w-full hover:bg-gray-100\"\n          key={item.content}\n        >\n          <span\n            className={classNames(\n              \"index flex-center text-base flex-none\",\n              index < 3 ? \"text-red-500\" : \"text-gray-300\"\n            )}\n          >\n            {index + 1}\n          </span>\n          <div className=\"aside flex-auto w-0 px-1\">\n            <div className=\"name flex items-center gap-1\">\n              <span\n                className={classNames(\n                  \"searchWord\",\n                  index < 3 ? \"font-bold\" : \"\"\n                )}\n              >\n                {item.searchWord}\n              </span>\n              {item.iconUrl && (\n                <img className=\"h-2.5\" src={item.iconUrl} alt=\"hot\" />\n              )}\n              <span className=\"text-gray-400\">{item.score}</span>\n            </div>\n            <div className=\"content mt-2 text-gray-400 truncate\">\n              {item.content}\n            </div>\n          </div>\n        </Link>\n      ))}\n    </div>\n  );\n});\n","import React, { memo } from \"react\";\nimport { useAppSelector, useAppDispatch } from \"@/reducers/hooks\";\nimport { Link } from \"react-router-dom\";\nimport classNames from \"classnames\";\nimport {\n  setSearchValue,\n  setSearchHistory,\n  setSearchHot,\n  setSearchSuggest,\n} from \"@/reducers/search/slice\";\nimport { setDialogReset } from \"@/reducers/mask/slice\";\nimport Mask from \"../Mask\";\nimport History from \"./History\";\nimport HotList from \"./HotList\";\n\nexport default memo(() => {\n  const dispatch = useAppDispatch();\n  const { searchValue, searchHot, searchSuggest, searchHistory } =\n    useAppSelector(({ search }) => search);\n  const { searchVisibility } = useAppSelector(({ mask }) => mask);\n  const handleSearch = (keywords: string) => {\n    // setSearchVisibility(false);\n    dispatch(setDialogReset());\n    dispatch(setSearchValue({ searchValue: keywords }));\n    dispatch(\n      setSearchHistory([\n        keywords,\n        ...searchHistory.filter((search: string) => search !== keywords),\n      ])\n    );\n    // push(`/search?keywords=${keywords}`);\n  };\n  if (!searchVisibility) return null;\n\n  return (\n    <Mask>\n      <div className=\"absolute domHeader_search_box shadow rounded bg-white py-2 z-10\">\n        {searchValue ? (\n          <div className=\"domHeader_search_box_value overflow-auto h-full flex-auto\">\n            <Link\n              to={`/search/${searchValue}`}\n              onClick={() => handleSearch(searchValue)}\n            >\n              搜索&quot;\n              <span className=\"ui_link\">{searchValue}</span>\n              &quot;相关的结果&gt;\n            </Link>\n            {searchSuggest?.order?.map((order, index) => (\n              <div key={order}>\n                {searchSuggest[order].map((item) => (\n                  <div key={item.id}>{item.name}</div>\n                ))}\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"domHeader_search_box_noValue overflow-auto h-full flex-auto\">\n            {searchHistory.length > 0 && (\n              <History handleSearch={handleSearch} />\n            )}\n            <div className=\"subtitle px-5 py-3 text-sm text-gray-400\">\n              热搜榜\n            </div>\n            <HotList list={searchHot} handleSearch={handleSearch} />\n          </div>\n        )}\n      </div>\n    </Mask>\n  );\n});\n"],"names":["memo","handleSearch","dispatch","useAppDispatch","useState","isHidden","setIsHidden","refHistory","useRef","searchHistory","useAppSelector","search","useEffect","current","clientHeight","className","type","onClick","setSearchHistory","IconTrash","size","style","height","overflow","ref","map","item","Link","key","to","e","keywords","preventDefault","stopPropagation","filter","IconX","stroke","list","index","searchWord","content","classNames","iconUrl","src","alt","score","searchValue","searchHot","searchSuggest","searchVisibility","mask","setDialogReset","setSearchValue","Mask","order","id","name","length","History","HotList"],"sourceRoot":""}