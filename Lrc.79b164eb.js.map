{"version":3,"file":"Lrc.79b164eb.js","mappings":"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","sources":["webpack://wyy/./src/pages/Lrc/Lrc.tsx","webpack://wyy/./src/pages/Lrc/components/Center.tsx","webpack://wyy/./src/pages/Lrc/components/Left.tsx","webpack://wyy/./src/pages/Lrc/components/Right.tsx","webpack://wyy/./src/pages/Lrc/index.ts"],"sourcesContent":["import React, {\n  memo, useEffect, useState,\n} from 'react';\nimport { apiCommentMusic, apiSimiSong } from '@/api';\nimport DomLoading from '@/components/Loading';\nimport DomPage from '@/components/Page';\nimport { useHistory } from 'react-router-dom';\n\nimport DomCommentsList from '@/components/CommentsList';\nimport './style.scss';\nimport { setLyricHide } from '@/reducers/lrc/slice';\nimport { useAppDispatch, useAppSelector } from '@/reducers/hooks'\nimport Left from './components/Left';\nimport Center from './components/Center'\nimport Right from './components/Right';\n\nexport default memo(() => {\n  const dispatch = useAppDispatch();\n  const { listen } = useHistory();\n  const { currentSong } = useAppSelector(({ audio }) => audio);\n  const { lyricVisibility } = useAppSelector(({ lrc }) => lrc);\n  const [loading, setLoading] = useState(true);\n  const [simiSong, setSimiSong] = useState([]);\n  const [comments, setComments] = useState({});\n  const [page, setPage] = useState(1);\n  const limit = 20;\n  const handleLeftInit = async () => {\n    try {\n      const comments = await apiCommentMusic({\n        id: currentSong.id,\n        limit,\n        offset: (page - 1) * limit,\n      });\n      setComments(comments);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const handleRightInit = async () => {\n    try {\n      const { songs } = await apiSimiSong({\n        id: currentSong.id,\n      });\n      setSimiSong(songs);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const handleInit = async () => {\n    await handleLeftInit();\n    await handleRightInit();\n    setLoading(false);\n  };\n  useEffect(() => {\n    if (!lyricVisibility) return;\n    if (loading) handleInit();\n    else handleLeftInit();\n  }, [lyricVisibility, page, currentSong.id]);\n  useEffect(() => {\n    const unlisten = listen((route) => {\n      dispatch(setLyricHide());\n    });\n    return unlisten;\n  }, []);\n\n  if (!lyricVisibility) return null;\n  return (\n    <div id=\"lrc\" className=\"absolute inset-x-0 z-10 overflow-hidden\">\n      <div className=\"w-full h-full bg-white overflow-auto transform\">\n        <div className=\"lrc_inner m-auto\" style={{ width: 888 }}>\n          <div className=\"lrc_header flex justify-between\">\n            <Left />\n            <Center />\n            <Right {...{ simiSong, loading }} />\n          </div>\n          <div className=\"lrc_main mt-14 flex justify-center\">\n            <div style={{ width: 556 }}>\n              {\n                loading\n                  ? (\n                    <div className=\"flex justify-center\">\n                      <DomLoading />\n                    </div>\n                  )\n                  : (\n                    <>\n                      <DomCommentsList comments={comments} more={currentSong.id} type=\"song\" />\n                      <DomPage\n                        total={Math.ceil(comments.total / limit)}\n                        page={page}\n                        func={setPage} />\n                    </>\n                  )\n              }\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n});\n","import React, { memo, useEffect, useRef, useState } from 'react'\nimport { Link, useHistory } from 'react-router-dom';\nimport { useAppDispatch, useAppSelector } from '@/reducers/hooks'\nimport classnames from 'classnames'\n\nconst Lrc = memo(() => {\n  const {\n    currentTime,\n  } = useAppSelector(({ audio }) => audio);\n  const { lrcList } = useAppSelector(({ lrc }) => lrc);\n  const RefScroll = useRef(null);\n  const RefCurrentLine = useRef(null);\n  const [currentLineIndex, setCurrentLineIndex] = useState(0);\n\n  useEffect(() => {\n    setCurrentLineIndex(\n      lrcList\n        .findIndex(({ time }) => time > currentTime) - 1,\n    );\n  }, [currentTime]);\n\n  useEffect(() => {\n    RefScroll.current.scrollTop = 0;\n  }, [lrcList]);\n\n  useEffect(() => {\n    if (RefCurrentLine?.current) {\n      RefScroll.current.scrollTop = RefCurrentLine.current.offsetTop - (RefScroll.current.clientHeight / 2);\n    }\n  }, [currentLineIndex]);\n  return (\n    <div\n      style={{ scrollBehavior: 'smooth' }}\n      className=\"whitespace-pre-line select-text text-center text-gray-500 space-y-2 overflow-auto overscroll-contain h-full pt-36\"\n      ref={RefScroll}\n    >\n\n      {lrcList.length ? lrcList\n        .map(({ time, word }, index) => (\n          <div\n            ref={currentLineIndex === index ? RefCurrentLine : null}\n            key={time}\n            className={classnames('leading-5', currentLineIndex === index && 'font-bold text-black')}\n          >\n            {word.trim()}\n            &nbsp;\n          </div>\n        )) : <div>纯音乐，请您欣赏</div>}\n    </div>\n  );\n});\n\nexport default memo(() => {\n  const { currentSong } = useAppSelector(({ audio }) => audio);\n  return (\n    <div className=\"center overflow-auto pt-5\" style={{ width: 300 }}>\n      <div className=\"text-2xl text-center\">\n        {currentSong.name}\n      </div>\n      <div className=\"flex justify-center mt-2 whitespace-nowrap\">\n        <div className=\"truncate\">\n          {currentSong.ar.map((artist) => (\n            <Link key={artist.id} to={`/artist/${artist.id}`} className=\"ui_text_gray_hover\">\n              {artist.name}\n            </Link>\n          ))}\n        </div>\n        &nbsp;\n        -\n        &nbsp;\n        <div className=\"truncate\">\n          <Link to={`/playlist/album/${currentSong.al.id}`} className=\"ui_text_gray_hover\">\n            {currentSong.al.name}\n          </Link>\n        </div>\n      </div>\n      <div className=\"relative\">\n        <div className=\"relative mt-8\" style={{ height: 330 }}>\n          <Lrc />\n        </div>\n        <div className=\"absolute pointer-events-none left-0 right-0 top-0 h-6 bg-gradient-to-b from-white to-transparent\" />\n        <div className=\"absolute pointer-events-none left-0 right-0 bottom-0 h-6 bg-gradient-to-t from-white to-transparent\" />\n      </div>\n    </div>\n  )\n})\n","import React, {memo} from 'react'\nimport {\n  IconFolderPlus,\n  IconCloudDownload,\n  IconShare,\n} from '@tabler/icons';\nimport DomHeart from '@/components/Table/Heart';\nimport classNames from 'classnames';\nimport { useAppSelector} from '@/reducers/hooks'\n\nexport default memo(() => {\n  const { currentSong } = useAppSelector(({ audio }) => audio);\n  const { running } = useAppSelector(({ audio }) => audio);\n\n  return (\n  <div className=\"left\">\n    <div className=\"relative\">\n      <div\n        id=\"stylus\"\n        className=\"mt-16 mb-10 relative m-auto w-min duration-500 transition-transform z-10\"\n        style={running ? { transform: 'rotate(40deg)' } : {}}\n      >\n        <div className=\"point shadow relative transform -translate-y-1/2 rounded-full bg-gray-300 w-5 h-5 border-8 border-white bg-white\" style={{ zIndex: 2 }} />\n        <div\n          className=\"handle absolute top-0 left-1/2 shadow bg-white h-2 w-20 origin-top-left\"\n          style={{ transform: 'rotate(45deg) translate(0, -50%)', zIndex: 1 }}\n        >\n          <div\n            className=\" absolute left-full bg-white shadow w-12 h-2 origin-top-left\"\n            style={{ transform: 'rotate(-45deg) translate(-10%, 0)' }}\n          >\n            <div className=\"shadow w-4 h-4 absolute left-full -top-1 bg-white\" />\n          </div>\n        </div>\n      </div>\n      <div className=\" rounded-full bg-gray-300 p-2.5 w-64 h-64\">\n        <div className={classNames('flex-center rounded-full p-9', { on: running })} id=\"record\">\n          <img className=\"rounded-full border-8 border-black\" src={currentSong.al.picUrl} alt=\"\" />\n        </div>\n      </div>\n    </div>\n    <div className=\"flex mt-4 justify-between\">\n      <DomHeart\n        stroke=\"2\"\n          id={currentSong.id}\n        size={24}\n        className=\"w-10 h-10 flex-center rounded-full bg-gray-100 hover:bg-gray-200\"\n      />\n      <button type=\"button\" className=\"w-10 h-10 flex-center rounded-full bg-gray-100 hover:bg-gray-200\">\n        <IconFolderPlus size={24} stroke={1} />\n      </button>\n      <button type=\"button\" className=\"w-10 h-10 flex-center rounded-full bg-gray-100 hover:bg-gray-200\">\n        <IconCloudDownload size={24} stroke={1} />\n      </button>\n      <button type=\"button\" className=\"w-10 h-10 flex-center rounded-full bg-gray-100 hover:bg-gray-200\">\n        <IconShare size={24} stroke={1} />\n      </button>\n    </div>\n  </div>\n)})\n","import React, { memo } from 'react'\nimport DomLoading from '@/components/Loading';\n\ninterface iSimiSong {\n  id: number\n  album: { picUrl: string },\n  name: string\n  alias: string\n  artists: { name: string }[]\n  [key: string]: any\n}\n\ninterface iRight {\n  simiSong: iSimiSong[],\n  loading: boolean\n}\n\nexport default memo<iRight>(({ simiSong = [], loading = false }) => {\n  return (\n    <div className=\"right flex-none mt-28 h-72 overflow-auto\" style={{ width: 244 }}>\n      {\n        loading\n          ? (\n            <div className=\"flex justify-center\">\n              <DomLoading />\n            </div>\n          )\n          : <div className=\"pb-4 relative\">\n            <div>播放来源：...</div>\n            <div className=\"font-bold py-3 text-sm\">包含这首歌的歌单</div>\n            <div>\n              { }\n            </div>\n            <div className=\"font-bold py-3 text-sm\">相似歌曲</div>\n            <div>\n              {simiSong.map((song) => (\n                <button\n                  key={song.id}\n                  type=\"button\"\n                  className=\"flex text-left w-full rounded hover:bg-gray-100 p-1.5 h-10\"\n                >\n                  <div className=\"rounded relative overflow-hidden\">\n                    <img src={`${song.album.picUrl}?param=30y30`} alt=\"\" />\n                  </div>\n                  <div className=\"w-0 flex-auto px-2 py-1 text-gray-600\">\n                    <div className=\"truncate\">\n                      {song.name}\n                      <span className=\"text-gray-500\">{song.alias}</span>\n                      &nbsp;\n                      -\n                      &nbsp;\n                      {song.artists.map((artist) => artist.name)}\n                    </div>\n                  </div>\n                </button>\n              ))}\n            </div>\n            <div className=\"absolute pointer-events-none left-0 right-0 bottom-0 h-16 bg-gradient-to-t from-white to-transparent\" />\n          </div>\n      }\n    </div>\n  )\n});\n","export {default} from './Lrc'\n"],"names":["memo","dispatch","useAppDispatch","listen","useHistory","currentSong","useAppSelector","audio","lyricVisibility","lrc","useState","loading","setLoading","simiSong","setSimiSong","comments","setComments","page","setPage","handleLeftInit","apiCommentMusic","id","limit","offset","console","log","handleRightInit","apiSimiSong","songs","handleInit","useEffect","route","setLyricHide","className","style","width","more","type","total","Math","ceil","func","Lrc","currentTime","lrcList","RefScroll","useRef","RefCurrentLine","currentLineIndex","setCurrentLineIndex","findIndex","time","current","scrollTop","offsetTop","clientHeight","scrollBehavior","ref","length","map","index","word","key","trim","name","ar","artist","Link","to","al","height","running","transform","zIndex","on","src","picUrl","alt","stroke","size","IconFolderPlus","IconCloudDownload","IconShare","song","album","alias","artists","default"],"sourceRoot":""}