{"version":3,"file":"Cloud.1631eec5.js","mappings":"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","sources":["webpack://wyy/./src/pages/Cloud/index.tsx"],"sourcesContent":["import React, {memo, useEffect, useState} from 'react';\nimport classNames from 'classnames';\nimport dayjs from 'dayjs';\nimport { Link } from 'react-router-dom';\nimport Search from '@/components/HeaderBarSearch';\nimport { apiUserCloud } from '@/api';\n\nimport DomMenuCreate from '@/components/MenuCreate';\nimport DomRank from '@/components/Table/Rank';\nimport DomHeart from '@/components/Table/Heart';\nimport DomDownload from '@/components/Table/Download';\nimport DomGroupPlay from '@/components/GroupPlay';\nimport DomName from '@/components/Table/Name';\nimport DomArtists from '@/components/Table/Artists';\nimport DomAlbum from '@/components/Table/Album';\n\nimport {\n  IconCaretUp,\n  IconCaretDown,\n  IconSwitchVertical,\n  IconCloudDownload,\n  IconPlus,\n  IconPlayerPlay,\n} from '@tabler/icons';\n\nconst defaultSort = (a, b, sort) => String(a[sort.code]).localeCompare(String(b[sort.code]), 'zh-CN') * sort.type;\n\nconst th = [\n  ['音乐标题', 'songName', defaultSort],\n  ['歌手', 'artist', defaultSort],\n  ['专辑', 'album', defaultSort],\n  ['格式', '', defaultSort],\n  ['大小', 'fileSize', (a, b, sort) => (Number.parseFloat(a[sort.code]) - Number.parseFloat(b[sort.code])) * sort.type],\n  ['上传时间', 'addTime', (a, b, sort) => (a[sort.code] - b[sort.code]) * sort.type]];\n\nconst BuildSort = (item, sort) => {\n  if (sort.name !== item) {\n    return (\n      <IconSwitchVertical size={14} color=\"#f00\" stroke={1} />\n    );\n  }\n  if (sort.type === -1) {\n    return (\n      <IconCaretDown size={20} stroke={0} fill=\"#000\" />\n    );\n  }\n  if (sort.type === 1) {\n    return (\n      <IconCaretUp size={12} stroke={0} fill=\"#000\" />\n    );\n  }\n  if (sort.type === 0) {\n    return (\n      <IconSwitchVertical size={14} color=\"#f00\" stroke={1} />\n    );\n  }\n};\n\nexport default memo(() => {\n  const [visibility, setVisibility] = useState(false);\n  const [search, setSearch] = useState('');\n  const [data, setData] = useState([]);\n  const [count, setCount] = useState(0);\n  const [maxSize, seMaxSize] = useState('');\n  const [size, setSize] = useState('');\n\n  const [sort, setSort] = useState({\n    name: '上传时间',\n    type: -1,\n    code: 'addTime',\n    callback: (a, b, sort) => (a[sort.code] - b[sort.code]) * sort.type,\n  });\n\n  const handleToggleVisibility = () => {\n    setVisibility(!visibility);\n  };\n\n  const handleInit = async () => {\n    try {\n      const {\n        data = [], count = 0, maxSize = 0, size = 0,\n      } = await apiUserCloud({\n        limit: 100,\n      });\n      setData(data);\n      setCount(count);\n      seMaxSize(maxSize);\n      setSize(size);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const handleSort = (obj) => {\n    if (sort.name !== obj.name) {\n      return setSort({\n        ...obj,\n        type: 1,\n      });\n    }\n    switch (sort.type) {\n      case -1:\n        return setSort({\n          name: '',\n          code: '',\n          callback: (a, b) => 0,\n          type: 0,\n        });\n      case 1:\n        return setSort({\n          ...obj,\n          type: -1,\n        });\n      default:\n        return setSort({\n          ...obj,\n          type: 1,\n        });\n    }\n  };\n\n  useEffect(() => {\n    handleInit();\n  }, []);\n\n  // useEffect(() => {\n  //   console.log('qwe');\n  //   setData(\n  //     data.sort((a, b) => sort.callback(a, b, sort)),\n  //   );\n  // }, [data, sort]);\n  return (\n    <div className=\"domManage overflow-auto h-full\">\n      <div className=\"domManage_header ui_header\">\n        <span className=\"domManage_header_title h1\">我的音乐云盘</span>\n      </div>\n      <div className=\"domCloud_info py-2.5 px-8\">\n        <span>云盘容量</span>\n        &nbsp;\n        <div\n          className=\"ui_process\"\n          style={{ '--ratio': (size / maxSize) || 0 }}\n        />\n        &nbsp;\n        <span className=\"num\">\n          {(size / 1024 / 1024 / 1024).toFixed(2)}\n          G/\n          {maxSize / 1024 / 1024 / 1024}\n          G\n        </span>\n        &nbsp;\n        <span className=\"ml-8\">歌曲永久保存，随时随地多端畅听</span>\n        &nbsp;\n        <a href=\"https://music.163.com/#/store/product/detail?id=34001\" className=\"ui_link\">扩容</a>\n      </div>\n      <div className=\"ui_headerBar border-b\">\n        <div className=\"left space-x-2\">\n          <DomGroupPlay />\n          <button type=\"button\" className=\"flex-center ui_btn inline-flex items-center justify-center border px-3 h-8 rounded-full\">\n            <IconPlus size={20} />\n            &nbsp;\n            上传音乐\n          </button>\n        </div>\n        <div className=\"right\">\n          <Search {...{ search, setSearch, placeholder: '搜索我的音乐云盘' }} />\n        </div>\n      </div>\n      <div className=\"overflow-auto max-h-full flex-auto\" style={{ paddingLeft: 30, paddingRight: 20 }}>\n        <div className=\"domManage_table\" style={{ '--ui_grid_template': '36px / 30px 30px 8fr 3fr 3fr 2fr 2fr 4fr' }}>\n          <div className=\"thead\">\n            <div className=\"tr grid ui_grid_template items-center\">\n              <div />\n              <div />\n              {\n                th.map(([item, code, callback]) => (\n                  <div\n                    key={item}\n                    className={classNames('cell px-1', 'th', { on: item === sort.name })}\n                    onClick={() => handleSort({ item, code, callback })}\n                  >\n                    {item}\n                    <span className=\"sort\">\n                      {BuildSort(item, sort)}\n                    </span>\n                  </div>\n                ))\n              }\n            </div>\n          </div>\n          <div className=\"tbody\">\n            {\n              data.map((item, index) => (\n                <DomMenuCreate\n                  type=\"song\"\n                  item={item}\n                  schema={[\n                    ['播放',\n                      '下一首播放'],\n                    ['收藏到歌单',\n                      '分享',\n                      '下载'],\n                    ['删除'],\n                  ]}\n                  key={item.songId}\n                >\n                  <div className={classNames('tr grid ui_grid_template items-center hover:bg-gray-100 focus:outline-none focus:bg-gray-200', index % 2 === 0 && 'bg-gray-50')} tabIndex=\"2\">\n                    <div className=\"cell px-1 index text-gray-400\">\n                      <DomRank index={index} id={item.songId} />\n                    </div>\n                    <div className=\"cell px-1 download\">\n                      <DomDownload />\n                    </div>\n                    <div\n                      className=\"cell px-1 name truncate\"\n                      title={item.songName + item.simpleSong?.tns?.length > 0 ? `（${item.simpleSong?.tns}）`: ''}\n                    >\n                      {item.songName}\n                      {\n                        item.simpleSong?.tns?.length > 0\n                        && (\n                          <span className=\"text-gray-500\">\n                            {`（${item.simpleSong.tns}）`}\n                          </span>\n                        )\n                      }\n                    </div>\n                    <DomArtists className=\"px-1\" artists={item.simpleSong.ar} />\n                    <DomAlbum className=\"px-1\" name={item.album} id={item.simpleSong?.al?.id} />\n                    <div className=\"cell px-1 truncate uppercase\">\n                      {/(?<=\\.)(\\w*)$/.exec(item.fileName)[0]}\n                    </div>\n                    <div className=\"cell px-1 truncate\">\n                      {(item.fileSize / 1024 / 1024).toFixed(1)}\n                      MB\n                    </div>\n                    <div className=\"cell px-1 truncate text-gray-400\">\n                      {dayjs(item.addTime).format('YYYY-MM-DD')}\n                    </div>\n                  </div>\n\n                </DomMenuCreate>\n              ))\n            }\n          </div>\n        </div>\n      </div>\n      <div className=\"domManage_dialog\" style={{ display: visibility ? '' : 'none' }}>\n        <button type=\"button\" className=\"close\" onClick={handleToggleVisibility}>×</button>\n        <div className=\"title\">选择本地音乐文件夹</div>\n        <div className=\"tips\">将自动扫描您勾选的目录，文件增删实时同步。</div>\n        <ul>\n          <li>\n            <span className=\"checkbox\">\n              <input type=\"text\" />\n              <i className=\"material-icons\">checkbox</i>\n            </span>\n            暂时没法做\n          </li>\n        </ul>\n        <div className=\"actions\">\n          <button type=\"button\" className=\"ui_btn inline-flex items-center justify-center border px-3 h-8 rounded-full red\">确认</button>\n          <button type=\"button\" className=\"ui_btn inline-flex items-center justify-center border px-3 h-8 rounded-full\">添加文件</button>\n        </div>\n      </div>\n    </div>\n  );\n});\n"],"names":["defaultSort","a","b","sort","String","code","localeCompare","type","th","Number","parseFloat","memo","useState","visibility","setVisibility","search","setSearch","data","setData","setCount","maxSize","seMaxSize","size","setSize","name","callback","setSort","handleInit","apiUserCloud","limit","count","console","log","useEffect","className","style","toFixed","href","IconPlus","placeholder","paddingLeft","paddingRight","map","item","key","on","onClick","obj","handleSort","IconSwitchVertical","color","stroke","IconCaretDown","fill","IconCaretUp","BuildSort","index","schema","songId","tabIndex","id","title","songName","simpleSong","tns","length","artists","ar","album","al","exec","fileName","fileSize","addTime","format","display"],"sourceRoot":""}