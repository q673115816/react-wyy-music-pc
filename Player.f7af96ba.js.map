{"version":3,"sources":["webpack://wyy/./src/components/Dialog/DownloadVideo/index.tsx","webpack://wyy/./src/pages/Player/Related.tsx","webpack://wyy/./src/pages/Player/components/Video/Control.tsx","webpack://wyy/./src/pages/Player/components/Video/reducer/actionTypes.ts","webpack://wyy/./src/pages/Player/components/Video/reducer/actions.ts","webpack://wyy/./src/pages/Player/components/Video/Timing.tsx","webpack://wyy/./src/pages/Player/components/Video/reducer/index.ts","webpack://wyy/./src/pages/Player/components/Video/index.tsx","webpack://wyy/./src/pages/Player/Download/download.worker.ts","webpack://wyy/./src/pages/Player/Init.tsx","webpack://wyy/./src/pages/Player/UseVideoInit.tsx","webpack://wyy/./src/pages/Player/UseMVInit.tsx","webpack://wyy/./src/pages/Player/index.tsx","webpack://wyy/./src/pages/Player/Download/Download.tsx","webpack://wyy/./src/pages/Player/IO.tsx"],"names":["list","dispatch","useDispatch","useSelector","mask","callback","dialogDownloadVideoVisibility","id","title","className","map","label","key","htmlFor","type","onClick","setDialogReset","related","style","width","item","vid","Link","to","playerTypes","src","coverUrl","alt","IconPlayerPlay","size","transPlayCount","playTime","dayjs","durationms","format","creator","userId","userName","sizes","DomSize","useState","sizeListShow","setSizeListShow","curr","setCurr","IconDeviceDesktop","useContext","VideoContext","handlechangeFull","full","handleChangePlay","play","currentTime","duration","IconPlayerPause","IconArrowsMinimize","stroke","IconArrowsMaximize","SET_FULL","SET_PLAY","SET_BUFFERED","SET_DURATION","SET_CURRENTTIME","SET_JUMPTIME","createAction","value","payload","timeTips","setTimeTips","dragger","setDragger","mousePosition","setMousePosition","playerLengthRatio","setPlayerLengthRatio","buffered","videoDispatch","handleDropMove","handleDropUp","useEffect","left","start","end","right","onMouseDown","setDragInit","onMouseMove","onMouseUp","onMouseEnter","e","clientX","target","getBoundingClientRect","onMouseLeave","ratio","max","initialState","jumpTime","state","action","createContext","memo","url","fixed","detail","brs","next","useReducer","videoReducer","ref","useRef","setIsEnd","current","pause","document","webkitExitFullscreen","setPositionTrue","documentElement","webkitRequestFullScreen","setPositionFalse","classNames","onProgress","i","length","onebuffered","push","onTimeUpdate","onLoadedMetadata","onDoubleClick","onEnded","playsInline","autoPlay","Provider","Worker_fn","Worker","switchs","video","init","pending","setPending","urls","setUrls","setRelated","setDetail","detailInfo","setDetailInfo","handleInit","Promise","all","apiVideoUrl","apiRelatedAllvideo","apiVideoDetail","apiVideoDetailInfo","data","playCount","unstable_batchedUpdates","console","log","name","sub","apiComments","apiCommentVideo","mv","apiMVUrl","apiMVDetail","mvid","apiMVDetailInfo","description","desc","apiCommentMV","DomGroup","func","group","setAudioRunningPause","mvSublist","account","page","setPage","comments","setComments","commentsLoading","setCommentsLoading","isSub","useMemo","find","isLike","handleGetMVSublist","apiMVSublist","setMVSublist","handleSub","apiVideoSub","t","apiMVSub","code","setToast","handleComments","limit","offset","params","link","RefWorker","downloadResponse","downloadProcess","setDownloadProcess","downloadState","setDownloadState","handleCreateFile","pathname","URL","ext","substr","lastIndexOf","href","window","createObjectURL","a","createElement","download","click","revokeObjectURL","worker","DownloadWorker","postMessage","method","addEventListener","res","response","handleInitDownload","handleUnLoadDownload","terminate","handleDownload","setDialogDownloadVideoShow","FNDownload","FNInit","goBack","useHistory","descriptionVisibility","setDescriptionVisibility","setValue","handleFollow","apiFollow","followed","DomVideoWrap","DomScroll","Io","setFixed","IntersectionObserver","entries","forEach","entry","isIntersecting","root","observe","disconnect","FNIO","IconChevronLeft","avatarUrl","nickname","on","IconCaretUp","IconCaretDown","publishTime","videoGroup","setVideoListId","IconThumbUp","liked","likedCount","IconCheckbox","IconFolderPlus","IconScreenShare","shareCount","IconDownload","commentCount","Write","total","Math","ceil"],"mappings":"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","file":"Player.f7af96ba.js","sourcesContent":["import React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { setDialogReset } from '@/reducers/mask/actions';\nimport DomCheckbox from '@/components/Checkbox';\nimport HOCDialog from '../Dialog';\nimport './style.scss';\n\nconst list = [\n  ['标清', true],\n  ['高清（需要2云贝）', false],\n  ['超清（需要5云贝）', false],\n];\n\nexport default () => {\n  const dispatch = useDispatch();\n  const { callback, dialogDownloadVideoVisibility } = useSelector(({ mask }) => mask);\n  const handleConfirm = () => {\n    callback();\n    dispatch(setDialogReset());\n  };\n  if (!dialogDownloadVideoVisibility) return null;\n  return (\n    <HOCDialog id=\"dialogDownloadVideo\" title=\"选择下载清晰度\">\n      <div className=\"content px-12 py-8\">\n        <div className=\"\">\n          {\n            list.map(([label, state]) => (\n              <div className=\"flex items-center\" key={label}>\n                <label htmlFor=\"\">\n                  <DomCheckbox />\n                  {label}\n                </label>\n              </div>\n            ))\n          }\n        </div>\n        <div className=\"flex justify-center mt-10 space-x-4\">\n          <button type=\"button\" className=\"w-20 h-8 rounded-full ui_theme_bg_color text-white\" onClick={handleConfirm}>确定</button>\n          <button type=\"button\" className=\"w-20 h-8 rounded-full border hover:bg-gray-50\" onClick={() => dispatch(setDialogReset())}>取消</button>\n        </div>\n      </div>\n    </HOCDialog>\n  );\n};\n","import React from 'react';\nimport classNames from 'classnames';\nimport { Link } from 'react-router-dom';\nimport dayjs from 'dayjs';\nimport { transPlayCount } from '@/common/utils';\nimport { IconPlayerPlay } from '@tabler/icons';\nimport { playerTypes } from '@/common/config';\nimport DomTagMV from '@/components/Tags/Box';\n\nexport default ({ related = [] }) => (\n  <div className=\"right\" style={{ width: 280 }}>\n    <div className=\"domVideoDetail_header flex items-center text-base font-bold\">相关推荐</div>\n    <div className=\"domVideoDetail_related\">\n      {\n      related.map((item) => (\n        <div className=\"item mb-2.5 flex\" key={item.vid}>\n          <Link to={`/player/${playerTypes[item.type]}/${item.vid}`} className=\"cover relative flex-none rounded overflow-hidden\">\n            <img className=\"\" src={item.coverUrl} alt=\"\" />\n            <div className=\"playTime absolute top-0 right-0 mx-2 my-1 flex-center text-white\">\n              <IconPlayerPlay size={12} />\n              {transPlayCount(item.playTime)}\n            </div>\n            <div className=\"durationms absolute bottom-0 right-0 mx-2 my-1 text-white\">\n              {dayjs(item.durationms).format('mm:ss')}\n            </div>\n          </Link>\n          <div className=\"content p-2 flex-auto w-0\">\n            <div className=\"title ui_ellipse\">\n              <Link\n                title={item.title}\n                to={`/player/${playerTypes[item.type]}/${item.vid}`}\n                className=\"ui_text_black_hover\"\n              >\n                {item.type === 0\n                  && <DomTagMV className=\"inline-block\" />}\n                {item.title}\n              </Link>\n            </div>\n            <div className=\"username mt-2 truncate text-gray-400\">\n              by&nbsp;\n              <Link to={`/user/${item.creator[0].userId}`} className=\"ui_text_gray_hover\">\n                {item.creator[0].userName}\n              </Link>\n            </div>\n          </div>\n        </div>\n      ))\n    }\n    </div>\n  </div>\n);\n","import React, { useState, useContext } from 'react';\nimport {\n  IconPlayerPlay,\n  IconPlayerPause,\n  IconArrowsMaximize,\n  IconArrowsMinimize,\n  IconDeviceDesktop,\n} from '@tabler/icons';\nimport dayjs from 'dayjs';\nimport { VideoContext } from './index';\n\nconst sizes = [\n  '标清',\n  '高清',\n  '超清',\n  '1080P',\n  '没这功能',\n];\n\nconst DomSpeed = () => (\n  <div className=\"relative w-20\">\n    {}\n  </div>\n);\n\nconst DomSize = () => {\n  const [sizeListShow, setSizeListShow] = useState(false);\n  const [curr, setCurr] = useState('超清');\n  const handleCheck = (br) => {\n    setCurr(br);\n    setSizeListShow(false);\n  };\n  return (\n    <div className=\"relative w-16\">\n      <button\n        onClick={() => setSizeListShow(!sizeListShow)}\n        type=\"button\"\n        className=\"flex-center w-full group\"\n      >\n        <IconDeviceDesktop className=\"text-gray-600 group-hover:text-gray-400\" size={20} />\n        &nbsp;\n        <span className=\"text-gray-400\">\n          {curr}\n        </span>\n      </button>\n      {\n        sizeListShow\n        && (\n          <div className=\"absolute left-0 right-0 bottom-full border text-white divide-y divide-gray-400 transform -translate-y-4 bg-black bg-opacity-80 border-gray-400 text-center\">\n            {\n              sizes.map((size) => (\n                <button\n                  key={size}\n                  type=\"button\"\n                  className=\"black w-full py-1\"\n                  onClick={() => handleCheck(size)}\n                >\n                  {size}\n                </button>\n              ))\n            }\n          </div>\n        )\n      }\n    </div>\n  );\n};\n\nexport default () => {\n  const {\n    handlechangeFull,\n    full,\n    handleChangePlay,\n    play,\n    currentTime,\n    duration,\n  } = useContext(VideoContext);\n  return (\n    <div className=\"h-10 flex-none bg-black flex items-center pl-2\">\n      <button\n        type=\"button\"\n        className=\"border rounded-full text-white border-current w-6 h-6 flex-center\"\n        onClick={handleChangePlay}\n      >\n        {\n          play\n            ? <IconPlayerPause className=\"fill-current\" size={12} />\n            : <IconPlayerPlay className=\"fill-current\" size={12} />\n        }\n      </button>\n      <span className=\"text-gray-300 ml-2\">\n        {dayjs(currentTime * 1000).format('mm:ss')}\n        &nbsp;\n        /\n        &nbsp;\n        {dayjs(duration * 1000).format('mm:ss')}\n      </span>\n      <div className=\"ml-auto flex divide-x\">\n        <div className=\"flex\">\n          <button type=\"button\">{ }</button>\n          <div>{ }</div>\n        </div>\n        {/* <DomSpeed /> */}\n        <DomSize />\n        <button\n          onClick={handlechangeFull}\n          type=\"button\"\n          className=\"flex-center w-10 text-gray-400 hover:text-white\"\n        >\n          {\n            full\n              ? <IconArrowsMinimize size={20} stroke={1} />\n              : <IconArrowsMaximize size={20} stroke={1} />\n          }\n        </button>\n      </div>\n    </div>\n  );\n};\n","export const SET_FULL = 'SET_FULL';\nexport const SET_PLAY = 'SET_PLAY';\nexport const SET_BUFFERED = 'SET_BUFFERED';\nexport const SET_DURATION = 'SET_DURATION';\nexport const SET_CURRENTTIME = 'SET_CURRENTTIME';\nexport const SET_JUMPTIME = 'SET_JUMPTIME';\n","import {\n  SET_FULL,\n  SET_PLAY,\n  SET_BUFFERED,\n  SET_DURATION,\n  SET_CURRENTTIME,\n  SET_JUMPTIME,\n} from './actionTypes';\n\nexport const createAction = (type, key, value) => ({\n  type,\n  payload: {\n    [key]: value,\n  },\n});\n\nexport const actionSetPlay = (value) => createAction(SET_PLAY, 'play', value);\n\nexport const actionSetFull = (value) => createAction(SET_FULL, 'full', value);\n\nexport const actionSetBuffered = (value) => createAction(SET_BUFFERED, 'buffered', value);\n\nexport const actionSetCurrentTime = (value) => createAction(SET_CURRENTTIME, 'currentTime', value);\n\nexport const actionSetJumpTime = (value) => createAction(SET_JUMPTIME, 'jumpTime', value);\n\nexport const actionSetDuration = (value) => createAction(SET_DURATION, 'duration', value);\n","import React, { useState, useContext, useEffect } from 'react';\nimport dayjs from 'dayjs';\nimport { setDragInit } from '@/reducers/drag/actions';\nimport { useDispatch } from 'react-redux';\nimport { VideoContext } from './index';\nimport { actionSetJumpTime } from './reducer/actions';\n\nexport default () => {\n  const dispatch = useDispatch();\n  const [timeTips, setTimeTips] = useState(false);\n  const [dragger, setDragger] = useState(false);\n  const [mousePosition, setMousePosition] = useState(0);\n  const [playerLengthRatio, setPlayerLengthRatio] = useState(0);\n  const {\n    duration,\n    currentTime,\n    buffered,\n    videoDispatch,\n  } = useContext(VideoContext);\n\n  const handleDropMove = () => {\n\n  };\n\n  const handleDropUp = () => {\n    setDragger(false);\n  };\n\n  const handleDropDown = () => {\n    setDragger(true);\n    dispatch(setDragInit({\n      onMouseMove: handleDropMove,\n      onMouseUp: handleDropUp,\n    }));\n  };\n\n  const handleProgressEnter = (e) => {\n    setTimeTips(true);\n  };\n\n  const handleProgressMove = ({ clientX, target }) => {\n    // console.log(e);\n    const { left, width } = target.getBoundingClientRect();\n    // console.log((clientX - left) / width);\n    setMousePosition((clientX - left) / width);\n    if (dragger) {\n      setPlayerLengthRatio((clientX - left) / width);\n    }\n  };\n\n  const handleProgressLeave = (e) => {\n    setTimeTips(false);\n  };\n\n  const handleProgressDropUp = () => {\n    setDragger(false);\n  };\n\n  const handleClick = ({ clientX, target }) => {\n    // console.log('click');\n    const { left, width } = target.getBoundingClientRect();\n    const ratio = (clientX - left) / width;\n    setPlayerLengthRatio(ratio);\n    videoDispatch(actionSetJumpTime(ratio * duration));\n  };\n\n  useEffect(() => {\n    if (!dragger) {\n      setPlayerLengthRatio((currentTime / duration));\n    }\n  }, [currentTime]);\n\n  return (\n    <div className=\"h-1 relative bg-black cursor-pointer\">\n      {timeTips\n        && (\n          <div className=\"absolute bottom-0 text-white px-2 py-1 border border-gray-600 bg-black bg-opacity-80 transform -translate-y-4 -translate-x-1/2\" style={{ left: `${mousePosition * 100}%` }}>\n            {dayjs(mousePosition * duration * 1000).format('mm:ss')}\n          </div>\n        )}\n      <div\n        className=\"absolute inset-0\"\n        alt=\"缓存\"\n      >\n        {\n          buffered.map(([start, end]) => (\n            <div\n              key={`${start}-${end}`}\n              className=\"absolute inset-y-0 bg-gray-400\"\n              style={{ left: `${(start / duration) * 100}%`, right: `${(1 - (end / duration)) * 100}%` }}\n            />\n          ))\n        }\n      </div>\n      <div\n        className=\"h-full relative w-0 ui_theme_bg_color\"\n        alt=\"播放进度\"\n        style={{ width: `${playerLengthRatio * 100}%` }}\n      >\n        <button\n          onMouseDown={handleDropDown}\n          type=\"button\"\n          className=\"absolute shadow right-0 top-1/2 transform -translate-y-1/2 bg-white rounded-full h-3 w-3 flex-center\"\n        >\n          <i className=\"rounded-full ui_theme_bg_color w-1 h-1\" />\n        </button>\n      </div>\n      <progress\n        onMouseEnter={handleProgressEnter}\n        onMouseMove={handleProgressMove}\n        onMouseLeave={handleProgressLeave}\n        onMouseUp={handleProgressDropUp}\n        onClick={handleClick}\n        max={duration}\n        value={currentTime}\n        className=\"absolute bottom-0 left-0 opacity-0 w-full\"\n      />\n    </div>\n  );\n};\n","import {\n  SET_FULL,\n  SET_PLAY,\n  SET_BUFFERED,\n  SET_DURATION,\n  SET_CURRENTTIME,\n  SET_JUMPTIME,\n} from './actionTypes';\n\nexport const initialState = {\n  play: false,\n  full: false,\n  buffered: [],\n  duration: 0,\n  currentTime: 0,\n  jumpTime: 0,\n};\n\nexport default (state, action) => {\n  switch (action.type) {\n    case SET_PLAY:\n      return {\n        ...state,\n        ...action.payload,\n      };\n    case SET_FULL:\n      return {\n        ...state,\n        ...action.payload,\n      };\n    case SET_BUFFERED:\n      return {\n        ...state,\n        buffered: action.payload.buffered,\n      };\n    case SET_DURATION:\n      return {\n        ...state,\n        duration: action.payload.duration,\n      };\n    case SET_CURRENTTIME:\n      return {\n        ...state,\n        ...action.payload,\n      };\n    case SET_JUMPTIME:\n      return {\n        ...state,\n        jumpTime: action.payload.jumpTime,\n      };\n    default:\n      return state;\n  }\n};\n","import React, {\n  useState, useEffect, useRef, createContext, useReducer, memo,\n} from 'react';\nimport {\n  IconPlayerPlay,\n  IconRefresh\n} from '@tabler/icons';\nimport classNames from 'classnames';\nimport { setPositionFalse, setPositionTrue } from '@/reducers/inset/actions';\nimport { useDispatch } from 'react-redux';\nimport DomControl from './Control';\nimport DomTiming from './Timing';\n\nimport videoReducer, { initialState } from './reducer';\nimport {\n  actionSetFull,\n  actionSetPlay,\n  actionSetBuffered,\n  actionSetCurrentTime,\n  actionSetDuration,\n} from './reducer/actions';\n\nexport const VideoContext = createContext();\n\nexport default memo(({\n  url, detail, brs = [], fixed, next = {}\n}) => {\n  const [{\n    play,\n    duration,\n    currentTime,\n    jumpTime,\n    buffered,\n    full,\n  }, videoDispatch] = useReducer(videoReducer, initialState);\n  const ref = useRef();\n  const dispatch = useDispatch();\n  const [isEnd, setIsEnd] = useState(false);\n  const [isAuto, setIsAuto] = useState(true)\n  const handleChangePlay = () => {\n    if (play) {\n      ref.current.pause();\n    } else {\n      ref.current.play();\n    }\n    videoDispatch(actionSetPlay(!play));\n    // setPlay(!play);\n  };\n\n  const handleEnd = () => {\n    setIsEnd(true);\n  };\n\n  const handlechangeFull = async () => {\n    if (full) {\n      // 退出全屏\n      // ref.current.webkitExitFullscreen();\n      await document.webkitExitFullscreen();\n      dispatch(setPositionTrue());\n    } else {\n      // 进入全屏\n      // ref.current.webkitEnterFullScreen();\n      await document.documentElement.webkitRequestFullScreen();\n      dispatch(setPositionFalse());\n    }\n    videoDispatch(actionSetFull(!full));\n  };\n\n  const handleProgress = ({ target }) => {\n    // console.log(target.buffered.length);\n    const buffered = [];\n    for (let i = 0; i < target.buffered.length; i += 1) {\n      const onebuffered = [target.buffered.start(i), target.buffered.end(i)];\n      buffered.push(onebuffered);\n      // console.log(onebuffered);\n    }\n    videoDispatch(actionSetBuffered(buffered));\n    // setBuffered(target.buffered.end(0));\n    // console.log(ref.current.buffered.end(0));\n  };\n\n  const handleSetTime = ({ target }) => {\n    // console.log(e);\n    videoDispatch(actionSetCurrentTime(target.currentTime));\n    // setCurrentTime(target.currentTime);// e.timeStamp\n  };\n\n  const handlePreSetTime = ({ target }) => {\n    // console.log(e);\n    videoDispatch(actionSetDuration(target.duration));\n    // setDuration(target.duration);// e.timeStamp\n  };\n\n  useEffect(() => {\n    // videoDispatch(actionSetCurrentTime(jumptime));\n    ref.current.currentTime = jumpTime;\n  }, [jumpTime]);\n\n  return (\n    <div className={classNames('ui_aspect-ratio-16/9', fixed ? ' absolute bottom-16 right-8 z-10 w-80' : 'relative')}>\n      <div className={classNames('flex flex-col inset-0', full ? 'fixed z-50' : 'absolute')}>\n        <div className=\"bg-black flex-auto h-0 relative\">\n          <video\n            src={url}\n            ref={ref}\n            onClick={handleChangePlay}\n            onProgress={handleProgress}\n\n            onTimeUpdate={handleSetTime}\n            onLoadedMetadata={handlePreSetTime}\n            className=\"h-full m-auto cursor-pointer\"\n            onDoubleClick={handlechangeFull}\n            onEnded={handleEnd}\n            playsInline\n            autoPlay={play}\n          />\n          {\n            !play\n            && (\n              <button\n                onClick={handleChangePlay}\n                type=\"button\"\n                className=\"ico text-white bg-black bg-opacity-10 border border-gray-300 cursor-pointer hover:border-white rounded-full absolute inset-0 m-auto w-16 h-16 flex-center\"\n              >\n                <IconPlayerPlay size={24} className=\"fill-current\" />\n              </button>\n            )\n          }\n          {/*<div className=\"absolute text-gray-300 inset-0 flex-center flex-col bg-black bg-opacity-60\">\n            <div className=\"text-sm\">\n              即将自动为您播放：{next.title}\n            </div>\n            <div className=\"flex\">\n              <div className=\"flex-center flex-col\">\n                <div className=\"border rounded-full flex-center\">\n                  <IconRefresh size={36}/>\n                </div>\n                <div>重新播放</div>\n              </div>\n              <div className=\"flex-center flex-col\">\n                <div className=\"border rounded-full flex-center\">\n                  <IconPlayerPlay size={36}/>\n                </div>\n                <button type=\"button\" className=\"\">取消自动播放</button>\n                <div>自动播放已暂停</div>\n              </div>\n            </div>\n          </div>*/}\n        </div>\n        <VideoContext.Provider value={{\n          handleChangePlay,\n          play,\n          duration,\n          currentTime,\n          buffered,\n          handlechangeFull,\n          full,\n          videoDispatch,\n        }}\n        >\n          <DomTiming />\n          <DomControl />\n        </VideoContext.Provider>\n      </div>\n    </div>\n  );\n});\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"download.worker.5c6d66be.worker.js\");\n}\n","import { useMemo, useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport {\n  apiFollow,\n  apiVideoSub,\n  apiMVSub,\n  apiMVSublist,\n  apiCommentVideo,\n  apiCommentMV,\n  apiResourceLike,\n} from '@/api';\nimport { commentLimit as limit } from '@/common/config';\nimport { setToast, setDialogDownloadVideoShow } from '@/reducers/mask/actions';\nimport { setMVSublist } from '@/reducers/account/actions';\nimport UseVideoInit from './UseVideoInit';\nimport UseMVInit from './UseMVInit';\nimport FNDownload from './Download';\n\nconst switchs = {\n  video: {\n    init: UseVideoInit,\n    name: '视频详情',\n    sub: 'subscribeCount',\n    apiComments: apiCommentVideo,\n  },\n  mv: {\n    init: UseMVInit,\n    name: 'MV详情',\n    sub: 'subCount',\n    apiComments: apiCommentMV,\n  },\n};\n\nexport default ({ vid, type }) => {\n  const dispatch = useDispatch();\n  const { mvSublist } = useSelector(({ account }) => account);\n\n  const [page, setPage] = useState(1);\n  const [comments, setComments] = useState({});\n  const [commentsLoading, setCommentsLoading] = useState(true);\n\n  const isSub = useMemo(() => mvSublist.find((mv) => mv.vid === vid), [vid, mvSublist]);\n  const isLike = useMemo(() => null, [vid]);\n  const {\n    pending,\n    urls,\n    related,\n    detail,\n    detailInfo,\n    handleInit,\n  } = switchs[type].init();\n\n  const handleGetMVSublist = async () => {\n    try {\n      const { data: mvSublist } = await apiMVSublist();\n      dispatch(setMVSublist({\n        mvSublist,\n      }));\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const handleLike = () => {\n    dispatch(apiResourceLike({\n      id: vid,\n      type: type === 'mv' ? '1' : '5',\n      t: isLike ? 0 : 1,\n    }));\n  };\n\n  const handleSub = async () => {\n    try {\n      const { code } = type === 'video' ? await apiVideoSub({\n        id: vid,\n        t: isSub ? 0 : 1,\n      }) : await apiMVSub({\n        mvid: vid,\n        t: isSub ? 0 : 1,\n      });\n      if (code === 200) handleGetMVSublist();\n      dispatch(setToast(isSub ? '取消收藏成功' : '收藏成功'));\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const handleComments = async () => {\n    try {\n      const comments = await switchs[type].apiComments({\n        id: vid,\n        limit,\n        offset: (page - 1) * limit,\n      });\n      setComments(comments);\n      if (commentsLoading) {\n        setCommentsLoading(false);\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const params = useMemo(() => ({ type, vid }), [type, vid]);\n\n  const next = useMemo(() => ({title: related?.[0]?.title || '', link: ''}), [type, vid])\n\n  const {\n    downloadProcess,\n    downloadState,\n    handleInitDownload,\n    handleUnLoadDownload,\n    handleDownload,\n  } = FNDownload(urls?.url, detail?.title);\n\n  useEffect(() => {\n    handleInit(vid);\n    handleComments();\n    handleInitDownload();\n    return () => {\n      handleUnLoadDownload();\n    };\n  }, [vid]);\n\n  useEffect(() => {\n    handleComments();\n  }, [page]);\n\n  return {\n    params,\n    name: switchs[type].name,\n    sub: switchs[type].sub,\n    isSub,\n    isLike,\n    pending,\n    urls,\n    related,\n    detail,\n    detailInfo,\n    handleSub,\n    handleInit,\n    downloadProcess,\n    downloadState,\n    handleDownload,\n\n    page,\n    comments,\n    commentsLoading,\n    setPage,\n\n    next\n  };\n};\n","import React, { useState } from 'react';\nimport { unstable_batchedUpdates } from 'react-dom';\nimport {\n  apiRelatedAllvideo,\n  apiVideoUrl,\n  apiVideoDetail,\n  apiVideoDetailInfo,\n} from '@/api';\n\nexport default () => {\n  const [pending, setPending] = useState(false);\n  const [urls, setUrls] = useState({});\n  const [related, setRelated] = useState([]);\n  const [detail, setDetail] = useState({});\n  const [detailInfo, setDetailInfo] = useState({});\n\n  const handleInit = async (vid) => {\n    try {\n      const [\n        { urls },\n        { data: related = [] },\n        { data: detail = {} },\n        detailInfo = {},\n      ] = await Promise.all([\n        apiVideoUrl({\n          id: vid,\n        }),\n        apiRelatedAllvideo({\n          id: vid,\n        }),\n        apiVideoDetail({\n          id: vid,\n        }),\n        apiVideoDetailInfo({\n          vid,\n        }),\n      ]);\n      detail.playCount = detail.playTime;\n      unstable_batchedUpdates(() => {\n        setUrls(urls[0]);\n        setRelated(related);\n        setDetail(detail);\n        setDetailInfo(detailInfo);\n        setPending(true);\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  return {\n    pending,\n    urls,\n    related,\n    detail,\n    detailInfo,\n    handleInit,\n  };\n};\n","import React, { useState } from 'react';\nimport { unstable_batchedUpdates } from 'react-dom';\nimport {\n  apiRelatedAllvideo,\n  apiMVUrl,\n  apiMVDetail,\n  apiMVDetailInfo,\n  apiCommentMV,\n} from '@/api';\n\nexport default () => {\n  const [pending, setPending] = useState(false);\n  const [urls, setUrls] = useState({});\n  const [related, setRelated] = useState([]);\n  const [detail, setDetail] = useState({});\n  const [detailInfo, setDetailInfo] = useState({});\n\n  const handleInit = async (id) => {\n    try {\n      const [\n        { data: urls },\n        { data: related = [] },\n        { data: detail = {} },\n        detailInfo = {},\n      ] = await Promise.all([\n        apiMVUrl({\n          id,\n        }),\n        apiRelatedAllvideo({\n          id,\n        }),\n        apiMVDetail({\n          mvid: id,\n        }),\n        apiMVDetailInfo({\n          mvid: id,\n        }),\n      ]);\n      detail.title = detail.name;\n      detail.description = detail.desc;\n      unstable_batchedUpdates(() => {\n        setUrls(urls);\n        setRelated(related);\n        setDetail(detail);\n        setDetailInfo(detailInfo);\n        setPending(true);\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  return {\n    pending,\n    urls,\n    related,\n    detail,\n    detailInfo,\n    handleInit,\n  };\n};\n","import React, {\n  useEffect, useState, memo, useMemo,\n} from 'react';\n\nimport {\n  useHistory, Link,\n} from 'react-router-dom';\n\nimport { commentLimit as limit } from '@/common/config';\n\nimport classNames from 'classnames';\nimport dayjs from 'dayjs';\nimport {\n  IconChevronLeft,\n  IconCaretUp,\n  IconCaretDown,\n  IconThumbUp,\n  IconFolderPlus,\n  IconCheckbox,\n  IconScreenShare,\n  IconDownload,\n} from '@tabler/icons';\nimport './style.scss';\n\nimport { transPlayCount } from '@/common/utils';\nimport { setAudioRunningPause } from '@/reducers/audio/actions';\n\nimport {\n  apiFollow,\n  apiCommentVideo,\n  apiCommentMV,\n} from '@/api';\nimport { setVideoListId } from '@/reducers/videolist/actions';\nimport Write from '@/components/Write';\n\nimport { useDispatch } from 'react-redux';\nimport DomCommentsList from '@/components/CommentsList';\nimport DomPage from '@/components/Page';\n\nimport DomLoading from '@/components/Loading';\nimport DialogDownloadVideo from '@/components/Dialog/DownloadVideo';\nimport DomRelated from './Related';\nimport DomVideo from './components/Video';\nimport FNInit from './Init';\nimport FNIO from './IO';\n\nconst DomGroup = ({ list = [], func }) => (\n  <div className=\"domVideoDetail_group mt-3 space-x-1\">\n    {list.map((group) => (\n      <Link\n        className=\"group bg-gray-50 rounded-full px-2 py-1\"\n        onClick={() => func(group.id)}\n        to=\"/video/list\"\n        key={group.id}\n      >\n        {group.name}\n      </Link>\n    ))}\n  </div>\n);\n\nexport default memo(({ type, vid }) => {\n  console.log('player');\n  // console.log('props', props);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(setAudioRunningPause());\n  }, []);\n\n  const {\n    name,\n    sub,\n    isSub,\n    isLike,\n    pending,\n    urls,\n    related,\n    detail,\n    detailInfo,\n    handleSub,\n    handleInit,\n    downloadProcess,\n    downloadState,\n    handleDownload,\n\n    page,\n    comments,\n    commentsLoading,\n    setPage,\n\n    next,\n  } = FNInit({ type, vid });\n\n  // const { type, vid } = params;\n\n  const { goBack } = useHistory();\n  const [descriptionVisibility, setDescriptionVisibility] = useState(false);\n  const [value, setValue] = useState('');\n\n  const handleFollow = async () => {\n    try {\n      const { } = await apiFollow({\n        id: detail.creator.userId,\n        t: followed ? 0 : 1,\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n\n  const {\n    DomVideoWrap,\n    DomScroll,\n    fixed,\n  } = FNIO();\n\n  return (\n    <div className=\" overflow-auto h-full\" ref={DomScroll}>\n      <div style={{ width: 930 }} className=\"flex justify-between m-auto\">\n        <div className=\"left\" style={{ width: 620 }}>\n          <div className=\"domVideoDetail_header flex items-center\">\n            <button\n              type=\"button\"\n              className=\"flex items-center text-base font-bold\"\n              onClick={() => goBack()}\n            >\n              <IconChevronLeft size={28} stroke={1} />\n              {name}\n            </button>\n          </div>\n          <div className=\"ui_aspect-ratio-16/9\" ref={DomVideoWrap}>\n            <DomVideo url={urls?.url} detail={detail} fixed={fixed} next={next}/>\n          </div>\n          <div className=\"domVideoDetail_creator flex items-center mt-5\">\n            <Link to={`/user/${detail?.creator?.userId}`} className=\"avatar rounded-full overflow-hidden border\">\n              <img className=\"\" src={detail?.creator?.avatarUrl} alt=\"\" />\n            </Link>\n            <Link className=\"nickname ml-2.5\" to={`/user/${detail?.creator?.userId}`}>\n              {detail?.creator?.nickname}\n            </Link>\n            {\n              type === 'video'\n              && (\n                <button\n                  onClick={handleFollow}\n                  type=\"button\"\n                  className={classNames('follow text-red-500 bg-red-50 ml-auto h-8 rounded-full', { on: detail?.creator?.followed })}\n                >\n                  {\n                    detail?.creator?.followed\n                      ? '+ 已关注'\n                      : '+ 关注'\n                  }\n                </button>\n              )\n            }\n          </div>\n          <button\n            type=\"button\"\n            className=\"domVideoDetail_title h1 flex items-center mt-5 text-left\"\n            onClick={() => setDescriptionVisibility(!descriptionVisibility)}\n          >\n            {detail?.title}\n            {\n              descriptionVisibility\n                ? <IconCaretUp size={24} className=\"fill-current\" />\n                : <IconCaretDown size={24} className=\"fill-current\" />\n            }\n          </button>\n          <div className=\"domVideoDetail_info text-gray-300 mt-3\">\n            发布：\n            {dayjs(detail?.publishTime).format('YYYY-MM-DD')}\n            &nbsp;\n            播放\n            {transPlayCount(detail?.playCount)}\n          </div>\n          <DomGroup list={detail?.videoGroup} func={(id) => dispatch((setVideoListId({ id })))} />\n          {\n            descriptionVisibility\n            && (\n              <div className=\"domVideoDetail_description mt-4\">\n                {detail.description}\n              </div>\n            )\n          }\n          <div className=\"domVideoDetail_actions flex space-x-3 mt-8\">\n            <button\n              type=\"button\"\n              className=\"flex-center border h-8 rounded-full px-6 hover:bg-gray-100\"\n            >\n              <IconThumbUp size={20} stroke={1} />\n              {\n                detailInfo.liked\n                  ? '已赞'\n                  : '赞'\n              }\n              (\n              {detailInfo.likedCount}\n              )\n            </button>\n            <button\n              type=\"button\"\n              className=\"flex-center border h-8 rounded-full px-6 hover:bg-gray-100\"\n              onClick={handleSub}\n            >\n              {isSub\n                ? <IconCheckbox size={20} stroke={1} />\n                : <IconFolderPlus size={20} stroke={1} />}\n              {\n                isSub ? '已收藏' : '收藏'\n              }\n              (\n              {detail[sub]}\n              )\n            </button>\n            <button\n              type=\"button\"\n              className=\"flex-center border h-8 rounded-full px-6 hover:bg-gray-100\"\n            >\n              <IconScreenShare size={20} stroke={1} />\n              分享\n              {`(${detailInfo.shareCount})`}\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleDownload}\n              className={classNames('relative w-24 h-8 rounded-full overflow-hidden', downloadProcess === 0 ? ' border' : '')}\n            >\n              <div className=\"absolute inset-0 flex justify-end overflow-hidden\">\n                <span className=\"w-24 h-8 flex-center bg-white\">\n                  <IconDownload size={20} stroke={1} />\n                  {downloadState}\n                </span>\n              </div>\n              <div className=\"absolute inset-y-0 left-0 overflow-hidden\" style={{ right: `${(1 - downloadProcess) * 100}%` }}>\n                <span className=\"w-24 h-8 flex-center ui_theme_bg_color text-white\">\n                  <IconDownload size={20} stroke={1} />\n                  {downloadState}\n                </span>\n              </div>\n            </button>\n            <DialogDownloadVideo />\n          </div>\n          <div className=\"domVideoDetail_main mt-8\">\n            <div className=\"title mb-5\">\n              <Link to={`/comment/${type}/${vid}`} className=\"h1 font-bold\">评论</Link>\n                  &nbsp;\n              <span>\n                {`(${detail.commentCount})`}\n              </span>\n            </div>\n            <div className=\"domVideoDetail_feedback mb-10\">\n              <Write {...{\n                value,\n                setValue,\n                length: 140,\n              }}\n              />\n            </div>\n            {commentsLoading ? (\n              <div className=\"\">\n                <DomLoading />\n              </div>\n            ) : (\n              <>\n                <DomCommentsList comments={comments} />\n                <DomPage total={Math.ceil(comments.total / limit)} page={page} func={setPage} />\n              </>\n            )}\n          </div>\n        </div>\n        <DomRelated related={related} />\n      </div>\n    </div>\n  );\n});\n","import { useEffect, useRef, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { setToast, setDialogDownloadVideoShow } from '@/reducers/mask/actions';\nimport DownloadWorker from './download.worker.ts';\n\nexport default (url = '', title = '') => {\n  const dispatch = useDispatch();\n  const RefWorker = useRef<Worker|null|void>();\n  const downloadResponse = useRef();\n  const [downloadProcess, setDownloadProcess] = useState(0);\n  const [downloadState, setDownloadState] = useState('下载');\n\n  const handleInitDownload = () => {\n    setDownloadProcess(0);\n    setDownloadState('下载');\n  };\n\n  const handleUnLoadDownload = () => {\n    if (!RefWorker.current) return;\n    RefWorker.current.postMessage({ method: 'abort' });\n    RefWorker.current.terminate();\n    RefWorker.current = null;\n  };\n\n  const handleCreateFile = () => {\n    const { pathname } = new URL(url);\n    const ext = pathname.substr(pathname.lastIndexOf('.'));\n    const href = window.URL.createObjectURL(downloadResponse.current);\n    // console.log(href);\n    const a = document.createElement('a');\n    a.download = `${title}.${ext}`;\n    a.href = href;\n    a.click();\n    window.URL.revokeObjectURL(href);\n  };\n\n  const callback = () => {\n    setDownloadState('缓存中');\n    const worker: Worker = new DownloadWorker();\n    worker.postMessage({ method: 'init', url });\n    worker.addEventListener('message', (res) => {\n      const { data } = res;\n      const { callback } = res.data;\n      switch (callback) {\n        case 'progress':\n          setDownloadProcess(data[callback]);\n          break;\n        case 'state':\n          setDownloadState(data[callback]);\n          downloadResponse.current = data.response;\n          handleCreateFile();\n          break;\n        default:\n      }\n    });\n    RefWorker.current = worker;\n  };\n\n  const handleDownload = () => {\n    if (downloadState === '已缓存') {\n      handleCreateFile();\n      return;\n    }\n    if (downloadState !== '下载') return;\n    dispatch(setDialogDownloadVideoShow({\n      callback,\n    }));\n  };\n\n  return {\n    downloadProcess,\n    downloadState,\n    handleInitDownload,\n    handleUnLoadDownload,\n    handleDownload,\n  };\n};\n","import { useRef, useState, useEffect } from 'react';\n\nexport default () => {\n  const DomVideoWrap = useRef();\n  const DomScroll = useRef();\n  const Io = useRef();\n  const [fixed, setFixed] = useState(false);\n\n  const handleIo = () => {\n    Io.current = new IntersectionObserver((entries) => {\n      entries.forEach((entry) => {\n        setFixed(!entry.isIntersecting);\n      });\n    }, {\n      root: DomScroll.current,\n    });\n    Io.current.observe(DomVideoWrap.current);\n  };\n\n  const handleUnIo = () => {\n    Io.current.disconnect();\n  };\n\n  useEffect(() => {\n    handleIo();\n    return () => {\n      handleUnIo();\n    };\n  }, []);\n  return {\n    DomVideoWrap,\n    DomScroll,\n    fixed,\n  };\n};\n"],"sourceRoot":""}