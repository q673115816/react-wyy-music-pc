{"version":3,"sources":["webpack://wyy/./src/pages/Home/Toplist/index.tsx"],"names":["DomContent","tracks","className","map","track","index","tabIndex","classNames","key","name","title","alia","length","ar","artist","join","id","Link","to","memo","useSelector","home","toplist","list","useState","fiveTop","setFiveTop","artists","setArtists","loading","setLoading","dispatch","useDispatch","handleInit","apiToplistDetail","setTopListsDetail","Promise","all","slice","item","apiPlaylistDetail","limit","apiToplistArtist","飙升榜","新歌榜","原创榜","热歌榜","歌手榜","console","log","useEffect","playlist","src","coverImgUrl","alt","dayjs","updateTime","format","type","IconPlayerPlay","size","lastRank","transPlayCount","playCount"],"mappings":"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","file":"Home_Toplist.4cc4cafb.js","sourcesContent":["import React, { useEffect, useState, memo } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { IconPlayerPlay } from '@tabler/icons';\nimport classNames from 'classnames';\nimport dayjs from 'dayjs';\nimport { apiToplistDetail, apiPlaylistDetail, apiToplistArtist } from '@/api';\nimport { setTopListsDetail } from '@/reducers/home/actions';\nimport { transPlayCount } from '@/common/utils';\nimport DomLoading from '@/components/Loading';\nimport './style.scss';\n\nconst DomContent = ({ tracks = [] }) => (\n  <div className=\"official_rank_list mb-3\">\n    {\n        tracks.map((track, index) => (\n          <div\n            tabIndex=\"2\"\n            className={classNames('item hover:bg-gray-100 focus:bg-gray-200 focus:outline-none', { 'bg-gray-50': index % 2 === 0 })}\n            key={track.name}\n          >\n            <span className={classNames('index text-sm w-4', index < 3 ? 'text-red-500' : 'text-gray-300')}>{index + 1}</span>\n            <span className=\"status w-4 flex-center\">&nbsp;口&nbsp;</span>\n            <span\n              className=\"name\"\n              title={track.name + track.alia}\n            >\n              {track.name}\n              {\n                track.alia.length > 0\n                && (\n                  <span className=\"text-gray-400\">\n                    (\n                    {\n                      track.alia.map((alia) => alia)\n                    }\n                    )\n                  </span>\n                )\n              }\n            </span>\n            <span\n              className=\"ml-auto text-gray-400\"\n              title={track.ar.map((artist) => artist.name).join('/')}\n            >\n              {\n                track.ar.map((artist, index) => (\n                  <span key={artist.id}>\n                    {index > 0 && ' / '}\n                    <Link to={`/artist/${artist.id}`} className=\"artist text-gray-400 hover:text-gray-500\">\n                      {artist.name}\n                    </Link>\n                  </span>\n                ))\n              }\n            </span>\n          </div>\n        ))\n      }\n  </div>\n);\n\nexport default memo(() => {\n  const { list = [] } = useSelector(({ home }) => home.toplist);\n\n  const [fiveTop, setFiveTop] = useState([]);\n  const [artists, setArtists] = useState({});\n  const [loading, setLoading] = useState(true);\n  const dispatch = useDispatch();\n  const handleInit = async () => {\n    try {\n      const { list } = await apiToplistDetail();\n      dispatch(setTopListsDetail(list));\n      const [飙升榜, 新歌榜, 原创榜, 热歌榜, 歌手榜] = await Promise.all([\n        ...list.slice(0, 4).map((item) => apiPlaylistDetail({ id: item.id, limit: 5 })),\n        apiToplistArtist(1),\n      ]);\n      setFiveTop([飙升榜, 新歌榜, 原创榜, 热歌榜]);\n      setArtists(歌手榜);\n      setLoading(false);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  useEffect(() => {\n    handleInit();\n  }, []);\n  if (loading) return <div className=\"flex-center w-full h-full\"><DomLoading /></div>;\n  return (\n    <div className=\"domHome_content px-8 overflow-auto max-h-full flex-auto\">\n      <div className=\"domHome_toplist ui_w1100\">\n        <div className=\"domHome_toplist_title h1 mb-4\">官方榜</div>\n        <div className=\"domHome_toplist_official\">\n          {fiveTop.map(({ playlist: item }) => (\n            <div\n              key={item.id}\n              className=\"official_rank flex\"\n            >\n              <Link\n                to={`/playlist/music/${item.id}`}\n                className=\"official_rank_cover overflow-hidden relative group\"\n              >\n                <img\n                  className=\"ui_containimg\"\n                  src={`${item.coverImgUrl}?param=200y200`}\n                  alt=\"\"\n                />\n                <div className=\"absolute inset-0 m-auto flex-center text-white\">\n                  <span className=\"pt-16\">\n                    {dayjs(item.updateTime).format('MM月DD日')}\n                    更新\n                  </span>\n                </div>\n                <button type=\"button\" className=\"opacity-0 group-hover:opacity-100 absolute inset-0 m-auto flex-center rounded-full w-10 h-10 text-red-500 bg-white bg-opacity-50\">\n                  <IconPlayerPlay size={22} className=\"fill-current\" />\n                </button>\n              </Link>\n              <div className=\"official_rank_content flex-auto\">\n                <DomContent tracks={item.tracks.slice(0, 5)} />\n                <Link\n                  to={`/playlist/music/${item.id}`}\n                  className=\"text-gray-400 hover:text-gray-500\"\n                >\n                  查看全部 &gt;\n                </Link>\n              </div>\n            </div>\n          ))}\n          <div\n            className=\"official_rank flex\"\n          >\n            <Link\n              to=\"/toplistartist\"\n              className=\"official_rank_cover overflow-hidden relative group\"\n            >\n              歌手榜\n              <div className=\"absolute inset-0 m-auto flex-center text-white\">\n                <span className=\"pt-16\">\n                  {dayjs(artists.list?.updateTime).format('MM月DD日')}\n                  更新\n                </span>\n              </div>\n              <button\n                type=\"button\"\n                className=\"opacity-0 group-hover:opacity-100 absolute inset-0 m-auto flex-center rounded-full w-10 h-10 text-red-500 bg-white bg-opacity-50\"\n              >\n                <IconPlayerPlay size={22} className=\"fill-current\" />\n              </button>\n            </Link>\n            <div className=\"official_rank_content flex-auto\">\n              <div className=\"official_rank_list mb-3\">\n                {artists\n                  ?.list\n                  ?.artists\n                  ?.slice(0, 5)\n                  .map((item, index) => (\n                    <Link\n                      key={item.id}\n                      className={classNames('item hover:bg-gray-100', { 'bg-gray-50': index % 2 === 0 })}\n                      to={`/artist/${item.id}`}\n                    >\n                      <div className={classNames('index w-4', { 'text-red-500': index < 3 })}>\n                        {index + 1}\n                      </div>\n                      <div className=\"status w-4 flex-center\">\n                        {item.lastRank === index && '-'}\n                        {item.lastRank < index && '↓'}\n                        {item.lastRank > index && '↑'}\n                      </div>\n                      <div className=\"name\">{item.name}</div>\n                    </Link>\n                  ))}\n              </div>\n              <Link\n                to=\"/toplistartist\"\n                className=\"text-gray-400 hover:text-gray-500\"\n              >\n                查看全部 &gt;\n              </Link>\n            </div>\n          </div>\n        </div>\n        <div className=\"domHome_toplist_title h1 mb-4\">全球榜</div>\n        <div className=\"domHome_toplist_cardlist grid grid-cols-5 gap-5\">\n          {list.slice(4).map((item) => (\n            <div className=\"item flex flex-col\" key={item.id}>\n              <Link\n                to={`/playlist/music/${item.id}`}\n                className=\"cover group rounded overflow-hidden relative\"\n              >\n                <span className=\"playCount flex items-center absolute top-0 right-0 py-0.5 px-2 text-white\">\n                  <IconPlayerPlay size={12} />\n                  {transPlayCount(item.playCount)}\n                </span>\n                <img\n                  className=\"\"\n                  src={`${item.coverImgUrl}?param=200y200`}\n                  alt=\"\"\n                />\n                <button\n                  type=\"button\"\n                  className=\"play opacity-0 group-hover:opacity-100 absolute inset-0 m-auto bg-white bg-op text-red-500 w-10 h-10 rounded-full flex-center bg-opacity-95\"\n                >\n                  <IconPlayerPlay size={20} className=\"fill-current\" />\n                </button>\n              </Link>\n              <Link\n                to={`/playlist/music/${item.id}`}\n                className=\"name mt-1 text-sm text-gray-600 hover:text-black\"\n              >\n                {item.name}\n              </Link>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n});\n"],"sourceRoot":""}