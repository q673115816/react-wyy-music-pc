{"version":3,"sources":["webpack://wyy/./src/pages/AllMV/index.tsx"],"names":["filters","search","useLocation","defaultSearch","area","type","order","offset","useRef","queryString","URLSearchParams","domScroll","domObserver","k","v","useState","data","setData","handleInit","apiMVAll","limit","current","prev","map","id","name","cover","playCount","duration","title","creator","artists","userId","userName","console","log","useInfinite","useEffect","className","ref","Link","to","filter","key","item","classNames","list"],"mappings":"olCASA,IAAMA,EAAU,CACd,CAAC,OAAQ,KAAM,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,OAC9C,CAAC,OAAQ,KAAM,CAAC,KAAM,MAAO,KAAM,MAAO,SAC1C,CAAC,QAAS,KAAM,CAAC,OAAQ,KAAM,QAGjC,mBACE,IADmB,EACXC,GAAWC,mBAAXD,OAEFE,EAAgB,CACpBC,KAAM,KACNC,KAAM,KACNC,MAAO,QAIHC,GAASC,YAAO,GAEhBC,EAAc,IAAIC,gBAAgBT,GAClCU,GAAYH,cACZI,GAAcJ,cAdD,E,25BAAA,CAeEC,GAfF,IAenB,2BAAkC,0BAAtBI,EAAsB,KAAnBC,EAAmB,KAChCX,EAAcU,GAAKC,GAhBF,8BAmBnB,OAAwBC,cAAS,IAAjC,eAAOC,EAAP,KAAaC,EAAb,KAEMC,EAAU,mCAAG,gHAEQC,QAAS,EAAD,KAC1BhB,GAD0B,IAE7BiB,MAhBQ,GAiBRb,OAAQA,EAAOc,WALF,gBAEPL,EAFO,EAEPA,KAKRT,EAAOc,SAnBG,GAoBVJ,GAAQ,SAACK,GAAD,wBAAcA,IAAd,OAAuBN,EAAKO,KAAI,gBACtCC,EADsC,EACtCA,GAAIC,EADkC,EAClCA,KAAMC,EAD4B,EAC5BA,MAAOC,EADqB,EACrBA,UADqB,MAEjC,CACLH,KACAE,QACAE,SALsC,EACVA,SAK5BD,YACAE,MAAOJ,EACPK,QARsC,EACAC,QAOrBR,KAAI,kBAAqC,CAAES,OAAvC,EAAGR,GAA4CS,SAA/C,EAAeR,kBAhBvB,gDAmBfS,QAAQC,IAAR,MAnBe,yDAAH,qDAsChB,OAhBAC,OAAYlB,EAAYP,EAAWC,EAAa,CAACX,KAUjDoC,gBAAU,WACRpB,EAAQ,IACRV,EAAOc,QAAU,IAEhB,CAACpB,IAGF,yBAAKqC,UAAU,gCAAgCC,IAAK5B,GAClD,yBAAK2B,UAAU,6BACb,kBAAC,EAAAE,KAAD,CAAMC,GAAG,KAAKH,UAAU,YAAxB,SAIF,yBAAKA,UAAU,gCACb,yBAAKA,UAAU,aAEXtC,EAAQuB,KAAI,SAACmB,GAAD,OACV,yBAAKJ,UAAU,kBAAkBK,IAAKD,EAAO,IAC3C,yBAAKJ,UAAU,kBACZI,EAAO,GADV,KAIA,yBAAKJ,UAAU,iBAEXI,EAAO,GAAGnB,KAAI,SAACqB,GAAD,OACZ,yBAAKN,UAAU,mBAAmBK,IAAKC,GACrC,kBAAC,EAAAJ,KAAD,CACEC,GAAE,iBAAY,IAAI/B,gBAAJ,OAAyBP,IAAzB,UAA8CuC,EAAO,GAAKE,MACxEN,UAAWO,IAAW,oDAAqDD,IAASzC,EAAcuC,EAAO,IAAM,yBAA2B,uBAEzIE,aAUnB,yBAAKN,UAAU,QACb,kBAAC,IAAD,CAAcQ,KAAM9B,KAEtB,yBAAKuB,IAAK3B","file":"AllMV.bb7a761f.js","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\nimport { apiMVAll } from '@/api';\n// import './style.scss';\nimport classNames from 'classnames';\n\nimport DomGridVideo from '@/components/GridVideo';\nimport useInfinite from '@/hooks/useInfinite';\n\nconst filters = [\n  ['area', '地区', ['全部', '内地', '港台', '欧美', '韩国', '日本']],\n  ['type', '类型', ['全部', '官方版', '原声', '现场版', '网易出品']],\n  ['order', '排序', ['上升最快', '最热', '最新']],\n];\n\nexport default () => {\n  const { search } = useLocation();\n\n  const defaultSearch = {\n    area: '全部',\n    type: '全部',\n    order: '上升最快',\n  };\n\n  const limit = 30;\n  const offset = useRef(0);\n\n  const queryString = new URLSearchParams(search);\n  const domScroll = useRef();\n  const domObserver = useRef();\n  for (const [k, v] of queryString) {\n    defaultSearch[k] = v;\n  }\n\n  const [data, setData] = useState([]);\n\n  const handleInit = async () => {\n    try {\n      const { data } = await apiMVAll({\n        ...defaultSearch,\n        limit,\n        offset: offset.current,\n      });\n      offset.current += limit;\n      setData((prev) => [...prev, ...data.map(({\n        id, name, cover, playCount, duration, artists,\n      }) => ({\n        id,\n        cover,\n        duration,\n        playCount,\n        title: name,\n        creator: artists.map(({ id: userId, name: userName }) => ({ userId, userName })),\n      }))]);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  useInfinite(handleInit, domScroll, domObserver, [search]);\n\n  // useEffect(() => {\n  //   // handleInit();\n  //   handleIo();\n  //   return () => {\n  //     handleUnIo();\n  //   };\n  // }, [search]);\n\n  useEffect(() => {\n    setData([]);\n    offset.current = 0;\n    // handleInit();\n  }, [search]);\n\n  return (\n    <div className=\"domAllMV overflow-auto h-full\" ref={domScroll}>\n      <div className=\"domAllMV_header ui_header\">\n        <Link to=\"./\" className=\"h1 title\">\n          全部MV\n        </Link>\n      </div>\n      <div className=\"domAllMV_main px-8 flex-auto\">\n        <div className=\"ui_filter\">\n          {\n            filters.map((filter) => (\n              <div className=\"row flex my-2.5\" key={filter[1]}>\n                <div className=\"name flex-none\">\n                  {filter[1]}\n                  :\n                </div>\n                <div className=\"list divide-x\">\n                  {\n                    filter[2].map((item) => (\n                      <div className=\"item flex-center\" key={item}>\n                        <Link\n                          to={`/allmv?${new URLSearchParams({ ...defaultSearch, ...{ [filter[0]]: item } })}`}\n                          className={classNames('btn rounded-full leading-5 px-3 whitespace-nowrap', item === defaultSearch[filter[0]] ? 'bg-red-50 text-red-500' : 'ui_text_gray_hover')}\n                        >\n                          {item}\n                        </Link>\n                      </div>\n                    ))\n                  }\n                </div>\n              </div>\n            ))\n          }\n        </div>\n        <div className=\"py-1\">\n          <DomGridVideo list={data} />\n        </div>\n        <div ref={domObserver} />\n      </div>\n    </div>\n  );\n};\n"],"sourceRoot":""}