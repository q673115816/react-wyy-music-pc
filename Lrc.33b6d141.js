(self.webpackChunkwyy=self.webpackChunkwyy||[]).push([[2995],{3625:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(2137),n=r(9351),l=r(7757),c=r.n(l),s=(r(4553),r(1249),r(3210),r(8309),r(3804)),o=r.n(s),i=r(5325),u=r(6955),m=r(8556),d=r(1059),f=r(977),v=r(847),E=r(5200),h=r(6232),p=r(4184),g=r.n(p),b=r(3436),y=function(){var e=(0,i.useSelector)((function(e){return e.audio})).currentTime,t=(0,i.useSelector)((function(e){return e.lrc})).lrcList,r=(0,s.useRef)(),a=(0,s.useRef)(),l=(0,s.useState)(0),c=(0,n.Z)(l,2),u=c[0],m=c[1];return(0,s.useEffect)((function(){m(t.findIndex((function(t){return t.time>e}))-1)}),[e]),(0,s.useEffect)((function(){r.current.scrollTop=0}),[t]),(0,s.useEffect)((function(){null!=a&&a.current&&(r.current.scrollTop=a.current.offsetTop-r.current.clientHeight/2)}),[u]),o().createElement("div",{style:{scrollBehavior:"smooth"},className:"whitespace-pre-line select-text text-gray-500 space-y-2 overflow-auto overscroll-contain h-full",ref:r},t.map((function(e,t){var r=e.time,n=e.word;return o().createElement("div",{ref:u===t?a:null,key:r,className:g()("leading-5",u===t&&"font-bold text-black")},n.trim()," ")})))},N=function(){return(0,i.useSelector)((function(e){return e.lrc})).lrcList.length?o().createElement(y,null):o().createElement("div",{className:"absolute inset-0 flex-center"},"纯音乐，请您欣赏")},w=function(e){var t=e.simiSong,r=void 0===t?[]:t;return o().createElement("div",{className:"right flex-none",style:{width:244}},o().createElement("div",null,"包含这首歌的歌单"),o().createElement("div",null),o().createElement("div",null,"相似歌曲"),o().createElement("div",null,r.map((function(e){return o().createElement("button",{key:e.id,type:"button",className:"flex text-left w-full rounded hover:bg-gray-100 p-1.5",style:{height:60}},o().createElement("div",{className:"rounded relative overflow-hidden"},o().createElement("img",{src:"".concat(e.album.picUrl,"?param=50y50"),alt:""}),o().createElement("i",{className:"absolute inset-0 m-auto ui_themeColor flex-center rounded-full bg-white bg-opacity-80 w-6 h-6"},o().createElement(E.IconPlayerPlay,{size:16,className:"fill-current"}))),o().createElement("div",{className:"w-0 flex-auto px-2 py-1 text-gray-600"},o().createElement("div",{className:"truncate"},e.name,o().createElement("span",{className:"text-gray-500"},e.alias)),o().createElement("div",{className:"mt-1 truncate"},e.artists.map((function(e){return e.name})))))}))))};const x=(0,s.memo)((function(){var e=(0,i.useDispatch)(),t=(0,v.useHistory)().listen,r=(0,i.useSelector)((function(e){return e.audio})).currentSong,l=(0,i.useSelector)((function(e){return e.lrc})).lyricVisibility,p=(0,i.useSelector)((function(e){return e.audio})).running,y=(0,s.useMemo)((function(){return r.id}),[r]),x=(0,s.useState)(!0),k=(0,n.Z)(x,2),S=k[0],Z=k[1],z=(0,s.useState)([]),I=(0,n.Z)(z,2),j=I[0],L=I[1],C=(0,s.useState)({}),P=(0,n.Z)(C,2),T=P[0],_=P[1],M=(0,s.useState)(1),A=(0,n.Z)(M,2),D=A[0],F=A[1],H=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.dV)({id:y,limit:20,offset:20*(D-1)});case 3:t=e.sent,_(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,a.Z)(c().mark((function e(){var t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.wA)({id:y});case 3:t=e.sent,r=t.songs,L(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:return e.next=4,R();case 4:Z(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){if(!l)return!1;S?U():H()}),[l,D]),(0,s.useEffect)((function(){return t((function(t){e((0,b.Q3)())}))})),l?o().createElement("div",{id:"lrc",className:"absolute inset-x-0 bg-white overflow-auto z-10"},o().createElement("div",{className:"lrc_inner m-auto"},o().createElement("div",{className:"lrc_header flex justify-between"},o().createElement("div",{className:"left"},o().createElement("div",{className:"relative"},o().createElement("div",{id:"stylus",className:"mb-14 relative m-auto w-min duration-500 transition-transform z-10",style:p?{transform:"rotate(30deg)"}:{}},o().createElement("div",{className:"point shadow relative transform -translate-y-1/2 rounded-full bg-gray-300 w-5 h-5 border-8 border-white bg-white"}),o().createElement("div",{className:"handle absolute top-0 left-1/2 shadow bg-white h-2 w-48 origin-top-left",style:{transform:"rotate(30deg)"}},o().createElement("div",{className:"shadow w-4 h-4 absolute left-full -top-1 bg-white"}))),o().createElement("div",{className:g()("flex-center rounded-full border-8 bg-gray-300",{on:p}),id:"record"},o().createElement("img",{className:"rounded-full border-8 border-black",src:r.al.picUrl,alt:""}))),o().createElement("div",{className:"flex mt-4 justify-between"},o().createElement(f.Z,{stroke:"2",id:y,size:24,className:"w-10 h-10 flex-center rounded-full bg-gray-100 hover:bg-gray-200"}),o().createElement("button",{type:"button",className:"w-10 h-10 flex-center rounded-full bg-gray-100 hover:bg-gray-200"},o().createElement(E.IconFolderPlus,{size:24,stroke:1})),o().createElement("button",{type:"button",className:"w-10 h-10 flex-center rounded-full bg-gray-100 hover:bg-gray-200"},o().createElement(E.IconCloudDownload,{size:24,stroke:1})),o().createElement("button",{type:"button",className:"w-10 h-10 flex-center rounded-full bg-gray-100 hover:bg-gray-200"},o().createElement(E.IconShare,{size:24,stroke:1})))),o().createElement("div",{className:"right overflow-auto pt-10"},o().createElement("div",{className:"h1"},r.name),o().createElement("div",{className:"grid grid-cols-3 gap-1 mt-2"},o().createElement("div",{className:"flex whitespace-nowrap"},o().createElement("div",{className:"truncate"},"专辑：",o().createElement(v.Link,{to:"/playlist/album/".concat(r.al.id),className:"text-blue-500"},r.al.name))),o().createElement("div",{className:"flex whitespace-nowrap"},o().createElement("div",{className:"truncate"},"歌手：",r.ar.map((function(e){return o().createElement(v.Link,{key:e.id,to:"/artist/".concat(e.id),className:"text-blue-500"},e.name)})))),o().createElement("div",{className:"flex whitespace-nowrap"},"来源：")),o().createElement("div",{className:"relative"},o().createElement("div",{className:"relative mt-4",style:{height:330}},o().createElement(N,null)),o().createElement("div",{className:"absolute pointer-events-none left-0 right-0 top-0 h-6 bg-gradient-to-b from-white to-transparent"}),o().createElement("div",{className:"absolute pointer-events-none left-0 right-0 bottom-0 h-6 bg-gradient-to-t from-white to-transparent"})))),o().createElement("div",{className:"lrc_main mt-14"},o().createElement("div",{className:"flex justify-between"},o().createElement("div",{className:"left",style:{width:550}},o().createElement(v.Link,{to:"/comment/".concat(y),className:"text-base font-bold"},"评论"),o().createElement("div",{className:"border rounded relative p-2 mt-4 mb-10",style:{height:70}},o().createElement("div",{className:"flex cursor-text text-gray-500"},o().createElement(E.IconPencil,{size:20,stroke:1}),"发表评论"),o().createElement("div",{className:"absolute top-0 right-0 m-2 flex"},o().createElement(E.IconMoodSmile,{size:20,stroke:1,className:"cursor-pointer"}),o().createElement(E.IconAt,{size:20,stroke:1,className:"cursor-pointer"}))),S?o().createElement("div",{className:"flex justify-center"},o().createElement(m.Z,null)):o().createElement(o().Fragment,null,o().createElement(h.Z,{comments:T,more:y,type:"song"}),o().createElement(d.Z,{total:Math.ceil(T.total/20),page:1,func:F}))),o().createElement("div",{className:"right flex-none",style:{width:244}},S?o().createElement("div",{className:"flex justify-center"},o().createElement(m.Z,null)):o().createElement(w,{simiSong:j})))))):null}))}}]);